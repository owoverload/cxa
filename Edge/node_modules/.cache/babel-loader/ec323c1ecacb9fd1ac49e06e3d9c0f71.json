{"ast":null,"code":"import _objectSpread from '@babel/runtime/helpers/objectSpread';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport React__default, { createElement, Fragment, isValidElement, createContext, Component, createRef, PureComponent } from 'react';\nimport stream from 'getstream';\nimport StreamAnalytics from 'stream-analytics';\nimport _toConsumableArray from '@babel/runtime/helpers/toConsumableArray';\nimport immutable from 'immutable';\nimport URL from 'url-parse';\nimport moment from 'moment';\nimport anchorme from 'anchorme';\nimport _truncate from 'lodash/truncate';\nimport twitter from 'twitter-text';\nimport _isPlainObject from 'lodash/isPlainObject';\nimport _isEqual from 'lodash/isEqual';\nimport _remove from 'lodash/remove';\nimport _extends from '@babel/runtime/helpers/extends';\nimport { IconButton, FileIcon, LoadingIndicator, Thumbnail, ImageDropzone, ImagePreviewer, FilePreviewer, ImageUploadButton, FileUploadButton } from 'react-file-utils';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faPlayCircle, faPauseCircle, faBookmark } from '@fortawesome/free-regular-svg-icons';\nimport Lightbox from 'react-images';\nimport { emojiIndex, Picker } from 'emoji-mart';\nimport ReactTextareaAutocomplete from '@webscopeio/react-textarea-autocomplete';\nimport '@webscopeio/react-textarea-autocomplete/style.css';\nimport _uniq from 'lodash/uniq';\nimport _debounce from 'lodash/debounce';\nimport _difference from 'lodash/difference';\nimport _includes from 'lodash/includes';\nimport _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport PropTypes from 'prop-types'; // import type { UserResponse } from 'getstream';\n\nfunction humanizeTimestamp(timestamp) {\n  var time = moment.utc(timestamp); // parse time as UTC\n\n  var now = moment(); // Not in future humanized time\n\n  return moment.min(time, now).from(now);\n}\n\nvar smartRender = function smartRender(ElementOrComponentOrLiteral, props, fallback) {\n  if (ElementOrComponentOrLiteral === undefined) {\n    ElementOrComponentOrLiteral = fallback;\n  }\n\n  if (isValidElement(ElementOrComponentOrLiteral)) {\n    // Flow cast through any, to make flow believe it's a React.Element\n    var element = ElementOrComponentOrLiteral;\n    return element;\n  } // Flow cast through any to remove React.Element after previous check\n\n\n  var ComponentOrLiteral = ElementOrComponentOrLiteral;\n\n  if (typeof ComponentOrLiteral === 'string' || typeof ComponentOrLiteral === 'number' || typeof ComponentOrLiteral === 'boolean' || ComponentOrLiteral == null) {\n    return ComponentOrLiteral;\n  }\n\n  return createElement(ComponentOrLiteral, props);\n};\n\nfunction userOrDefault(user) {\n  var actor;\n  var notFound = {\n    id: '!not-found',\n    created_at: '',\n    updated_at: '',\n    data: {\n      name: 'Unknown',\n      profileImage: ''\n    }\n  };\n\n  if (typeof user === 'string' || typeof user.error === 'string') {\n    actor = notFound;\n  } else {\n    //$FlowBug\n    actor = user;\n  }\n\n  return actor;\n}\n\nfunction generateRandomId() {\n  // prettier-ignore\n  return S4() + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + \"-\" + S4() + S4() + S4();\n}\n\nfunction S4() {\n  return ((1 + Math.random()) * 0x10000 | 0).toString(16).substring(1);\n}\n\nfunction dataTransferItemsHaveFiles(items) {\n  if (!items || !items.length) {\n    return false;\n  }\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = items[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var item = _step.value;\n\n      if (item.kind === 'file' || item.type === 'text/html') {\n        return true;\n      }\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return false;\n}\n\nfunction dataTransferItemsToFiles(_x) {\n  return _dataTransferItemsToFiles.apply(this, arguments);\n}\n\nfunction _dataTransferItemsToFiles() {\n  _dataTransferItemsToFiles = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(items) {\n    var fileLikes, blobPromises, _iteratorNormalCompletion2, _didIteratorError2, _iteratorError2, _iterator2, _step2, item, file, parser, _iteratorNormalCompletion3, _didIteratorError3, _iteratorError3, _loop, _iterator3, _step3;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!(!items || !items.length)) {\n              _context3.next = 2;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", []);\n\n          case 2:\n            fileLikes = [];\n            blobPromises = [];\n            _iteratorNormalCompletion2 = true;\n            _didIteratorError2 = false;\n            _iteratorError2 = undefined;\n            _context3.prev = 7;\n\n            for (_iterator2 = items[Symbol.iterator](); !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n              item = _step2.value;\n\n              if (item.kind === 'file') {\n                file = item.getAsFile();\n\n                if (file) {\n                  fileLikes.push(file);\n                }\n              }\n            } // If there are files inside the DataTransferItem prefer those\n\n\n            _context3.next = 15;\n            break;\n\n          case 11:\n            _context3.prev = 11;\n            _context3.t0 = _context3[\"catch\"](7);\n            _didIteratorError2 = true;\n            _iteratorError2 = _context3.t0;\n\n          case 15:\n            _context3.prev = 15;\n            _context3.prev = 16;\n\n            if (!_iteratorNormalCompletion2 && _iterator2[\"return\"] != null) {\n              _iterator2[\"return\"]();\n            }\n\n          case 18:\n            _context3.prev = 18;\n\n            if (!_didIteratorError2) {\n              _context3.next = 21;\n              break;\n            }\n\n            throw _iteratorError2;\n\n          case 21:\n            return _context3.finish(18);\n\n          case 22:\n            return _context3.finish(15);\n\n          case 23:\n            if (!fileLikes.length) {\n              _context3.next = 25;\n              break;\n            }\n\n            return _context3.abrupt(\"return\", fileLikes);\n\n          case 25:\n            // Otherwise extract images from html\n            parser = new DOMParser();\n            _iteratorNormalCompletion3 = true;\n            _didIteratorError3 = false;\n            _iteratorError3 = undefined;\n            _context3.prev = 29;\n\n            _loop = function _loop() {\n              var item = _step3.value;\n\n              if (item.type === 'text/html') {\n                blobPromises.push(new Promise(function (accept) {\n                  item.getAsString(\n                  /*#__PURE__*/\n                  function () {\n                    var _ref = _asyncToGenerator(\n                    /*#__PURE__*/\n                    _regeneratorRuntime.mark(function _callee2(s) {\n                      var doc, imageTags, imagePromises, _iteratorNormalCompletion4, _didIteratorError4, _iteratorError4, _loop2, _iterator4, _step4, _ret;\n\n                      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                        while (1) {\n                          switch (_context2.prev = _context2.next) {\n                            case 0:\n                              doc = parser.parseFromString(s, 'text/html');\n                              imageTags = doc.getElementsByTagName('img');\n                              imagePromises = [];\n                              _iteratorNormalCompletion4 = true;\n                              _didIteratorError4 = false;\n                              _iteratorError4 = undefined;\n                              _context2.prev = 6;\n\n                              _loop2 = function _loop2() {\n                                var tag = _step4.value;\n\n                                if (!tag.src) {\n                                  return \"continue\";\n                                }\n\n                                imagePromises.push(_asyncToGenerator(\n                                /*#__PURE__*/\n                                _regeneratorRuntime.mark(function _callee() {\n                                  var res, contentType, buf, blob;\n                                  return _regeneratorRuntime.wrap(function _callee$(_context) {\n                                    while (1) {\n                                      switch (_context.prev = _context.next) {\n                                        case 0:\n                                          _context.prev = 0;\n                                          _context.next = 3;\n                                          return fetch(tag.src);\n\n                                        case 3:\n                                          res = _context.sent;\n                                          _context.next = 9;\n                                          break;\n\n                                        case 6:\n                                          _context.prev = 6;\n                                          _context.t0 = _context[\"catch\"](0);\n                                          return _context.abrupt(\"return\");\n\n                                        case 9:\n                                          contentType = res.headers.get('Content-type') || 'application/octet-stream';\n                                          _context.next = 12;\n                                          return res.arrayBuffer();\n\n                                        case 12:\n                                          buf = _context.sent;\n                                          blob = new Blob([buf], {\n                                            type: contentType\n                                          });\n                                          fileLikes.push(blob);\n\n                                        case 15:\n                                        case \"end\":\n                                          return _context.stop();\n                                      }\n                                    }\n                                  }, _callee, null, [[0, 6]]);\n                                }))());\n                              };\n\n                              _iterator4 = imageTags[Symbol.iterator]();\n\n                            case 9:\n                              if (_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done) {\n                                _context2.next = 16;\n                                break;\n                              }\n\n                              _ret = _loop2();\n\n                              if (!(_ret === \"continue\")) {\n                                _context2.next = 13;\n                                break;\n                              }\n\n                              return _context2.abrupt(\"continue\", 13);\n\n                            case 13:\n                              _iteratorNormalCompletion4 = true;\n                              _context2.next = 9;\n                              break;\n\n                            case 16:\n                              _context2.next = 22;\n                              break;\n\n                            case 18:\n                              _context2.prev = 18;\n                              _context2.t0 = _context2[\"catch\"](6);\n                              _didIteratorError4 = true;\n                              _iteratorError4 = _context2.t0;\n\n                            case 22:\n                              _context2.prev = 22;\n                              _context2.prev = 23;\n\n                              if (!_iteratorNormalCompletion4 && _iterator4[\"return\"] != null) {\n                                _iterator4[\"return\"]();\n                              }\n\n                            case 25:\n                              _context2.prev = 25;\n\n                              if (!_didIteratorError4) {\n                                _context2.next = 28;\n                                break;\n                              }\n\n                              throw _iteratorError4;\n\n                            case 28:\n                              return _context2.finish(25);\n\n                            case 29:\n                              return _context2.finish(22);\n\n                            case 30:\n                              _context2.next = 32;\n                              return Promise.all(imagePromises);\n\n                            case 32:\n                              accept();\n\n                            case 33:\n                            case \"end\":\n                              return _context2.stop();\n                          }\n                        }\n                      }, _callee2, null, [[6, 18, 22, 30], [23,, 25, 29]]);\n                    }));\n\n                    return function (_x2) {\n                      return _ref.apply(this, arguments);\n                    };\n                  }());\n                }));\n              }\n            };\n\n            for (_iterator3 = items[Symbol.iterator](); !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              _loop();\n            }\n\n            _context3.next = 38;\n            break;\n\n          case 34:\n            _context3.prev = 34;\n            _context3.t1 = _context3[\"catch\"](29);\n            _didIteratorError3 = true;\n            _iteratorError3 = _context3.t1;\n\n          case 38:\n            _context3.prev = 38;\n            _context3.prev = 39;\n\n            if (!_iteratorNormalCompletion3 && _iterator3[\"return\"] != null) {\n              _iterator3[\"return\"]();\n            }\n\n          case 41:\n            _context3.prev = 41;\n\n            if (!_didIteratorError3) {\n              _context3.next = 44;\n              break;\n            }\n\n            throw _iteratorError3;\n\n          case 44:\n            return _context3.finish(41);\n\n          case 45:\n            return _context3.finish(38);\n\n          case 46:\n            _context3.next = 48;\n            return Promise.all(blobPromises);\n\n          case 48:\n            return _context3.abrupt(\"return\", fileLikes);\n\n          case 49:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[7, 11, 15, 23], [16,, 18, 22], [29, 34, 38, 46], [39,, 41, 45]]);\n  }));\n  return _dataTransferItemsToFiles.apply(this, arguments);\n}\n\nfunction inputValueFromEvent(event) {\n  if (!event) {\n    return;\n  }\n\n  var target;\n\n  if (event.currentTarget) {\n    target = event.currentTarget;\n  } else {\n    target = event.target;\n  } // Trick flow into believing the target maybe has a value field\n\n\n  var inputTarget = target;\n  return inputTarget.value;\n}\n\nfunction sanitizeURL(url) {\n  if (url == null) {\n    return url;\n  }\n\n  var proto = URL(url).protocol; // allow http, https, ftp\n  // IMPORTANT: Don't allow data: protocol because of:\n  // <a href=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk7PC9zY3JpcHQ+\" target=\"_blank\">here</a>\n\n  if (proto === 'https:' || proto === 'http:' || proto === 'ftp:') {\n    return url;\n  }\n\n  return undefined;\n}\n\nvar textRenderer = function textRenderer(text, parentClass, onClickMention, onClickHashtag) {\n  return text.split(' ').map(function (word, i) {\n    if (onClickMention && word.includes('@')) {\n      var mention = twitter.extractMentions(word);\n      if (!mention.length) return word;\n      return createElement(Fragment, {\n        key: \"item-\".concat(i)\n      }, !word.startsWith(\"@\".concat(mention[0])) && word.slice(0, word.indexOf(mention[0]) - 1), createElement(\"a\", {\n        onClick: function onClick() {\n          return onClickMention && onClickMention(mention[0]);\n        },\n        className: \"\".concat(parentClass, \"__mention\")\n      }, \"@\", mention[0]), !word.endsWith(mention[0]) && word.slice(word.indexOf(mention[0]) + mention[0].length));\n    } else if (onClickHashtag && word.includes('#')) {\n      var hashtag = twitter.extractHashtags(word);\n      if (!hashtag.length) return word;\n      return createElement(Fragment, {\n        key: \"item-\".concat(i)\n      }, !word.startsWith(\"#\".concat(hashtag[0])) && word.slice(0, word.indexOf(hashtag[0]) - 1), createElement(\"a\", {\n        onClick: function onClick() {\n          return onClickHashtag && onClickHashtag(hashtag[0]);\n        },\n        className: \"\".concat(parentClass, \"__hashtag\")\n      }, \"#\", hashtag[0]), !word.endsWith(hashtag[0]) && word.slice(word.indexOf(hashtag[0]) + hashtag[0].length));\n    }\n\n    if (anchorme.validate.url(word) || anchorme.validate.email(word)) {\n      var link = anchorme(word, {\n        list: true\n      });\n\n      if (link[0].protocol !== 'http://' && link[0].protocol !== 'https://' && link[0].protocol !== 'mailto:') {\n        return word;\n      }\n\n      var url = link[0].protocol + link[0].encoded;\n\n      var urlText = _truncate(link[0].encoded, {\n        length: 33\n      });\n\n      return createElement(\"a\", {\n        href: url,\n        className: \"\".concat(parentClass, \"__link\"),\n        target: \"blank\",\n        rel: \"noopener\",\n        key: \"item-\".concat(i)\n      }, urlText);\n    }\n\n    return word;\n  }).reduce(function (accu, elem) {\n    return accu === null ? [elem] : [accu, ' ', elem];\n  });\n};\n\nvar FeedManager =\n/*#__PURE__*/\nfunction () {\n  function FeedManager(props) {\n    var _this = this;\n\n    _classCallCheck(this, FeedManager);\n\n    _defineProperty(this, \"props\", void 0);\n\n    _defineProperty(this, \"state\", {\n      activityOrder: [],\n      activities: immutable.Map(),\n      activityIdToPath: {},\n      activityIdToPaths: {},\n      reactionIdToPaths: {},\n      reactionActivities: {},\n      lastResponse: null,\n      lastReverseResponse: null,\n      refreshing: false,\n      realtimeAdds: [],\n      realtimeDeletes: [],\n      subscription: null,\n      unread: 0,\n      unseen: 0,\n      numSubscribers: 0,\n      reactionsBeingToggled: {},\n      childReactionsBeingToggled: {}\n    });\n\n    _defineProperty(this, \"registeredCallbacks\", void 0);\n\n    _defineProperty(this, \"setState\", function (changed) {\n      if (typeof changed === 'function') {\n        changed = changed(_this.state);\n      }\n\n      _this.state = _objectSpread({}, _this.state, changed);\n\n      _this.triggerUpdate();\n    });\n\n    _defineProperty(this, \"trackAnalytics\", function (label, activity, track) {\n      var analyticsClient = _this.props.analyticsClient;\n\n      if (!track) {\n        return;\n      }\n\n      if (!analyticsClient) {\n        console.warn('trackAnalytics was enabled, but analytics client was not initialized. ' + 'Please set the analyticsToken prop on StreamApp');\n        return;\n      }\n\n      var feed = _this.props.client.feed(_this.props.feedGroup, _this.props.userId);\n\n      analyticsClient.trackEngagement({\n        label: label,\n        feed_id: feed.id,\n        content: {\n          foreign_id: activity.foreign_id\n        },\n        location: _this.props.analyticsLocation\n      });\n    });\n\n    _defineProperty(this, \"getActivityPath\", function (activity) {\n      var activityId;\n\n      if (typeof activity === 'string') {\n        activityId = activity;\n      } else {\n        activityId = activity.id;\n      }\n\n      var activityPath = _this.state.activityIdToPath[activityId];\n\n      for (var _len = arguments.length, rest = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        rest[_key - 1] = arguments[_key];\n      }\n\n      if (activityPath === undefined) {\n        return [activityId].concat(rest);\n      }\n\n      return [].concat(_toConsumableArray(activityPath), rest);\n    });\n\n    _defineProperty(this, \"getActivityPaths\", function (activity) {\n      var activityId;\n\n      if (typeof activity === 'string') {\n        activityId = activity;\n      } else {\n        activityId = activity.id;\n      }\n\n      return _this.state.activityIdToPaths[activityId];\n    });\n\n    _defineProperty(this, \"getReactionPaths\", function (reaction) {\n      var reactionId;\n\n      if (typeof reaction === 'string') {\n        reactionId = reaction;\n      } else {\n        reactionId = reaction.id;\n      }\n\n      return _this.state.reactionIdToPaths[reactionId];\n    });\n\n    _defineProperty(this, \"onAddReaction\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(kind, activity, data) {\n        var options,\n            reaction,\n            enrichedReaction,\n            _args = arguments;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                options = _args.length > 3 && _args[3] !== undefined ? _args[3] : {};\n                _context.prev = 1;\n\n                if (!_this.props.doReactionAddRequest) {\n                  _context.next = 8;\n                  break;\n                }\n\n                _context.next = 5;\n                return _this.props.doReactionAddRequest(kind, activity, data, options);\n\n              case 5:\n                reaction = _context.sent;\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.next = 10;\n                return _this.props.client.reactions.add(kind, activity, data, options);\n\n              case 10:\n                reaction = _context.sent;\n\n              case 11:\n                _context.next = 17;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](1);\n\n                _this.props.errorHandler(_context.t0, 'add-reaction', {\n                  kind: kind,\n                  activity: activity,\n                  feedGroup: _this.props.feedGroup,\n                  userId: _this.props.userId\n                });\n\n                return _context.abrupt(\"return\");\n\n              case 17:\n                _this.trackAnalytics(kind, activity, options.trackAnalytics);\n\n                enrichedReaction = immutable.fromJS(_objectSpread({}, reaction, {\n                  user: _this.props.user.full\n                }));\n\n                _this.setState(function (prevState) {\n                  var activities = prevState.activities;\n                  var reactionIdToPaths = prevState.reactionIdToPaths;\n                  var _iteratorNormalCompletion = true;\n                  var _didIteratorError = false;\n                  var _iteratorError = undefined;\n\n                  try {\n                    for (var _iterator = _this.getActivityPaths(activity)[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                      var path = _step.value;\n\n                      _this.removeFoundReactionIdPaths(activities.getIn(path).toJS(), reactionIdToPaths, path);\n\n                      activities = activities.updateIn([].concat(_toConsumableArray(path), ['reaction_counts', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n                        return v + 1;\n                      }).updateIn([].concat(_toConsumableArray(path), ['own_reactions', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.unshift(enrichedReaction);\n                      }).updateIn([].concat(_toConsumableArray(path), ['latest_reactions', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.unshift(enrichedReaction);\n                      });\n\n                      _this.addFoundReactionIdPaths(activities.getIn(path).toJS(), reactionIdToPaths, path);\n                    }\n                  } catch (err) {\n                    _didIteratorError = true;\n                    _iteratorError = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n                        _iterator[\"return\"]();\n                      }\n                    } finally {\n                      if (_didIteratorError) {\n                        throw _iteratorError;\n                      }\n                    }\n                  }\n\n                  return {\n                    activities: activities,\n                    reactionIdToPaths: reactionIdToPaths\n                  };\n                });\n\n              case 20:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 13]]);\n      }));\n\n      return function (_x, _x2, _x3) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"onRemoveReaction\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(kind, activity, id) {\n        var options,\n            _args2 = arguments;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                options = _args2.length > 3 && _args2[3] !== undefined ? _args2[3] : {};\n                _context2.prev = 1;\n\n                if (!_this.props.doReactionDeleteRequest) {\n                  _context2.next = 7;\n                  break;\n                }\n\n                _context2.next = 5;\n                return _this.props.doReactionDeleteRequest(id);\n\n              case 5:\n                _context2.next = 9;\n                break;\n\n              case 7:\n                _context2.next = 9;\n                return _this.props.client.reactions[\"delete\"](id);\n\n              case 9:\n                _context2.next = 15;\n                break;\n\n              case 11:\n                _context2.prev = 11;\n                _context2.t0 = _context2[\"catch\"](1);\n\n                _this.props.errorHandler(_context2.t0, 'delete-reaction', {\n                  kind: kind,\n                  activity: activity,\n                  feedGroup: _this.props.feedGroup,\n                  userId: _this.props.userId\n                });\n\n                return _context2.abrupt(\"return\");\n\n              case 15:\n                _this.trackAnalytics('un' + kind, activity, options.trackAnalytics);\n\n                _this.setState(function (prevState) {\n                  var activities = prevState.activities;\n                  var reactionIdToPaths = prevState.reactionIdToPaths;\n                  var _iteratorNormalCompletion2 = true;\n                  var _didIteratorError2 = false;\n                  var _iteratorError2 = undefined;\n\n                  try {\n                    for (var _iterator2 = _this.getActivityPaths(activity)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                      var path = _step2.value;\n\n                      _this.removeFoundReactionIdPaths(activities.getIn(path).toJS(), reactionIdToPaths, path);\n\n                      activities = activities.updateIn([].concat(_toConsumableArray(path), ['reaction_counts', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n                        return v - 1;\n                      }).updateIn([].concat(_toConsumableArray(path), ['own_reactions', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.remove(v.findIndex(function (r) {\n                          return r.get('id') === id;\n                        }));\n                      }).updateIn([].concat(_toConsumableArray(path), ['latest_reactions', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.remove(v.findIndex(function (r) {\n                          return r.get('id') === id;\n                        }));\n                      });\n\n                      _this.addFoundReactionIdPaths(activities.getIn(path).toJS(), reactionIdToPaths, path);\n                    }\n                  } catch (err) {\n                    _didIteratorError2 = true;\n                    _iteratorError2 = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion2 && _iterator2[\"return\"] != null) {\n                        _iterator2[\"return\"]();\n                      }\n                    } finally {\n                      if (_didIteratorError2) {\n                        throw _iteratorError2;\n                      }\n                    }\n                  }\n\n                  return {\n                    activities: activities,\n                    reactionIdToPaths: reactionIdToPaths\n                  };\n                });\n\n                if (_this.state.reactionActivities[id]) {\n                  _this._removeActivityFromState(_this.state.reactionActivities[id]);\n                }\n\n              case 18:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[1, 11]]);\n      }));\n\n      return function (_x4, _x5, _x6) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"onToggleReaction\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(kind, activity, data) {\n        var options,\n            togglingReactions,\n            currentReactions,\n            last,\n            _args3 = arguments;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                options = _args3.length > 3 && _args3[3] !== undefined ? _args3[3] : {};\n                togglingReactions = _this.state.reactionsBeingToggled[kind] || {};\n\n                if (!togglingReactions[activity.id]) {\n                  _context3.next = 4;\n                  break;\n                }\n\n                return _context3.abrupt(\"return\");\n\n              case 4:\n                togglingReactions[activity.id] = true;\n                _this.state.reactionsBeingToggled[kind] = togglingReactions;\n                currentReactions = _this.state.activities.getIn([].concat(_toConsumableArray(_this.getActivityPaths(activity)[0]), ['own_reactions', kind]), immutable.List());\n                last = currentReactions.last();\n\n                if (!last) {\n                  _context3.next = 13;\n                  break;\n                }\n\n                _context3.next = 11;\n                return _this.onRemoveReaction(kind, activity, last.get('id'), options);\n\n              case 11:\n                _context3.next = 15;\n                break;\n\n              case 13:\n                _context3.next = 15;\n                return _this.onAddReaction(kind, activity, data, options);\n\n              case 15:\n                delete togglingReactions[activity.id];\n\n              case 16:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x7, _x8, _x9) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"onAddChildReaction\",\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(kind, reaction, data) {\n        var options,\n            childReaction,\n            enrichedReaction,\n            _args4 = arguments;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                options = _args4.length > 3 && _args4[3] !== undefined ? _args4[3] : {};\n                _context4.prev = 1;\n\n                if (!_this.props.doChildReactionAddRequest) {\n                  _context4.next = 8;\n                  break;\n                }\n\n                _context4.next = 5;\n                return _this.props.doChildReactionAddRequest(kind, reaction, data, options);\n\n              case 5:\n                childReaction = _context4.sent;\n                _context4.next = 11;\n                break;\n\n              case 8:\n                _context4.next = 10;\n                return _this.props.client.reactions.addChild(kind, reaction, data, options);\n\n              case 10:\n                childReaction = _context4.sent;\n\n              case 11:\n                _context4.next = 17;\n                break;\n\n              case 13:\n                _context4.prev = 13;\n                _context4.t0 = _context4[\"catch\"](1);\n\n                _this.props.errorHandler(_context4.t0, 'add-child-reaction', {\n                  kind: kind,\n                  reaction: reaction,\n                  feedGroup: _this.props.feedGroup,\n                  userId: _this.props.userId\n                });\n\n                return _context4.abrupt(\"return\");\n\n              case 17:\n                // this.trackAnalytics(kind, reaction, options.trackAnalytics);\n                enrichedReaction = immutable.fromJS(_objectSpread({}, childReaction, {\n                  user: _this.props.user.full\n                }));\n\n                _this.setState(function (prevState) {\n                  var activities = prevState.activities;\n                  var _iteratorNormalCompletion3 = true;\n                  var _didIteratorError3 = false;\n                  var _iteratorError3 = undefined;\n\n                  try {\n                    for (var _iterator3 = _this.getReactionPaths(reaction)[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n                      var path = _step3.value;\n                      activities = activities.updateIn([].concat(_toConsumableArray(path), ['children_counts', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n                        return v + 1;\n                      }).updateIn([].concat(_toConsumableArray(path), ['own_children', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.unshift(enrichedReaction);\n                      }).updateIn([].concat(_toConsumableArray(path), ['latest_children', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.unshift(enrichedReaction);\n                      });\n                    }\n                  } catch (err) {\n                    _didIteratorError3 = true;\n                    _iteratorError3 = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion3 && _iterator3[\"return\"] != null) {\n                        _iterator3[\"return\"]();\n                      }\n                    } finally {\n                      if (_didIteratorError3) {\n                        throw _iteratorError3;\n                      }\n                    }\n                  }\n\n                  return {\n                    activities: activities\n                  };\n                });\n\n              case 19:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, null, [[1, 13]]);\n      }));\n\n      return function (_x10, _x11, _x12) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"onRemoveChildReaction\",\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(kind, reaction, id) {\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 1;\n\n                if (!_this.props.doChildReactionDeleteRequest) {\n                  _context5.next = 7;\n                  break;\n                }\n\n                _context5.next = 5;\n                return _this.props.doChildReactionDeleteRequest(id);\n\n              case 5:\n                _context5.next = 9;\n                break;\n\n              case 7:\n                _context5.next = 9;\n                return _this.props.client.reactions[\"delete\"](id);\n\n              case 9:\n                _context5.next = 15;\n                break;\n\n              case 11:\n                _context5.prev = 11;\n                _context5.t0 = _context5[\"catch\"](1);\n\n                _this.props.errorHandler(_context5.t0, 'delete-reaction', {\n                  kind: kind,\n                  reaction: reaction,\n                  feedGroup: _this.props.feedGroup,\n                  userId: _this.props.userId\n                });\n\n                return _context5.abrupt(\"return\");\n\n              case 15:\n                // this.trackAnalytics('un' + kind, reaction, options.trackAnalytics);\n                if (_this.state.reactionActivities[id]) {\n                  _this._removeActivityFromState(_this.state.reactionActivities[id]);\n                }\n\n                return _context5.abrupt(\"return\", _this.setState(function (prevState) {\n                  var activities = prevState.activities;\n                  var _iteratorNormalCompletion4 = true;\n                  var _didIteratorError4 = false;\n                  var _iteratorError4 = undefined;\n\n                  try {\n                    for (var _iterator4 = _this.getReactionPaths(reaction)[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n                      var path = _step4.value;\n                      activities = activities.updateIn([].concat(_toConsumableArray(path), ['children_counts', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n                        return v - 1;\n                      }).updateIn([].concat(_toConsumableArray(path), ['own_children', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.remove(v.findIndex(function (r) {\n                          return r.get('id') === id;\n                        }));\n                      }).updateIn([].concat(_toConsumableArray(path), ['children', kind]), function () {\n                        var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                        return v.remove(v.findIndex(function (r) {\n                          return r.get('id') === id;\n                        }));\n                      });\n                    }\n                  } catch (err) {\n                    _didIteratorError4 = true;\n                    _iteratorError4 = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion4 && _iterator4[\"return\"] != null) {\n                        _iterator4[\"return\"]();\n                      }\n                    } finally {\n                      if (_didIteratorError4) {\n                        throw _iteratorError4;\n                      }\n                    }\n                  }\n\n                  return {\n                    activities: activities\n                  };\n                }));\n\n              case 17:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[1, 11]]);\n      }));\n\n      return function (_x13, _x14, _x15) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"onToggleChildReaction\",\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(kind, reaction, data) {\n        var options,\n            togglingReactions,\n            currentReactions,\n            last,\n            _args6 = arguments;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                options = _args6.length > 3 && _args6[3] !== undefined ? _args6[3] : {};\n                togglingReactions = _this.state.childReactionsBeingToggled[kind] || {};\n\n                if (!togglingReactions[reaction.id]) {\n                  _context6.next = 4;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 4:\n                togglingReactions[reaction.id] = true;\n                _this.state.childReactionsBeingToggled[kind] = togglingReactions;\n                currentReactions = _this.state.activities.getIn([].concat(_toConsumableArray(_this.getReactionPaths(reaction)[0]), ['own_children', kind]), immutable.List());\n                last = currentReactions.last();\n\n                if (!last) {\n                  _context6.next = 13;\n                  break;\n                }\n\n                _context6.next = 11;\n                return _this.onRemoveChildReaction(kind, reaction, last.get('id'), options);\n\n              case 11:\n                _context6.next = 15;\n                break;\n\n              case 13:\n                _context6.next = 15;\n                return _this.onAddChildReaction(kind, reaction, data, options);\n\n              case 15:\n                delete togglingReactions[reaction.id];\n\n              case 16:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6);\n      }));\n\n      return function (_x16, _x17, _x18) {\n        return _ref6.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"_removeActivityFromState\", function (activityId) {\n      return _this.setState(function (_ref7) {\n        var activities = _ref7.activities,\n            activityOrder = _ref7.activityOrder,\n            activityIdToPath = _ref7.activityIdToPath,\n            activityIdToPaths = _ref7.activityIdToPaths,\n            reactionIdToPaths = _ref7.reactionIdToPaths;\n\n        var path = _this.getActivityPath(activityId);\n\n        var outerId = activityId;\n\n        if (path.length > 1) {\n          // It's an aggregated group we should update the paths of everything in\n          // the list\n          var groupArrayPath = path.slice(0, -1);\n          activityIdToPath = _this.removeFoundActivityIdPath(activities.getIn(groupArrayPath).toJS(), activityIdToPath, groupArrayPath);\n          activityIdToPaths = _this.removeFoundActivityIdPaths(activities.getIn(groupArrayPath).toJS(), activityIdToPaths, groupArrayPath);\n          reactionIdToPaths = _this.removeFoundReactionIdPaths(activities.getIn(groupArrayPath).toJS(), reactionIdToPaths, groupArrayPath);\n        } else {\n          // Otherwise remove all things inside this activity from the path\n          // objects\n          activityIdToPaths = _this.removeFoundActivityIdPaths(activities.get(activityId).toJS(), activityIdToPaths, [activityId]);\n          reactionIdToPaths = _this.removeFoundReactionIdPaths(activities.get(activityId).toJS(), reactionIdToPaths, [activityId]);\n        }\n\n        activities = activities.removeIn(path);\n\n        if (path.length > 1) {\n          var _groupArrayPath = path.slice(0, -1);\n\n          if (activities.getIn(_groupArrayPath).size === 0) {\n            outerId = path[0]; //\n          } else {\n            outerId = null;\n          }\n\n          activityIdToPath = _this.addFoundActivityIdPath(activities.getIn(_groupArrayPath).toJS(), activityIdToPath, _groupArrayPath);\n          activityIdToPaths = _this.addFoundActivityIdPaths(activities.getIn(_groupArrayPath).toJS(), activityIdToPaths, _groupArrayPath);\n          reactionIdToPaths = _this.addFoundReactionIdPaths(activities.getIn(_groupArrayPath).toJS(), reactionIdToPaths, _groupArrayPath);\n        }\n\n        if (outerId != null) {\n          activityOrder = activityOrder.filter(function (id) {\n            return id !== outerId;\n          });\n        }\n\n        return {\n          activities: activities,\n          activityOrder: activityOrder,\n          activityIdToPaths: activityIdToPaths,\n          reactionIdToPaths: reactionIdToPaths,\n          activityIdToPath: activityIdToPath\n        };\n      });\n    });\n\n    _defineProperty(this, \"onRemoveActivity\",\n    /*#__PURE__*/\n    function () {\n      var _ref8 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(activityId) {\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.prev = 0;\n\n                if (!_this.props.doActivityDeleteRequest) {\n                  _context7.next = 6;\n                  break;\n                }\n\n                _context7.next = 4;\n                return _this.props.doActivityDeleteRequest(activityId);\n\n              case 4:\n                _context7.next = 8;\n                break;\n\n              case 6:\n                _context7.next = 8;\n                return _this.feed().removeActivity(activityId);\n\n              case 8:\n                _context7.next = 14;\n                break;\n\n              case 10:\n                _context7.prev = 10;\n                _context7.t0 = _context7[\"catch\"](0);\n\n                _this.props.errorHandler(_context7.t0, 'delete-activity', {\n                  activityId: _this.props.feedGroup,\n                  feedGroup: _this.props.feedGroup,\n                  userId: _this.props.userId\n                });\n\n                return _context7.abrupt(\"return\");\n\n              case 14:\n                return _context7.abrupt(\"return\", _this._removeActivityFromState(activityId));\n\n              case 15:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, null, [[0, 10]]);\n      }));\n\n      return function (_x19) {\n        return _ref8.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"onMarkAsRead\", function (group) {\n      return _this._onMarkAs('read', group);\n    });\n\n    _defineProperty(this, \"onMarkAsSeen\", function (group) {\n      return _this._onMarkAs('seen', group);\n    });\n\n    _defineProperty(this, \"_onMarkAs\",\n    /*#__PURE__*/\n    function () {\n      var _ref9 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(type, group) {\n        var groupArray, markArg;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                markArg = group;\n\n                if (group === true) {\n                  groupArray = _this.state.activityOrder;\n                } else if (Array.isArray(group)) {\n                  groupArray = group.map(function (g) {\n                    return g.id;\n                  });\n                  markArg = groupArray;\n                } else {\n                  markArg = group.id;\n                  groupArray = [group.id];\n                }\n\n                _context8.prev = 2;\n                _context8.next = 5;\n                return _this.doFeedRequest(_defineProperty({\n                  limit: 1,\n                  id_lte: _this.state.activityOrder[0]\n                }, 'mark_' + type, markArg));\n\n              case 5:\n                _context8.next = 10;\n                break;\n\n              case 7:\n                _context8.prev = 7;\n                _context8.t0 = _context8[\"catch\"](2);\n\n                _this.props.errorHandler(_context8.t0, 'get-notification-counts', {\n                  feedGroup: _this.props.feedGroup,\n                  userId: _this.props.userId\n                });\n\n              case 10:\n                _this.setState(function (prevState) {\n                  var counterKey = 'un' + type;\n                  var activities = prevState.activities;\n                  var counter = prevState[counterKey];\n                  var _iteratorNormalCompletion5 = true;\n                  var _didIteratorError5 = false;\n                  var _iteratorError5 = undefined;\n\n                  try {\n                    for (var _iterator5 = groupArray[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n                      var groupId = _step5.value;\n                      var markerPath = [groupId, 'is_' + type];\n\n                      if (activities.getIn(markerPath) !== false) {\n                        continue;\n                      }\n\n                      activities = activities.setIn(markerPath, true);\n                      counter--;\n                    }\n                  } catch (err) {\n                    _didIteratorError5 = true;\n                    _iteratorError5 = err;\n                  } finally {\n                    try {\n                      if (!_iteratorNormalCompletion5 && _iterator5[\"return\"] != null) {\n                        _iterator5[\"return\"]();\n                      }\n                    } finally {\n                      if (_didIteratorError5) {\n                        throw _iteratorError5;\n                      }\n                    }\n                  }\n\n                  return _defineProperty({\n                    activities: activities\n                  }, counterKey, counter);\n                });\n\n              case 11:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, null, [[2, 7]]);\n      }));\n\n      return function (_x20, _x21) {\n        return _ref9.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"getOptions\", function () {\n      var extraOptions = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      var propOpts = _objectSpread({}, _this.props.options);\n\n      var id_gt = extraOptions.id_gt,\n          id_gte = extraOptions.id_gte,\n          id_lt = extraOptions.id_lt,\n          id_lte = extraOptions.id_lte,\n          offset = extraOptions.offset;\n\n      if (id_gt || id_gte || id_lt || id_lte || offset != null) {\n        delete propOpts.id_gt;\n        delete propOpts.id_gte;\n        delete propOpts.id_lt;\n        delete propOpts.id_lte;\n        delete propOpts.offset;\n        delete propOpts.refresh;\n      }\n\n      return _objectSpread({\n        withReactionCounts: true,\n        withOwnReactions: true,\n        limit: 10\n      }, propOpts, extraOptions);\n    });\n\n    _defineProperty(this, \"doFeedRequest\", function (options) {\n      if (_this.props.doFeedRequest) {\n        return _this.props.doFeedRequest(_this.props.client, _this.props.feedGroup, _this.props.userId, options);\n      }\n\n      return _this.feed().get(options);\n    });\n\n    _defineProperty(this, \"feed\", function () {\n      return _this.props.client.feed(_this.props.feedGroup, _this.props.userId);\n    });\n\n    _defineProperty(this, \"responseToActivityMap\", function (response) {\n      return immutable.fromJS(response.results.reduce(function (map, a) {\n        map[a.id] = a;\n        return map;\n      }, {}));\n    });\n\n    _defineProperty(this, \"responseToActivityIdToPath\", function (response) {\n      if (response.results.length === 0 || response.results[0].activities === undefined) {\n        return {};\n      }\n\n      var aggregatedResponse = response;\n      var map = {};\n      var _iteratorNormalCompletion6 = true;\n      var _didIteratorError6 = false;\n      var _iteratorError6 = undefined;\n\n      try {\n        var _loop = function _loop() {\n          var group = _step6.value;\n          group.activities.forEach(function (act, i) {\n            map[act.id] = [group.id, 'activities', i];\n          });\n        };\n\n        for (var _iterator6 = aggregatedResponse.results[Symbol.iterator](), _step6; !(_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done); _iteratorNormalCompletion6 = true) {\n          _loop();\n        }\n      } catch (err) {\n        _didIteratorError6 = true;\n        _iteratorError6 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion6 && _iterator6[\"return\"] != null) {\n            _iterator6[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError6) {\n            throw _iteratorError6;\n          }\n        }\n      }\n\n      return map;\n    });\n\n    _defineProperty(this, \"responseToActivityIdToPaths\", function (response) {\n      var previous = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var map = previous;\n      var currentPath = [];\n\n      function addFoundActivities(obj) {\n        if (Array.isArray(obj)) {\n          obj.forEach(function (v, i) {\n            currentPath.push(i);\n            addFoundActivities(v);\n            currentPath.pop();\n          });\n        } else if (_isPlainObject(obj)) {\n          if (obj.id && obj.actor && obj.verb && obj.object) {\n            if (!map[obj.id]) {\n              map[obj.id] = [];\n            }\n\n            map[obj.id].push([].concat(currentPath));\n          }\n\n          for (var k in obj) {\n            currentPath.push(k);\n            addFoundActivities(obj[k]);\n            currentPath.pop();\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion7 = true;\n      var _didIteratorError7 = false;\n      var _iteratorError7 = undefined;\n\n      try {\n        for (var _iterator7 = response.results[Symbol.iterator](), _step7; !(_iteratorNormalCompletion7 = (_step7 = _iterator7.next()).done); _iteratorNormalCompletion7 = true) {\n          var a = _step7.value;\n          currentPath.push(a.id);\n          addFoundActivities(a);\n          currentPath.pop();\n        }\n      } catch (err) {\n        _didIteratorError7 = true;\n        _iteratorError7 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion7 && _iterator7[\"return\"] != null) {\n            _iterator7[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError7) {\n            throw _iteratorError7;\n          }\n        }\n      }\n\n      return map;\n    });\n\n    _defineProperty(this, \"feedResponseToReactionIdToPaths\", function (response) {\n      var previous = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var map = previous;\n      var currentPath = [];\n\n      function addFoundReactions(obj) {\n        if (Array.isArray(obj)) {\n          obj.forEach(function (v, i) {\n            currentPath.push(i);\n            addFoundReactions(v);\n            currentPath.pop();\n          });\n        } else if (_isPlainObject(obj)) {\n          if (obj.id && obj.kind && obj.data) {\n            if (!map[obj.id]) {\n              map[obj.id] = [];\n            }\n\n            map[obj.id].push([].concat(currentPath));\n          }\n\n          for (var k in obj) {\n            currentPath.push(k);\n            addFoundReactions(obj[k]);\n            currentPath.pop();\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion8 = true;\n      var _didIteratorError8 = false;\n      var _iteratorError8 = undefined;\n\n      try {\n        for (var _iterator8 = response.results[Symbol.iterator](), _step8; !(_iteratorNormalCompletion8 = (_step8 = _iterator8.next()).done); _iteratorNormalCompletion8 = true) {\n          var a = _step8.value;\n          currentPath.push(a.id);\n          addFoundReactions(a);\n          currentPath.pop();\n        }\n      } catch (err) {\n        _didIteratorError8 = true;\n        _iteratorError8 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion8 && _iterator8[\"return\"] != null) {\n            _iterator8[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError8) {\n            throw _iteratorError8;\n          }\n        }\n      }\n\n      return map;\n    });\n\n    _defineProperty(this, \"reactionResponseToReactionIdToPaths\", function (response, previous, basePath, oldLength) {\n      var map = previous;\n\n      var currentPath = _toConsumableArray(basePath);\n\n      function addFoundReactions(obj) {\n        if (Array.isArray(obj)) {\n          obj.forEach(function (v, i) {\n            currentPath.push(i);\n            addFoundReactions(v);\n            currentPath.pop();\n          });\n        } else if (_isPlainObject(obj)) {\n          if (obj.id && obj.kind && obj.data) {\n            if (!map[obj.id]) {\n              map[obj.id] = [];\n            }\n\n            map[obj.id].push(_toConsumableArray(currentPath));\n          }\n\n          for (var k in obj) {\n            currentPath.push(k);\n            addFoundReactions(obj[k]);\n            currentPath.pop();\n          }\n        }\n      }\n\n      var _iteratorNormalCompletion9 = true;\n      var _didIteratorError9 = false;\n      var _iteratorError9 = undefined;\n\n      try {\n        for (var _iterator9 = response.results[Symbol.iterator](), _step9; !(_iteratorNormalCompletion9 = (_step9 = _iterator9.next()).done); _iteratorNormalCompletion9 = true) {\n          var a = _step9.value;\n          currentPath.push(oldLength);\n          addFoundReactions(a);\n          currentPath.pop();\n          oldLength++;\n        }\n      } catch (err) {\n        _didIteratorError9 = true;\n        _iteratorError9 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion9 && _iterator9[\"return\"] != null) {\n            _iterator9[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError9) {\n            throw _iteratorError9;\n          }\n        }\n      }\n\n      return map;\n    });\n\n    _defineProperty(this, \"removeFoundReactionIdPaths\", function (data, previous, basePath) {\n      var map = previous;\n\n      var currentPath = _toConsumableArray(basePath);\n\n      function removeFoundReactions(obj) {\n        if (Array.isArray(obj)) {\n          obj.forEach(function (v, i) {\n            currentPath.push(i);\n            removeFoundReactions(v);\n            currentPath.pop();\n          });\n        } else if (_isPlainObject(obj)) {\n          if (obj.id && obj.kind && obj.data) {\n            if (!map[obj.id]) {\n              map[obj.id] = [];\n            }\n\n            _remove(map[obj.id], function (path) {\n              return _isEqual(path, currentPath);\n            });\n          }\n\n          for (var k in obj) {\n            currentPath.push(k);\n            removeFoundReactions(obj[k]);\n            currentPath.pop();\n          }\n        }\n      }\n\n      removeFoundReactions(data);\n      return map;\n    });\n\n    _defineProperty(this, \"removeFoundActivityIdPaths\", function (data, previous, basePath) {\n      var map = previous;\n\n      var currentPath = _toConsumableArray(basePath);\n\n      function addFoundActivities(obj) {\n        if (Array.isArray(obj)) {\n          obj.forEach(function (v, i) {\n            currentPath.push(i);\n            addFoundActivities(v);\n            currentPath.pop();\n          });\n        } else if (_isPlainObject(obj)) {\n          if (obj.id && obj.actor && obj.verb && obj.object) {\n            if (!map[obj.id]) {\n              map[obj.id] = [];\n            }\n\n            _remove(map[obj.id], function (path) {\n              return _isEqual(path, currentPath);\n            });\n          }\n\n          for (var k in obj) {\n            currentPath.push(k);\n            addFoundActivities(obj[k]);\n            currentPath.pop();\n          }\n        }\n      }\n\n      addFoundActivities(data);\n      return map;\n    });\n\n    _defineProperty(this, \"removeFoundActivityIdPath\", function (data, previous, basePath) {\n      var map = previous;\n\n      var currentPath = _toConsumableArray(basePath);\n\n      data.forEach(function (obj, i) {\n        currentPath.push(i);\n\n        if (_isEqual(map[obj.id], currentPath)) {\n          delete map[obj.id];\n        }\n\n        currentPath.pop();\n      });\n      return map;\n    });\n\n    _defineProperty(this, \"addFoundReactionIdPaths\", function (data, previous, basePath) {\n      var map = previous;\n\n      var currentPath = _toConsumableArray(basePath);\n\n      function addFoundReactions(obj) {\n        if (Array.isArray(obj)) {\n          obj.forEach(function (v, i) {\n            currentPath.push(i);\n            addFoundReactions(v);\n            currentPath.pop();\n          });\n        } else if (_isPlainObject(obj)) {\n          if (obj.id && obj.kind && obj.data) {\n            if (!map[obj.id]) {\n              map[obj.id] = [];\n            }\n\n            map[obj.id].push(_toConsumableArray(currentPath));\n          }\n\n          for (var k in obj) {\n            currentPath.push(k);\n            addFoundReactions(obj[k]);\n            currentPath.pop();\n          }\n        }\n      }\n\n      addFoundReactions(data);\n      return map;\n    });\n\n    _defineProperty(this, \"addFoundActivityIdPaths\", function (data, previous, basePath) {\n      var map = previous;\n\n      var currentPath = _toConsumableArray(basePath);\n\n      function addFoundActivities(obj) {\n        if (Array.isArray(obj)) {\n          obj.forEach(function (v, i) {\n            currentPath.push(i);\n            addFoundActivities(v);\n            currentPath.pop();\n          });\n        } else if (_isPlainObject(obj)) {\n          if (obj.id && obj.actor && obj.verb && obj.object) {\n            if (!map[obj.id]) {\n              map[obj.id] = [];\n            }\n\n            map[obj.id].push(_toConsumableArray(currentPath));\n          }\n\n          for (var k in obj) {\n            currentPath.push(k);\n            addFoundActivities(obj[k]);\n            currentPath.pop();\n          }\n        }\n      }\n\n      addFoundActivities(data);\n      return map;\n    });\n\n    _defineProperty(this, \"addFoundActivityIdPath\", function (data, previous, basePath) {\n      var map = previous;\n      data.forEach(function (obj, i) {\n        map[obj.id] = [].concat(_toConsumableArray(basePath), [i]);\n      });\n      return map;\n    });\n\n    _defineProperty(this, \"responseToReactionActivities\", function (response) {\n      if (response.results.length === 0) {\n        return {};\n      }\n\n      var map = {};\n\n      function setReactionActivities(activities) {\n        var _iteratorNormalCompletion10 = true;\n        var _didIteratorError10 = false;\n        var _iteratorError10 = undefined;\n\n        try {\n          for (var _iterator10 = activities[Symbol.iterator](), _step10; !(_iteratorNormalCompletion10 = (_step10 = _iterator10.next()).done); _iteratorNormalCompletion10 = true) {\n            var a = _step10.value;\n\n            if (a.reaction && a.reaction.id) {\n              map[a.reaction.id] = a.id;\n            }\n          }\n        } catch (err) {\n          _didIteratorError10 = true;\n          _iteratorError10 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion10 && _iterator10[\"return\"] != null) {\n              _iterator10[\"return\"]();\n            }\n          } finally {\n            if (_didIteratorError10) {\n              throw _iteratorError10;\n            }\n          }\n        }\n      }\n\n      if (response.results[0].activities === undefined) {\n        setReactionActivities(response.results);\n      } else {\n        var aggregatedResponse = response;\n        var _iteratorNormalCompletion11 = true;\n        var _didIteratorError11 = false;\n        var _iteratorError11 = undefined;\n\n        try {\n          for (var _iterator11 = aggregatedResponse.results[Symbol.iterator](), _step11; !(_iteratorNormalCompletion11 = (_step11 = _iterator11.next()).done); _iteratorNormalCompletion11 = true) {\n            var group = _step11.value;\n            setReactionActivities(group.activities);\n          }\n        } catch (err) {\n          _didIteratorError11 = true;\n          _iteratorError11 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion11 && _iterator11[\"return\"] != null) {\n              _iterator11[\"return\"]();\n            }\n          } finally {\n            if (_didIteratorError11) {\n              throw _iteratorError11;\n            }\n          }\n        }\n      }\n\n      return map;\n    });\n\n    _defineProperty(this, \"refresh\",\n    /*#__PURE__*/\n    function () {\n      var _ref11 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee9(extraOptions) {\n        var options, response, newState;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                options = _this.getOptions(extraOptions);\n                _context9.next = 3;\n                return _this.setState({\n                  refreshing: true\n                });\n\n              case 3:\n                _context9.prev = 3;\n                _context9.next = 6;\n                return _this.doFeedRequest(options);\n\n              case 6:\n                response = _context9.sent;\n                _context9.next = 14;\n                break;\n\n              case 9:\n                _context9.prev = 9;\n                _context9.t0 = _context9[\"catch\"](3);\n\n                _this.setState({\n                  refreshing: false\n                });\n\n                _this.props.errorHandler(_context9.t0, 'get-feed', {\n                  feedGroup: _this.props.feedGroup,\n                  userId: _this.props.userId\n                });\n\n                return _context9.abrupt(\"return\");\n\n              case 14:\n                newState = _objectSpread({\n                  activityOrder: response.results.map(function (a) {\n                    return a.id;\n                  }),\n                  activities: _this.responseToActivityMap(response),\n                  activityIdToPath: _this.responseToActivityIdToPath(response),\n                  activityIdToPaths: _this.responseToActivityIdToPaths(response),\n                  reactionIdToPaths: _this.feedResponseToReactionIdToPaths(response),\n                  reactionActivities: _this.responseToReactionActivities(response),\n                  refreshing: false,\n                  lastResponse: response,\n                  realtimeAdds: [],\n                  realtimeDeletes: []\n                }, _this.unseenUnreadFromResponse(response));\n\n                if (options.mark_seen === true) {\n                  newState.unseen = 0;\n                }\n\n                if (options.mark_read === true) {\n                  newState.unread = 0;\n                }\n\n                return _context9.abrupt(\"return\", _this.setState(newState));\n\n              case 18:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, null, [[3, 9]]);\n      }));\n\n      return function (_x22) {\n        return _ref11.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"subscribe\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee10() {\n      var feed;\n      return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              if (!_this.props.notify) {\n                _context10.next = 4;\n                break;\n              }\n\n              feed = _this.feed();\n              _context10.next = 4;\n              return _this.setState(function (prevState) {\n                if (prevState.subscription) {\n                  return {};\n                }\n\n                var subscription = feed.subscribe(function (data) {\n                  _this.setState(function (prevState) {\n                    var numActivityDiff = data[\"new\"].length - data.deleted.length;\n                    return {\n                      realtimeAdds: prevState.realtimeAdds.concat(data[\"new\"]),\n                      realtimeDeletes: prevState.realtimeDeletes.concat(data.deleted),\n                      unread: prevState.unread + numActivityDiff,\n                      unseen: prevState.unseen + numActivityDiff\n                    };\n                  });\n                });\n                subscription.then(function () {\n                  console.log(\"now listening to changes in realtime for \".concat(_this.feed().id));\n                }, function (err) {\n                  console.error(err);\n                });\n                return {\n                  subscription: subscription\n                };\n              });\n\n            case 4:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10);\n    })));\n\n    _defineProperty(this, \"unsubscribe\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee11() {\n      var subscription;\n      return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              subscription = _this.state.subscription;\n\n              if (subscription) {\n                _context11.next = 3;\n                break;\n              }\n\n              return _context11.abrupt(\"return\");\n\n            case 3:\n              _context11.next = 5;\n              return subscription;\n\n            case 5:\n              if (!(_this.registeredCallbacks.length === 0)) {\n                _context11.next = 15;\n                break;\n              }\n\n              _context11.prev = 6;\n              _context11.next = 9;\n              return subscription.cancel();\n\n            case 9:\n              console.log(\"stopped listening to changes in realtime for \".concat(_this.feed().id));\n              _context11.next = 15;\n              break;\n\n            case 12:\n              _context11.prev = 12;\n              _context11.t0 = _context11[\"catch\"](6);\n              console.error(_context11.t0);\n\n            case 15:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11, null, [[6, 12]]);\n    })));\n\n    _defineProperty(this, \"hasNextPage\", function () {\n      var lastResponse = _this.state.lastResponse;\n      return Boolean(lastResponse && lastResponse.next);\n    });\n\n    _defineProperty(this, \"hasReverseNextPage\", function () {\n      var lastReverseResponse = _this.state.lastReverseResponse;\n      return Boolean(lastReverseResponse && lastReverseResponse.next);\n    });\n\n    _defineProperty(this, \"loadNextPage\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee12() {\n      var lastResponse, cancel, nextURL, options, response;\n      return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              lastResponse = _this.state.lastResponse;\n\n              if (!(!lastResponse || !lastResponse.next)) {\n                _context12.next = 3;\n                break;\n              }\n\n              return _context12.abrupt(\"return\");\n\n            case 3:\n              cancel = false;\n              _context12.next = 6;\n              return _this.setState(function (prevState) {\n                if (prevState.refreshing) {\n                  cancel = true;\n                  return {};\n                }\n\n                return {\n                  refreshing: true\n                };\n              });\n\n            case 6:\n              if (!cancel) {\n                _context12.next = 8;\n                break;\n              }\n\n              return _context12.abrupt(\"return\");\n\n            case 8:\n              nextURL = new URL(lastResponse.next, true);\n              options = _this.getOptions(nextURL.query);\n              _context12.prev = 10;\n              _context12.next = 13;\n              return _this.doFeedRequest(options);\n\n            case 13:\n              response = _context12.sent;\n              _context12.next = 21;\n              break;\n\n            case 16:\n              _context12.prev = 16;\n              _context12.t0 = _context12[\"catch\"](10);\n\n              _this.setState({\n                refreshing: false\n              });\n\n              _this.props.errorHandler(_context12.t0, 'get-feed-next-page', {\n                feedGroup: _this.props.feedGroup,\n                userId: _this.props.userId\n              });\n\n              return _context12.abrupt(\"return\");\n\n            case 21:\n              return _context12.abrupt(\"return\", _this.setState(function (prevState) {\n                var activities = prevState.activities.merge(_this.responseToActivityMap(response));\n\n                var activityIdToPath = _objectSpread({}, prevState.activityIdToPath, _this.responseToActivityIdToPath(response));\n\n                return {\n                  activityOrder: prevState.activityOrder.concat(response.results.map(function (a) {\n                    return a.id;\n                  })),\n                  activities: activities,\n                  activityIdToPath: activityIdToPath,\n                  activityIdToPaths: _this.responseToActivityIdToPaths(response, prevState.activityIdToPaths),\n                  reactionIdToPaths: _this.feedResponseToReactionIdToPaths(response, prevState.reactionIdToPaths),\n                  reactionActivities: _objectSpread({}, prevState.reactionActivities, _this.responseToReactionActivities(response)),\n                  refreshing: false,\n                  lastResponse: response\n                };\n              }));\n\n            case 22:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12, null, [[10, 16]]);\n    })));\n\n    _defineProperty(this, \"loadReverseNextPage\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee13() {\n      var lastReverseResponse, cancel, nextURL, options, response;\n      return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              lastReverseResponse = _this.state.lastReverseResponse;\n\n              if (!(!lastReverseResponse || !lastReverseResponse.next)) {\n                _context13.next = 3;\n                break;\n              }\n\n              return _context13.abrupt(\"return\");\n\n            case 3:\n              cancel = false;\n              _context13.next = 6;\n              return _this.setState(function (prevState) {\n                if (prevState.refreshing) {\n                  cancel = true;\n                  return {};\n                }\n\n                return {\n                  refreshing: true\n                };\n              });\n\n            case 6:\n              if (!cancel) {\n                _context13.next = 8;\n                break;\n              }\n\n              return _context13.abrupt(\"return\");\n\n            case 8:\n              nextURL = new URL(lastReverseResponse.next, true);\n              options = _this.getOptions(nextURL.query);\n              _context13.prev = 10;\n              _context13.next = 13;\n              return _this.doFeedRequest(options);\n\n            case 13:\n              response = _context13.sent;\n              _context13.next = 21;\n              break;\n\n            case 16:\n              _context13.prev = 16;\n              _context13.t0 = _context13[\"catch\"](10);\n\n              _this.setState({\n                refreshing: false\n              });\n\n              _this.props.errorHandler(_context13.t0, 'get-feed-next-page', {\n                feedGroup: _this.props.feedGroup,\n                userId: _this.props.userId\n              });\n\n              return _context13.abrupt(\"return\");\n\n            case 21:\n              return _context13.abrupt(\"return\", _this.setState(function (prevState) {\n                var activities = prevState.activities.merge(_this.responseToActivityMap(response));\n\n                var activityIdToPath = _objectSpread({}, prevState.activityIdToPath, _this.responseToActivityIdToPath(response));\n\n                return {\n                  activityOrder: response.results.map(function (a) {\n                    return a.id;\n                  }).concat(prevState.activityOrder),\n                  activities: activities,\n                  activityIdToPath: activityIdToPath,\n                  activityIdToPaths: _this.responseToActivityIdToPaths(response, prevState.activityIdToPaths),\n                  reactionIdToPaths: _this.feedResponseToReactionIdToPaths(response, prevState.reactionIdToPaths),\n                  reactionActivities: _objectSpread({}, prevState.reactionActivities, _this.responseToReactionActivities(response)),\n                  refreshing: false,\n                  lastReverseResponse: response\n                };\n              }));\n\n            case 22:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13, null, [[10, 16]]);\n    })));\n\n    _defineProperty(this, \"loadNextReactions\",\n    /*#__PURE__*/\n    function () {\n      var _ref16 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee14(activityId, kind, activityPath, oldestToNewest) {\n        var options, orderPrefix, latestReactionsPath, nextUrlPath, refreshingPath, reactions_extra, nextUrl, refreshing, response;\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                options = {\n                  activity_id: activityId,\n                  kind: kind\n                };\n                orderPrefix = 'latest';\n\n                if (oldestToNewest) {\n                  orderPrefix = 'oldest';\n                }\n\n                if (!activityPath) {\n                  activityPath = _this.getActivityPath(activityId);\n                }\n\n                latestReactionsPath = [].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions', kind]);\n                nextUrlPath = [].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions_extra', kind, 'next']);\n                refreshingPath = [].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions_extra', kind, 'refreshing']);\n                reactions_extra = _this.state.activities.getIn([].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions_extra']));\n                nextUrl = 'https://api.stream-io-api.com/';\n\n                if (reactions_extra) {\n                  nextUrl = reactions_extra.getIn([kind, 'next'], '');\n                } else if (oldestToNewest) {\n                  // If it's the first request and oldest to newest make sure\n                  // order is reversed by this trick with a non existant id.\n                  options.id_gt = 'non-existant-' + generateRandomId();\n                }\n\n                refreshing = _this.state.activities.getIn(refreshingPath, false);\n\n                if (!(!nextUrl || refreshing)) {\n                  _context14.next = 13;\n                  break;\n                }\n\n                return _context14.abrupt(\"return\");\n\n              case 13:\n                _this.setState(function (prevState) {\n                  return {\n                    activities: prevState.activities.setIn(refreshingPath, true)\n                  };\n                });\n\n                options = _objectSpread({}, URL(nextUrl, true).query, options);\n                _context14.prev = 15;\n\n                if (!_this.props.doReactionsFilterRequest) {\n                  _context14.next = 22;\n                  break;\n                }\n\n                _context14.next = 19;\n                return _this.props.doReactionsFilterRequest(options);\n\n              case 19:\n                response = _context14.sent;\n                _context14.next = 25;\n                break;\n\n              case 22:\n                _context14.next = 24;\n                return _this.props.client.reactions.filter(options);\n\n              case 24:\n                response = _context14.sent;\n\n              case 25:\n                _context14.next = 32;\n                break;\n\n              case 27:\n                _context14.prev = 27;\n                _context14.t0 = _context14[\"catch\"](15);\n\n                _this.setState({\n                  refreshing: false\n                });\n\n                _this.props.errorHandler(_context14.t0, 'get-reactions-next-page', {\n                  options: options\n                });\n\n                return _context14.abrupt(\"return\");\n\n              case 32:\n                _this.setState(function (prevState) {\n                  return {\n                    activities: prevState.activities.setIn(refreshingPath, false).setIn(nextUrlPath, response.next).updateIn(latestReactionsPath, function () {\n                      var v = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : immutable.List();\n                      return v.concat(immutable.fromJS(response.results));\n                    }),\n                    reactionIdToPaths: _this.reactionResponseToReactionIdToPaths(response, prevState.reactionIdToPaths, latestReactionsPath, prevState.activities.getIn(latestReactionsPath, immutable.List()).toJS().length)\n                  };\n                });\n\n              case 33:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, null, [[15, 27]]);\n      }));\n\n      return function (_x23, _x24, _x25, _x26) {\n        return _ref16.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(this, \"refreshUnreadUnseen\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee15() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              _context15.prev = 0;\n              _context15.next = 3;\n              return _this.doFeedRequest({\n                limit: 0\n              });\n\n            case 3:\n              response = _context15.sent;\n              _context15.next = 10;\n              break;\n\n            case 6:\n              _context15.prev = 6;\n              _context15.t0 = _context15[\"catch\"](0);\n\n              _this.props.errorHandler(_context15.t0, 'get-notification-counts', {\n                feedGroup: _this.props.feedGroup,\n                userId: _this.props.userId\n              });\n\n              return _context15.abrupt(\"return\");\n\n            case 10:\n              return _context15.abrupt(\"return\", _this.setState(_this.unseenUnreadFromResponse(response)));\n\n            case 11:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15, null, [[0, 6]]);\n    })));\n\n    this.props = props;\n    var initialOptions = this.getOptions();\n    this.registeredCallbacks = [];\n    var previousUrl = '';\n\n    if (initialOptions.id_gte) {\n      previousUrl = \"?id_lt=\".concat(initialOptions.id_gte);\n    } else if (initialOptions.id_gt) {\n      previousUrl = \"?id_lte=\".concat(initialOptions.id_gt);\n    } else if (initialOptions.id_lte) {\n      previousUrl = \"?id_gt=\".concat(initialOptions.id_lte);\n    } else if (initialOptions.id_lt) {\n      previousUrl = \"?id_gte=\".concat(initialOptions.id_lt);\n    }\n\n    this.state.lastReverseResponse = {\n      next: previousUrl\n    };\n  }\n\n  _createClass(FeedManager, [{\n    key: \"register\",\n    value: function register(callback) {\n      this.registeredCallbacks.push(callback);\n      this.subscribe();\n    }\n  }, {\n    key: \"unregister\",\n    value: function unregister(callback) {\n      this.registeredCallbacks.splice(this.registeredCallbacks.indexOf(callback));\n      this.unsubscribe();\n    }\n  }, {\n    key: \"triggerUpdate\",\n    value: function triggerUpdate() {\n      var _iteratorNormalCompletion12 = true;\n      var _didIteratorError12 = false;\n      var _iteratorError12 = undefined;\n\n      try {\n        for (var _iterator12 = this.registeredCallbacks[Symbol.iterator](), _step12; !(_iteratorNormalCompletion12 = (_step12 = _iterator12.next()).done); _iteratorNormalCompletion12 = true) {\n          var callback = _step12.value;\n          callback();\n        }\n      } catch (err) {\n        _didIteratorError12 = true;\n        _iteratorError12 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion12 && _iterator12[\"return\"] != null) {\n            _iterator12[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError12) {\n            throw _iteratorError12;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"unseenUnreadFromResponse\",\n    value: function unseenUnreadFromResponse(response) {\n      var unseen = 0;\n      var unread = 0;\n\n      if (typeof response.unseen === 'number') {\n        unseen = response.unseen;\n      }\n\n      if (typeof response.unread === 'number') {\n        unread = response.unread;\n      }\n\n      return {\n        unseen: unseen,\n        unread: unread\n      };\n    }\n  }]);\n\n  return FeedManager;\n}();\n\nvar handleError = function handleError(error, type, detail) {\n  console.warn(error);\n  alert(getErrorMessage(error, type, detail));\n};\n\nvar getErrorMessage = function getErrorMessage(error, type, detail) {\n  console.warn(error);\n\n  if (!(error instanceof stream.errors.StreamApiError)) {\n    return fallbackErrorMessage(error, type, detail);\n  }\n\n  var response = error.response;\n\n  if (!response.statusCode || !response.body || !response.body.detail) {\n    return fallbackErrorMessage(error, type, detail);\n  }\n\n  var statusCode = response.statusCode;\n  var text = response.body.detail;\n  /* eslint-disable no-magic-numbers */\n\n  if (statusCode >= 400 && statusCode < 500) {\n    return text;\n  } else if (statusCode >= 500 && statusCode < 600) {\n    return text;\n  }\n  /* eslint-enable no-magic-numbers */\n\n\n  return fallbackErrorMessage(error, type, detail);\n};\n\nvar fallbackErrorMessage = function fallbackErrorMessage(error, type, detail) {\n  var text = 'Something went wrong';\n  var suffix = '';\n\n  switch (type) {\n    case 'get-user-info':\n      text += ' when loading user info';\n      break;\n\n    case 'get-feed':\n      text += ' when loading the feed';\n      break;\n\n    case 'get-feed-next-page':\n      text += ' when loading the next page of the feed';\n      break;\n\n    case 'get-notification-counts':\n      text += ' when loading your unread notification counts';\n      break;\n\n    case 'upload-image':\n      text += ' when uploading your image';\n      suffix = ' If it is, the image is probably too big';\n      break;\n\n    case 'add-activity':\n      text += ' when submitting your post';\n      break;\n\n    case 'add-child-reaction':\n      text += ' when submitting your ' + detail.kind;\n      break;\n\n    case 'delete-child-reaction':\n      text += ' when removing your ' + detail.kind;\n      break;\n\n    default:\n  }\n\n  text += '. Is your internet working?' + suffix;\n  return text;\n};\n\nvar StreamContext = createContext({\n  changedUserData: function changedUserData() {},\n  sharedFeedManagers: {}\n});\n/**\n * Manages the connection with Stream. Any components that should talk to\n * Stream should be a child of this component.\n */\n\nvar StreamApp =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(StreamApp, _React$Component);\n\n  function StreamApp(props) {\n    var _this;\n\n    _classCallCheck(this, StreamApp);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(StreamApp).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"getUserInfo\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _this.state.user.getOrCreate(_this.props.defaultUserData);\n\n            case 3:\n              _context.next = 9;\n              break;\n\n            case 5:\n              _context.prev = 5;\n              _context.t0 = _context[\"catch\"](0);\n\n              _this.props.errorHandler(_context.t0, 'get-user-info', {\n                userId: _this.state.user.id\n              });\n\n              return _context.abrupt(\"return\");\n\n            case 9:\n              _this.state.changedUserData();\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 5]]);\n    })));\n\n    _this.state = StreamApp.initClientState(props, {\n      changedUserData: function changedUserData() {\n        _this.setState({\n          userData: _this.state.user.data\n        });\n      }\n    });\n    return _this;\n  }\n\n  _createClass(StreamApp, [{\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.apiKey !== prevProps.apiKey || this.props.token !== prevProps.token || this.props.appId !== prevProps.appId) {\n        this.getUserInfo();\n      }\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getUserInfo();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return createElement(StreamContext.Provider, {\n        value: _objectSpread({}, this.state)\n      }, createElement(Fragment, null, this.props.children || createElement(Fragment, null, createElement(\"div\", {\n        style: {\n          width: 100 + '%',\n          height: 100 + '%',\n          minHeight: 400,\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          color: '#fff',\n          backgroundColor: '#008AFF',\n          fontFamily: '-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol'\n        }\n      }, createElement(\"h3\", null, \"You are connected to:\"), createElement(\"svg\", {\n        width: \"117\",\n        height: \"21\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, createElement(\"g\", {\n        fill: \"none\",\n        fillRule: \"evenodd\"\n      }, createElement(\"path\", {\n        className: \"stream\",\n        d: \"M48.812 16.9c.168-.15.317-.317.448-.504.13-.187.196-.401.196-.644 0-.299-.107-.55-.322-.756a2.794 2.794 0 0 0-.784-.518 4.892 4.892 0 0 0-.966-.322c-.336-.075-.616-.14-.84-.196a13.04 13.04 0 0 1-1.736-.546 5.849 5.849 0 0 1-1.414-.784 3.53 3.53 0 0 1-.952-1.092c-.233-.42-.35-.92-.35-1.498 0-.541.13-1.05.392-1.526a4.35 4.35 0 0 1 1.05-1.26 5.156 5.156 0 0 1 1.54-.868 5.387 5.387 0 0 1 1.862-.322c.579 0 1.13.084 1.652.252.523.168.994.397 1.414.686.42.29.775.64 1.064 1.05.29.41.48.868.574 1.372l-2.436.588a2.036 2.036 0 0 0-.728-1.12c-.373-.299-.887-.448-1.54-.448a2.69 2.69 0 0 0-.7.098 2.41 2.41 0 0 0-.672.294c-.205.13-.378.29-.518.476-.14.187-.21.401-.21.644 0 .261.08.485.238.672.159.187.35.34.574.462.224.121.467.22.728.294.261.075.504.14.728.196.99.243 1.81.504 2.464.784.653.28 1.176.588 1.568.924.392.336.667.705.826 1.106.159.401.238.854.238 1.358a3.6 3.6 0 0 1-.406 1.68 4.22 4.22 0 0 1-1.12 1.358 5.304 5.304 0 0 1-1.708.896 6.912 6.912 0 0 1-2.142.322c-1.157 0-2.189-.285-3.094-.854-.905-.57-1.517-1.33-1.834-2.282l2.296-1.036c.299.653.681 1.097 1.148 1.33.467.233.999.35 1.596.35.747 0 1.372-.205 1.876-.616zm12.276 2.772a9.115 9.115 0 0 1-2.268.476c-.747.056-1.419-.051-2.016-.322-.597-.27-1.083-.747-1.456-1.428-.373-.681-.56-1.638-.56-2.87V9.313h-2.226V6.356h.609c.727 0 1.376-.177 1.834-.916.194-.313.22-.633.243-1.502V2.913h2.332v3.443h2.749v2.957h-2.75l-.075 6.635c0 .448.051.803.154 1.064.103.261.275.457.518.588.243.13.56.196.952.196.392 0 .868-.037 1.428-.112l.532 1.988zM69.676 8.78l-.392-.168a5.38 5.38 0 0 0-.392-.112 1.957 1.957 0 0 0-.476-.056c-.541 0-1.045.089-1.512.266a3.849 3.849 0 0 0-1.204.714 3.372 3.372 0 0 0-.798 1.05 2.866 2.866 0 0 0-.294 1.274L64.58 20h-2.716V6.288h2.156l.56 1.484a4.134 4.134 0 0 1 1.47-1.302c.607-.327 1.367-.49 2.282-.49.597 0 1.279.084 2.044.252l-.7 2.548zm7.048 11.256c-.97 0-1.88-.182-2.73-.546a7.032 7.032 0 0 1-2.226-1.498 6.99 6.99 0 0 1-1.498-2.24 6.957 6.957 0 0 1-.546-2.744c0-.97.173-1.885.518-2.744a7.226 7.226 0 0 1 1.4-2.24A6.526 6.526 0 0 1 73.7 6.526a5.91 5.91 0 0 1 2.52-.546c.915 0 1.76.159 2.534.476A5.203 5.203 0 0 1 80.77 7.94c.57.672 1.013 1.526 1.33 2.562.317 1.036.476 2.273.476 3.71h-9.968c.13.485.336.938.616 1.358.28.42.611.784.994 1.092.383.308.812.546 1.288.714.476.168.975.252 1.498.252.71 0 1.367-.13 1.974-.392a4.925 4.925 0 0 0 1.554-1.036l1.68 1.68c-.653.653-1.451 1.176-2.394 1.568-.943.392-1.974.588-3.094.588zM76.22 8.444c-.43 0-.835.084-1.218.252a3.89 3.89 0 0 0-1.064.7 4.32 4.32 0 0 0-.84 1.064c-.233.41-.406.859-.518 1.344h7.084a4.331 4.331 0 0 0-.308-1.288 3.311 3.311 0 0 0-1.75-1.806c-.401-.177-.863-.266-1.386-.266zm20.9-2.156V20h-2.296l-.42-1.84a4.424 4.424 0 0 1-1.792 1.4 5.49 5.49 0 0 1-2.212.476 6.326 6.326 0 0 1-2.618-.546 6.712 6.712 0 0 1-2.128-1.498 7.162 7.162 0 0 1-1.442-2.24 7.116 7.116 0 0 1-.532-2.744c0-.97.177-1.885.532-2.744a7.162 7.162 0 0 1 1.442-2.24 6.712 6.712 0 0 1 2.128-1.498A6.326 6.326 0 0 1 90.4 5.98c.747 0 1.465.145 2.156.434.69.29 1.307.742 1.848 1.358l.42-1.484h2.296zm-6.72 11.34c.541 0 1.055-.121 1.54-.364a3.94 3.94 0 0 0 1.26-.994c.355-.42.635-.91.84-1.47.205-.56.308-1.157.308-1.792s-.103-1.232-.308-1.792a4.834 4.834 0 0 0-.84-1.47 3.94 3.94 0 0 0-1.26-.994 3.398 3.398 0 0 0-1.54-.364c-.541 0-1.055.121-1.54.364a3.94 3.94 0 0 0-1.26.994c-.355.42-.635.91-.84 1.47a5.164 5.164 0 0 0-.308 1.792c0 .635.103 1.232.308 1.792.205.56.485 1.05.84 1.47.355.42.775.751 1.26.994s.999.364 1.54.364zM101.808 20h-2.716V6.288h2.156l.56 1.148a5.135 5.135 0 0 1 1.204-1.022c.467-.29 1.036-.434 1.708-.434.261 0 .555.033.882.098.327.065.663.177 1.008.336a4.3 4.3 0 0 1 .994.644c.317.27.588.62.812 1.05.317-.579.798-1.078 1.442-1.498.644-.42 1.33-.63 2.058-.63.485 0 .999.075 1.54.224.541.15 1.045.43 1.512.84.467.41.85.98 1.148 1.708.299.728.448 1.67.448 2.828V20h-2.548v-8.448c0-1.157-.238-1.965-.714-2.422-.476-.457-1.106-.686-1.89-.686-.597 0-1.12.252-1.568.756-.448.504-.672 1.297-.672 2.38V20h-2.548v-8.448c0-1.157-.238-1.965-.714-2.422-.476-.457-1.106-.686-1.89-.686-.56 0-1.05.215-1.47.644-.42.43-.667 1.101-.742 2.016V20z\",\n        fill: \"#fff\"\n      }), createElement(\"path\", {\n        className: \"stream-mark\",\n        d: \"M26.15 6.428l12.802-.908a1 1 0 0 1 .883 1.581L30.88 19.576a1 1 0 0 1-.812.417H9.982a1 1 0 0 1-.811-.416L.19 7.102a1 1 0 0 1 .882-1.582l12.764.908L19.29.333a1 1 0 0 1 1.496.006l5.364 6.09zm2.68 11.587l-8.309-3.105v3.105h8.31zm-9.309 0V14.91l-8.309 3.105h8.31zm-.959-3.847l-8.489 3.17-6.246-8.682 14.735 5.512zm2.9 0l8.49 3.17 6.246-8.682-14.735 5.512zm-1.933-.724V2.994l-6.941 7.837 6.941 2.613zm.992 0V2.996l6.942 7.835-6.942 2.613zm-9.969-3.336l1.597-1.794-7.802-.56 6.205 2.354zm18.863 0l-1.597-1.794 7.803-.56-6.206 2.354z\",\n        fill: \"#fff\"\n      })))))));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      if (state.client.apiKey !== props.apiKey || state.client.userToken !== props.token || state.client.appId !== props.appId) {\n        return StreamApp.initClientState(props, state);\n      }\n\n      return null;\n    }\n  }]);\n\n  return StreamApp;\n}(Component);\n\n_defineProperty(StreamApp, \"defaultProps\", {\n  sharedFeeds: [{\n    feedGroup: 'notification',\n    notify: true,\n    options: {\n      mark_seen: true\n    }\n  }],\n  defaultUserData: {\n    name: 'Unknown'\n  },\n  errorHandler: handleError\n});\n\n_defineProperty(StreamApp, \"Consumer\", function StreamAppConsumer(props) {\n  return createElement(StreamContext.Consumer, null, function (appCtx) {\n    if (!props.children || !props.children.length) {\n      return null;\n    }\n\n    if (!appCtx.client || !appCtx.user) {\n      throw new Error('This component should be a child of a StreamApp component');\n    }\n\n    var Child = props.children;\n    return Child(appCtx);\n  });\n});\n\n_defineProperty(StreamApp, \"initClientState\", function (props, state) {\n  var client = stream.connect(props.apiKey, props.token, props.appId, props.options || {});\n  var analyticsClient;\n\n  if (props.analyticsToken) {\n    analyticsClient = new StreamAnalytics({\n      apiKey: props.apiKey,\n      token: props.analyticsToken\n    });\n    analyticsClient.setUser(client.userId);\n  }\n\n  var newState = _objectSpread({}, state, {\n    client: client,\n    user: client.currentUser,\n    userData: client.currentUser.data,\n    analyticsClient: analyticsClient,\n    sharedFeedManagers: {},\n    errorHandler: props.errorHandler,\n    apiKey: props.apiKey,\n    token: props.token,\n    appId: props.appId\n  });\n\n  var _iteratorNormalCompletion = true;\n  var _didIteratorError = false;\n  var _iteratorError = undefined;\n\n  try {\n    for (var _iterator = props.sharedFeeds[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n      var feedProps = _step.value;\n      var manager = new FeedManager(_objectSpread({}, feedProps, newState));\n      newState.sharedFeedManagers[manager.feed().id] = manager;\n    }\n  } catch (err) {\n    _didIteratorError = true;\n    _iteratorError = err;\n  } finally {\n    try {\n      if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n        _iterator[\"return\"]();\n      }\n    } finally {\n      if (_didIteratorError) {\n        throw _iteratorError;\n      }\n    }\n  }\n\n  return newState;\n});\n\nvar FeedContext = createContext({});\n\nvar Feed =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Feed, _React$Component);\n\n  function Feed() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Feed);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Feed)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"_appCtxWrapperFunc\", function (appCtx) {\n      return createElement(FeedInner, _extends({}, _this.props, appCtx));\n    });\n\n    return _this;\n  }\n\n  _createClass(Feed, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(StreamApp.Consumer, null, this._appCtxWrapperFunc);\n    }\n  }]);\n\n  return Feed;\n}(Component);\n\nvar FeedInner =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(FeedInner, _React$Component2);\n\n  function FeedInner(props) {\n    var _this2;\n\n    _classCallCheck(this, FeedInner);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(FeedInner).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this2), \"boundForceUpdate\", function () {\n      return _this2.forceUpdate();\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"getCtx\", function () {\n      var manager = _this2.state.manager;\n      var state = manager.state;\n      return {\n        getActivityPath: manager.getActivityPath,\n        onToggleReaction: manager.onToggleReaction,\n        onAddReaction: manager.onAddReaction,\n        onRemoveReaction: manager.onRemoveReaction,\n        onToggleChildReaction: manager.onToggleChildReaction,\n        onAddChildReaction: manager.onAddChildReaction,\n        onRemoveChildReaction: manager.onRemoveChildReaction,\n        onRemoveActivity: manager.onRemoveActivity,\n        onMarkAsRead: manager.onMarkAsRead,\n        onMarkAsSeen: manager.onMarkAsSeen,\n        hasDoneRequest: state.lastResponse != null,\n        refresh: manager.refresh,\n        refreshUnreadUnseen: manager.refreshUnreadUnseen,\n        loadNextReactions: manager.loadNextReactions,\n        loadNextPage: manager.loadNextPage,\n        hasNextPage: manager.hasNextPage(),\n        loadReverseNextPage: manager.loadReverseNextPage,\n        hasReverseNextPage: manager.hasReverseNextPage(),\n        feedGroup: _this2.props.feedGroup,\n        userId: _this2.props.userId,\n        activityOrder: state.activityOrder,\n        activities: state.activities,\n        realtimeAdds: state.realtimeAdds,\n        realtimeDeletes: state.realtimeDeletes,\n        refreshing: state.refreshing,\n        unread: state.unread,\n        unseen: state.unseen\n      };\n    });\n\n    var feedId = props.client.feed(props.feedGroup, props.userId).id;\n    var _manager = props.sharedFeedManagers[feedId];\n\n    if (!_manager) {\n      _manager = new FeedManager(props);\n    }\n\n    _this2.state = {\n      manager: _manager\n    };\n    return _this2;\n  }\n\n  _createClass(FeedInner, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      return this.state.manager.register(this.boundForceUpdate);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var clientDifferent = this.props.client !== prevProps.client;\n      var notifyDifferent = this.props.notify !== prevProps.notify;\n      var feedDifferent = this.props.userId !== prevProps.userId || this.props.feedGroup !== prevProps.feedGroup;\n      var optionsDifferent = !_isEqual(this.props.options, prevProps.options);\n      var doFeedRequestDifferent = this.props.doFeedRequest !== prevProps.doFeedRequest;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      return this.state.manager.unregister(this.boundForceUpdate);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return createElement(FeedContext.Provider, {\n        value: this.getCtx()\n      }, this.props.children);\n    }\n  }]);\n\n  return FeedInner;\n}(Component);\n\nvar placeholder = \"1519fc1dc6e473ee.png\";\n/**\n *\n * @example ./examples/Avatar.md\n */\n\nvar Avatar =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(Avatar, _React$PureComponent);\n\n  function Avatar() {\n    _classCallCheck(this, Avatar);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Avatar).apply(this, arguments));\n  }\n\n  _createClass(Avatar, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          size = _this$props.size,\n          image = _this$props.image,\n          alt = _this$props.alt,\n          rounded = _this$props.rounded,\n          circle = _this$props.circle;\n      return React__default.createElement(React__default.Fragment, null, React__default.createElement(\"img\", {\n        style: size ? {\n          width: \"\".concat(size, \"px\"),\n          height: \"\".concat(size, \"px\")\n        } : {},\n        className: \"raf-avatar \".concat(rounded ? 'raf-avatar--rounded' : '', \" \").concat(circle ? 'raf-avatar--circle' : ''),\n        onClick: this.props.onClick,\n        src: image ? image : placeholder,\n        alt: alt || ''\n      }));\n    }\n  }]);\n\n  return Avatar;\n}(React__default.PureComponent);\n/**\n * Component is described here.\n *\n * @example ./examples/UserBar.md\n */\n\n\nvar UserBar =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(UserBar, _React$Component);\n\n  function UserBar() {\n    _classCallCheck(this, UserBar);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(UserBar).apply(this, arguments));\n  }\n\n  _createClass(UserBar, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      var time = this.props.time;\n\n      if (time === undefined && this.props.timestamp != null) {\n        time = humanizeTimestamp(this.props.timestamp);\n      }\n\n      return createElement(\"div\", {\n        className: \"raf-user-bar\"\n      }, this.props.avatar ? createElement(Avatar, {\n        onClick: this.props.onClickUser,\n        size: 50,\n        circle: true,\n        image: this.props.avatar\n      }) : null, createElement(\"div\", {\n        className: \"raf-user-bar__details\"\n      }, createElement(\"p\", {\n        className: \"raf-user-bar__username\",\n        onClick: this.props.onClickUser\n      }, this.props.username), this.props.AfterUsername, this.props.icon !== undefined ? createElement(\"img\", {\n        src: this.props.icon,\n        alt: \"icon\"\n      }) : null, this.props.subtitle ? createElement(\"p\", {\n        className: \"raf-user-bar__subtitle\"\n      }, createElement(\"time\", {\n        dateTime: this.props.timestamp,\n        title: this.props.timestamp\n      }, this.props.subtitle)) : null), createElement(Fragment, null, smartRender(this.props.Right, {}, function () {\n        return createElement(\"p\", {\n          className: \"raf-user-bar__extra\"\n        }, createElement(\"time\", {\n          dateTime: _this.props.timestamp,\n          title: _this.props.timestamp\n        }, time));\n      })));\n    }\n  }]);\n\n  return UserBar;\n}(Component);\n/**\n * Component is described here.\n *\n * @example ./examples/Card.md\n */\n\n\nvar Card =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Card, _React$Component);\n\n  function Card() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Card);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Card)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"trimUrl\", function (url) {\n      var trimmedUrl;\n\n      if (url !== undefined || url !== null) {\n        trimmedUrl = url.replace(/^(?:https?:\\/\\/)?(?:www\\.)?/i, '').split('/')[0];\n      }\n\n      return trimmedUrl;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_handleClose\", function (e) {\n      if (_this.props.handleClose) {\n        _this.props.handleClose(e);\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Card, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          alt = _this$props.alt,\n          images = _this$props.images,\n          handleClose = _this$props.handleClose,\n          nolink = _this$props.nolink;\n      var image = this.props.image;\n\n      if (!image && images && images.length) {\n        image = images[0].image;\n      }\n\n      var url = sanitizeURL(this.props.url);\n      var svg = '<svg width=\"28\" height=\"28\" viewBox=\"0 0 28 28\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><defs><path d=\"M465 5c5.53 0 10 4.47 10 10s-4.47 10-10 10-10-4.47-10-10 4.47-10 10-10zm3.59 5L465 13.59 461.41 10 460 11.41l3.59 3.59-3.59 3.59 1.41 1.41 3.59-3.59 3.59 3.59 1.41-1.41-3.59-3.59 3.59-3.59-1.41-1.41z\" id=\"b\"/><filter x=\"-30%\" y=\"-30%\" width=\"160%\" height=\"160%\" filterUnits=\"objectBoundingBox\" id=\"a\"><feOffset in=\"SourceAlpha\" result=\"shadowOffsetOuter1\"/><feGaussianBlur stdDeviation=\"2\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"/><feColorMatrix values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0\" in=\"shadowBlurOuter1\"/></filter></defs><g transform=\"translate(-451 -1)\" fill-rule=\"nonzero\" fill=\"none\"><use fill=\"#000\" filter=\"url(#a)\" xlink:href=\"#b\"/><use fill=\"#FFF\" fill-rule=\"evenodd\" xlink:href=\"#b\"/></g></svg>';\n      return React__default.createElement(\"a\", {\n        href: !nolink ? url : null,\n        target: \"blank\",\n        rel: \"noopener\",\n        className: \"raf-card \".concat(image !== undefined ? 'raf-card--with-image' : '')\n      }, handleClose && image ? React__default.createElement(IconButton, {\n        onClick: function onClick(e) {\n          return _this2._handleClose(e);\n        }\n      }, React__default.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: svg\n        }\n      })) : null, image !== undefined && React__default.createElement(\"div\", {\n        className: \"raf-card__image\"\n      }, React__default.createElement(\"img\", {\n        src: image == null ? placeholder : image,\n        alt: alt || this.props.title || this.props.description || ''\n      })), React__default.createElement(\"div\", {\n        className: \"raf-card__content\"\n      }, React__default.createElement(\"div\", {\n        className: \"raf-card__content-left\"\n      }, React__default.createElement(\"p\", {\n        className: \"raf-card__title\"\n      }, this.props.title), React__default.createElement(\"p\", {\n        className: \"raf-card__url\"\n      }, this.trimUrl(url || '')), React__default.createElement(\"p\", {\n        className: \"raf-card__description\"\n      }, this.props.description)), handleClose && image === undefined ? React__default.createElement(\"div\", {\n        className: \"raf-card__content-right\"\n      }, React__default.createElement(IconButton, {\n        onClick: function onClick(e) {\n          return _this2._handleClose(e);\n        }\n      }, React__default.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: svg\n        }\n      }))) : null));\n    }\n  }]);\n\n  return Card;\n}(React__default.Component);\n\nvar Audio =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Audio, _React$Component);\n\n  function Audio(props) {\n    var _this;\n\n    _classCallCheck(this, Audio);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Audio).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"audioRef\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"playAudio\", function () {\n      if (_this.audioRef.current !== null) {\n        _this.audioRef.current.pause();\n\n        _this.updateProgress();\n\n        _this.setState({\n          playing: true,\n          updateProgress: setInterval(_this.updateProgress, 500)\n        }); //$FlowFixMe\n\n\n        _this.audioRef.current.play();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"pauseAudio\", function () {\n      if (_this.audioRef.current !== null) {\n        _this.audioRef.current.pause();\n      }\n\n      _this.setState({\n        playing: false\n      });\n\n      window.clearInterval(_this.state.updateProgress);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateProgress\", function () {\n      if (_this.audioRef.current !== null) {\n        var position = _this.audioRef.current.currentTime;\n        var duration = _this.audioRef.current.duration;\n        var progress = 100 / duration * position;\n\n        _this.setState({\n          progress: progress\n        });\n\n        if (position === duration) {\n          _this.pauseAudio();\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_handleClose\", function (e) {\n      if (_this.props.handleClose) {\n        _this.props.handleClose(e);\n      }\n    });\n\n    _this.state = {\n      open: false,\n      playing: false,\n      progress: 0,\n      updateProgress: null\n    };\n    _this.audioRef = createRef();\n    return _this;\n  }\n\n  _createClass(Audio, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.clearInterval(this.state.updateProgress);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var og = this.props.og;\n      var svg = '<svg width=\"28\" height=\"28\" viewBox=\"0 0 28 28\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><defs><path d=\"M465 5c5.53 0 10 4.47 10 10s-4.47 10-10 10-10-4.47-10-10 4.47-10 10-10zm3.59 5L465 13.59 461.41 10 460 11.41l3.59 3.59-3.59 3.59 1.41 1.41 3.59-3.59 3.59 3.59 1.41-1.41-3.59-3.59 3.59-3.59-1.41-1.41z\" id=\"b\"/><filter x=\"-30%\" y=\"-30%\" width=\"160%\" height=\"160%\" filterUnits=\"objectBoundingBox\" id=\"a\"><feOffset in=\"SourceAlpha\" result=\"shadowOffsetOuter1\"/><feGaussianBlur stdDeviation=\"2\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"/><feColorMatrix values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0\" in=\"shadowBlurOuter1\"/></filter></defs><g transform=\"translate(-451 -1)\" fill-rule=\"nonzero\" fill=\"none\"><use fill=\"#000\" filter=\"url(#a)\" xlink:href=\"#b\"/><use fill=\"#FFF\" fill-rule=\"evenodd\" xlink:href=\"#b\"/></g></svg>';\n      var audio = og.audios[0];\n      var url = sanitizeURL(audio.secure_url || audio.audio);\n      var image = ((og.images || [])[0] || {}).image;\n      return createElement(\"div\", {\n        className: \"raf-audio\"\n      }, createElement(\"div\", {\n        className: \"raf-audio__wrapper\"\n      }, createElement(\"audio\", {\n        ref: this.audioRef\n      }, createElement(\"source\", {\n        src: url,\n        type: audio.type === 'audio/vnd.facebook.bridge' ? 'audio/mp3' : 'audio/mp3'\n      })), createElement(\"div\", {\n        className: \"raf-audio__image\"\n      }, createElement(\"div\", {\n        className: \"raf-audio__image--overlay\"\n      }, !this.state.playing ? createElement(\"div\", {\n        onClick: function onClick() {\n          return _this2.playAudio();\n        },\n        className: \"raf-audio__image--button\"\n      }, createElement(FontAwesomeIcon, {\n        icon: faPlayCircle\n      })) : createElement(\"div\", {\n        onClick: function onClick() {\n          return _this2.pauseAudio();\n        },\n        className: \"raf-audio__image--button\"\n      }, createElement(FontAwesomeIcon, {\n        icon: faPauseCircle\n      }))), createElement(\"img\", {\n        src: image,\n        alt: \"\".concat(og.description)\n      })), createElement(\"div\", {\n        className: \"raf-audio__content\"\n      }, createElement(\"span\", {\n        className: \"raf-audio__content--title\"\n      }, createElement(\"strong\", null, og.title)), createElement(\"span\", {\n        className: \"raf-audio__content--subtitle\"\n      }, og.description), createElement(\"div\", {\n        className: \"raf-audio__content--progress\"\n      }, createElement(\"div\", {\n        style: {\n          width: \"\".concat(this.state.progress, \"%\")\n        }\n      }))), this.props.handleClose ? createElement(IconButton, {\n        onClick: function onClick(e) {\n          return _this2._handleClose(e);\n        }\n      }, createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: svg\n        }\n      })) : null));\n    }\n  }]);\n\n  return Audio;\n}(Component);\n/**\n * Component for rendering an Youtube or Vimeo embedded player\n * @example ./examples/Video.md\n */\n\n\nvar Video =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Video, _React$Component);\n\n  function Video() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Video);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Video)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"_handleClose\", function (e) {\n      if (_this.props.handleClose) {\n        _this.props.handleClose(e);\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Video, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props$og = this.props.og,\n          videos = _this$props$og.videos,\n          _this$props$og$images = _this$props$og.images,\n          images = _this$props$og$images === void 0 ? [] : _this$props$og$images;\n      var video = {};\n      var svg = '<svg width=\"28\" height=\"28\" viewBox=\"0 0 28 28\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><defs><path d=\"M465 5c5.53 0 10 4.47 10 10s-4.47 10-10 10-10-4.47-10-10 4.47-10 10-10zm3.59 5L465 13.59 461.41 10 460 11.41l3.59 3.59-3.59 3.59 1.41 1.41 3.59-3.59 3.59 3.59 1.41-1.41-3.59-3.59 3.59-3.59-1.41-1.41z\" id=\"b\"/><filter x=\"-30%\" y=\"-30%\" width=\"160%\" height=\"160%\" filterUnits=\"objectBoundingBox\" id=\"a\"><feOffset in=\"SourceAlpha\" result=\"shadowOffsetOuter1\"/><feGaussianBlur stdDeviation=\"2\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"/><feColorMatrix values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0\" in=\"shadowBlurOuter1\"/></filter></defs><g transform=\"translate(-451 -1)\" fill-rule=\"nonzero\" fill=\"none\"><use fill=\"#000\" filter=\"url(#a)\" xlink:href=\"#b\"/><use fill=\"#FFF\" fill-rule=\"evenodd\" xlink:href=\"#b\"/></g></svg>';\n      var CloseButton = Boolean(this.props.handleClose) && React__default.createElement(IconButton, {\n        onClick: function onClick(e) {\n          return _this2._handleClose(e);\n        }\n      }, React__default.createElement(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: svg\n        }\n      }));\n\n      for (var i = 0; i < videos.length; i++) {\n        if (videos[i].type === 'text/html' || videos[i].type === 'video/mp4') {\n          video = videos[i];\n          break;\n        }\n      }\n\n      var url = sanitizeURL(video.secure_url || video.video);\n\n      if (video.type === 'text/html') {\n        return React__default.createElement(\"div\", {\n          className: \"raf-video__frame\"\n        }, CloseButton, React__default.createElement(\"iframe\", {\n          title: 'embedded player',\n          id: \"ytplayer\",\n          type: video.type,\n          width: video.width,\n          height: video.height,\n          src: url,\n          frameBorder: \"0\"\n        }));\n      } else {\n        var videoProps = {\n          controls: true,\n          // Try fetching length of video etc\n          preload: 'metadata',\n          poster: ''\n        };\n\n        if (images[0]) {\n          if (images[0].secure_url) videoProps.poster = images[0].secure_url;else if (images[0].image) videoProps.poster = images[0].image;\n        }\n\n        var parsedUrl = new URL(url);\n        var _iteratorNormalCompletion = true;\n        var _didIteratorError = false;\n        var _iteratorError = undefined;\n\n        try {\n          for (var _iterator = this.props.urlsThatAreGifs[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n            var gifUrl = _step.value;\n\n            if (gifUrl === parsedUrl.host) {\n              videoProps = {\n                // Load the video right away\n                preload: 'auto',\n                // Display it like it's a gif\n                autoPlay: true,\n                muted: true,\n                loop: true,\n                controls: false,\n                // On mobile don't open video fullscreen\n                playsInline: true,\n                'webkit-playsinline': 'webkit-playsinline'\n              };\n              break;\n            }\n          }\n        } catch (err) {\n          _didIteratorError = true;\n          _iteratorError = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n              _iterator[\"return\"]();\n            }\n          } finally {\n            if (_didIteratorError) {\n              throw _iteratorError;\n            }\n          }\n        }\n\n        return React__default.createElement(\"div\", {\n          className: \"raf-video__video\"\n        }, React__default.createElement(\"video\", _extends({\n          className: \"raf-video__video--video\"\n        }, videoProps), React__default.createElement(\"source\", {\n          src: url,\n          type: video.type\n        })), React__default.createElement(\"div\", {\n          className: \"raf-video__video--content\"\n        }, React__default.createElement(\"div\", {\n          className: \"raf-video__video--title\"\n        }, this.props.og.title), React__default.createElement(\"div\", {\n          className: \"raf-video__video--description\"\n        }, this.props.og.description), React__default.createElement(\"div\", {\n          className: \"raf-video__video--link\"\n        }, React__default.createElement(\"a\", {\n          href: sanitizeURL(this.props.og.url),\n          target: \"blank\"\n        }, this.props.og.site_name))), CloseButton);\n      }\n    }\n  }]);\n\n  return Video;\n}(React__default.Component);\n\n_defineProperty(Video, \"defaultProps\", {\n  urlsThatAreGifs: ['i.giphy.com', 'i.imgur.com', 'media.giphy.com']\n});\n/**\n * Component is described here.\n *\n * @example ./examples/Gallery.md\n */\n\n\nvar Gallery =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Gallery, _React$Component);\n\n  function Gallery(props) {\n    var _this;\n\n    _classCallCheck(this, Gallery);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Gallery).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"gotoPrevious\", function () {\n      _this.setState({\n        currentImage: _this.state.currentImage - 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"gotoNext\", function () {\n      _this.setState({\n        currentImage: _this.state.currentImage + 1\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"openLightbox\", function (image) {\n      _this.setState({\n        lightboxIsOpen: true,\n        currentImage: image\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"closeLightbox\", function () {\n      _this.setState({\n        lightboxIsOpen: false,\n        currentImage: 0\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getImages\", function (images) {\n      return images.map(function (item) {\n        return {\n          src: item\n        };\n      });\n    });\n\n    _this.state = {\n      lightboxIsOpen: false,\n      currentImage: 0\n    };\n    return _this;\n  }\n\n  _createClass(Gallery, [{\n    key: \"render\",\n    //  TODO: Provide way to add alt tags.\n    value: function render() {\n      var _this2 = this;\n\n      var images = this.props.images;\n      return createElement(Fragment, null, createElement(\"div\", {\n        className: \"raf-gallery\"\n      }, images.slice(0, 5).map(function (image, i) {\n        return createElement(\"div\", {\n          className: \"img \".concat(i === 4 && images.length > 5 ? 'img--last' : ''),\n          onClick: function onClick() {\n            return _this2.openLightbox(i);\n          },\n          key: \"image-\".concat(i)\n        }, createElement(\"img\", {\n          src: image,\n          className: \"raf-gallery__image \",\n          alt: \"\"\n        }), createElement(Fragment, null, i === 4 && images.length > 5 ? createElement(\"p\", null, images.length - 4, \" more\") : null)) // </div>\n        ;\n      }), createElement(Lightbox, {\n        backdropClosesModal: true,\n        images: this.getImages(images),\n        isOpen: this.state.lightboxIsOpen,\n        onClickPrev: this.gotoPrevious,\n        onClickNext: this.gotoNext,\n        onClose: this.closeLightbox,\n        currentImage: this.state.currentImage\n      })));\n    }\n  }]);\n\n  return Gallery;\n}(Component);\n/**\n * Component is described here.\n *\n * @example ./examples/Activity.md\n */\n\n\nvar Activity =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Activity, _React$Component);\n\n  function Activity() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Activity);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Activity)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"renderHeader\", function () {\n      var actor = userOrDefault(_this.props.activity.actor);\n      return React__default.createElement(\"div\", {\n        style: {\n          padding: '8px 16px'\n        }\n      }, React__default.createElement(UserBar, {\n        username: actor.data.name,\n        avatar: actor.data.profileImage,\n        onClickUser: _this._getOnClickUser(),\n        subtitle: _this.props.HeaderRight != null ? humanizeTimestamp(_this.props.activity.time) : undefined,\n        timestamp: _this.props.activity.time,\n        icon: _this.props.icon,\n        Right: _this.props.HeaderRight\n      }));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickUser\", function () {\n      var onClickUser = _this.props.onClickUser;\n\n      if (onClickUser) {\n        return onClickUser(userOrDefault(_this.props.activity.actor));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderContent\", function () {\n      var text = _this.props.activity.text;\n\n      if (text === undefined) {\n        if (typeof _this.props.activity.object === 'string') {\n          text = _this.props.activity.object;\n        } else {\n          text = '';\n        }\n      }\n\n      text = text.trim();\n      var _this$props$activity$ = _this.props.activity.attachments,\n          attachments = _this$props$activity$ === void 0 ? {} : _this$props$activity$;\n      return React__default.createElement(\"div\", {\n        className: \"raf-activity__content\"\n      }, !!text && React__default.createElement(\"div\", {\n        style: {\n          padding: '8px 16px'\n        }\n      }, React__default.createElement(\"p\", null, textRenderer(text, 'raf-activity', _this.props.onClickMention, _this.props.onClickHashtag))), _this.props.activity.verb === 'repost' && _this.props.activity.object instanceof Object && React__default.createElement(Card, _this.props.activity.object.data), attachments && attachments.og && Object.keys(attachments.og).length > 0 && React__default.createElement(\"div\", {\n        style: {\n          padding: '8px 16px'\n        }\n      }, attachments.og.videos ? React__default.createElement(Video, {\n        og: attachments.og\n      }) : attachments.og.audios ? React__default.createElement(Audio, {\n        og: attachments.og\n      }) : React__default.createElement(Card, attachments.og)), Boolean(_this.props.activity.image) && _this.props.activity.image !== undefined ? React__default.createElement(\"div\", {\n        style: {\n          padding: '8px 0'\n        }\n      }, React__default.createElement(Gallery, {\n        images: [_this.props.activity.image] // resizeMethod=\"resize\"\n\n      })) : null, attachments.images && Boolean(attachments.images.length) && React__default.createElement(\"div\", {\n        style: {\n          padding: '8px 0'\n        }\n      }, React__default.createElement(Gallery, {\n        images: attachments.images\n      })), attachments.files && Boolean(attachments.files.length) && React__default.createElement(\"ol\", {\n        className: \"raf-activity__attachments\"\n      }, attachments.files.map(function (_ref, i) {\n        var name = _ref.name,\n            url = _ref.url,\n            mimeType = _ref.mimeType;\n        return React__default.createElement(\"a\", {\n          href: sanitizeURL(url),\n          download: true,\n          key: i\n        }, React__default.createElement(\"li\", {\n          className: \"raf-activity__file\"\n        }, React__default.createElement(FileIcon, {\n          mimeType: mimeType,\n          filename: name\n        }), \" \", name));\n      })));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderFooter\", function () {\n      return null;\n    });\n\n    return _this;\n  }\n\n  _createClass(Activity, [{\n    key: \"_getOnClickUser\",\n    value: function _getOnClickUser() {\n      return this.props.onClickUser ? this.onClickUser : undefined;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React__default.createElement(\"div\", {\n        className: \"raf-activity\"\n      }, React__default.createElement(React__default.Fragment, null, smartRender(this.props.Header, {}, this.renderHeader), smartRender(this.props.Content, {}, this.renderContent), smartRender(this.props.Footer, {}, this.renderFooter)));\n    }\n  }]);\n\n  return Activity;\n}(React__default.Component);\n/**\n *\n * @example ./examples/Link.md\n */\n\n\nvar Link =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Link, _React$Component);\n\n  function Link() {\n    _classCallCheck(this, Link);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Link).apply(this, arguments));\n  }\n\n  _createClass(Link, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(Fragment, null, createElement(\"a\", {\n        href: this.props.to,\n        className: \"raf-link\",\n        onClick: this.props.onClick\n      }, this.props.children));\n    }\n  }]);\n\n  return Link;\n}(Component);\n/**\n * Component is described here.\n *\n * @example ./examples/NewActivitiesNotification.md\n */\n\n\nvar NewActivitiesNotification =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NewActivitiesNotification, _React$Component);\n\n  function NewActivitiesNotification() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, NewActivitiesNotification);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(NewActivitiesNotification)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"_labelFunction\", function () {\n      var _this$props = _this.props,\n          adds = _this$props.adds,\n          deletes = _this$props.deletes,\n          labelSingle = _this$props.labelSingle,\n          labelPlural = _this$props.labelPlural,\n          labelFunction = _this$props.labelFunction;\n      var addCount = (adds || []).length;\n      var deleteCount = (deletes || []).length;\n      var count = addCount + deleteCount;\n\n      if (labelFunction) {\n        return labelFunction({\n          count: count,\n          addCount: addCount,\n          deleteCount: deleteCount,\n          labelSingle: labelSingle,\n          labelPlural: labelPlural\n        });\n      }\n\n      if (addCount === 0) {\n        return null;\n      }\n\n      return \"You have \".concat(addCount, \" new \").concat((addCount > 1 ? labelPlural : labelSingle) || '');\n    });\n\n    return _this;\n  }\n\n  _createClass(NewActivitiesNotification, [{\n    key: \"render\",\n    value: function render() {\n      var label = this._labelFunction();\n\n      if (label === null) {\n        return null;\n      }\n\n      return React__default.createElement(\"button\", {\n        className: \"raf-new-activities-notification\",\n        type: \"button\",\n        onClick: this.props.onClick\n      }, React__default.createElement(Link, null, label));\n    }\n  }]);\n\n  return NewActivitiesNotification;\n}(React__default.Component);\n\n_defineProperty(NewActivitiesNotification, \"defaultProps\", {\n  labelSingle: 'notification',\n  labelPlural: 'notifications',\n  adds: [],\n  deletes: []\n});\n/**\n *\n * @example ./examples/Button.md\n */\n\n\nvar Button =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Button, _React$Component);\n\n  function Button() {\n    _classCallCheck(this, Button);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Button).apply(this, arguments));\n  }\n\n  _createClass(Button, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          children = _this$props.children,\n          buttonStyle = _this$props.buttonStyle;\n      return createElement(\"button\", {\n        className: \"raf-button\".concat(buttonStyle ? ' raf-button--' + buttonStyle : ''),\n        onClick: this.props.onClick,\n        onKeyPress: this.props.onKeyPress,\n        type: this.props.type,\n        disabled: this.props.disabled\n      }, !this.props.loading ? children : createElement(LoadingIndicator, {\n        backgroundColor: \"rgba(255,255,255,0.1)\",\n        color: \"rgba(255,255,255,0.4)\"\n      }));\n    }\n  }]);\n\n  return Button;\n}(Component);\n\n_defineProperty(Button, \"defaultProps\", {\n  buttonStyle: 'info',\n  type: 'button',\n  disabled: false,\n  loading: false\n});\n\nvar LoadMoreButton =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(LoadMoreButton, _React$Component);\n\n  function LoadMoreButton() {\n    _classCallCheck(this, LoadMoreButton);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LoadMoreButton).apply(this, arguments));\n  }\n\n  _createClass(LoadMoreButton, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-load-more-button\"\n      }, createElement(Button, {\n        onClick: this.props.onClick,\n        buttonStyle: \"info\",\n        disabled: this.props.refreshing,\n        loading: this.props.refreshing\n      }, this.props.children));\n    }\n  }]);\n\n  return LoadMoreButton;\n}(Component);\n\n_defineProperty(LoadMoreButton, \"defaultProps\", {\n  children: 'Load more'\n});\n\nvar LoadMorePaginator =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(LoadMorePaginator, _React$Component);\n\n  function LoadMorePaginator() {\n    _classCallCheck(this, LoadMorePaginator);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(LoadMorePaginator).apply(this, arguments));\n  }\n\n  _createClass(LoadMorePaginator, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(Fragment, null, !this.props.reverse && this.props.children, this.props.hasNextPage ? smartRender(this.props.LoadMoreButton, {\n        refreshing: this.props.refreshing,\n        onClick: this.props.loadNextPage\n      }) : null, this.props.reverse && this.props.children);\n    }\n  }]);\n\n  return LoadMorePaginator;\n}(Component);\n\n_defineProperty(LoadMorePaginator, \"defaultProps\", {\n  LoadMoreButton: LoadMoreButton\n});\n\nvar FeedPlaceholder =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(FeedPlaceholder, _React$Component);\n\n  function FeedPlaceholder() {\n    _classCallCheck(this, FeedPlaceholder);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(FeedPlaceholder).apply(this, arguments));\n  }\n\n  _createClass(FeedPlaceholder, [{\n    key: \"render\",\n    value: function render() {\n      return React__default.createElement(\"div\", {\n        className: \"raf-feed-placeholder\"\n      }, React__default.createElement(\"p\", null, this.props.text));\n    }\n  }]);\n\n  return FeedPlaceholder;\n}(React__default.Component);\n\n_defineProperty(FeedPlaceholder, \"defaultProps\", {\n  text: 'No data to display...'\n});\n/**\n * Renders a feed of activities, this component is a StreamApp consumer\n * and must always be a child of the `<StreamApp>` element\n * @example ./examples/FlatFeed.md\n */\n\n\nvar FlatFeed =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(FlatFeed, _React$Component);\n\n  function FlatFeed() {\n    _classCallCheck(this, FlatFeed);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(FlatFeed).apply(this, arguments));\n  }\n\n  _createClass(FlatFeed, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      return createElement(Feed, {\n        feedGroup: this.props.feedGroup,\n        userId: this.props.userId,\n        options: this.props.options,\n        notify: this.props.notify,\n        doFeedRequest: this.props.doFeedRequest,\n        doActivityDeleteRequest: this.props.doActivityDeleteRequest,\n        doReactionAddRequest: this.props.doReactionAddRequest,\n        doReactionDeleteRequest: this.props.doReactionDeleteRequest,\n        doChildReactionAddRequest: this.props.doChildReactionAddRequest,\n        doChildReactionDeleteRequest: this.props.doChildReactionDeleteRequest,\n        doReactionsFilterRequest: this.props.doReactionsFilterRequest\n      }, createElement(FeedContext.Consumer, null, function (feedCtx) {\n        return createElement(FlatFeedInner, _extends({}, _this.props, feedCtx));\n      }));\n    }\n  }]);\n\n  return FlatFeed;\n}(Component);\n\n_defineProperty(FlatFeed, \"defaultProps\", {\n  feedGroup: 'timeline',\n  notify: false,\n  Activity: Activity,\n  Notifier: function Notifier(props) {\n    return createElement(NewActivitiesNotification, _extends({\n      labelPlural: \"activities\",\n      labelSingle: \"activity\"\n    }, props));\n  },\n  Placeholder: FeedPlaceholder,\n  Paginator: LoadMorePaginator\n});\n\nvar FlatFeedInner =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(FlatFeedInner, _React$Component2);\n\n  function FlatFeedInner() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, FlatFeedInner);\n\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(FlatFeedInner)).call.apply(_getPrototypeOf2, [this].concat(_args)));\n\n    _defineProperty(_assertThisInitialized(_this2), \"listRef\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_refresh\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var ref;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this2.props.refresh(_this2.props.options);\n\n            case 2:\n              ref = _this2.listRef;\n\n              if (ref && ref.current) {\n                ref.current.scrollToOffset({\n                  offset: 0\n                });\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this2), \"_renderWrappedActivity\", function (_ref2) {\n      var item = _ref2.item;\n      return createElement(ImmutableItemWrapper, {\n        renderItem: _this2._renderActivity,\n        item: item,\n        feedGroup: _this2.props.feedGroup,\n        userId: _this2.props.userId,\n        key: item.get('id')\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_childProps\", function () {\n      return {\n        onToggleReaction: _this2.props.onToggleReaction,\n        onAddReaction: _this2.props.onAddReaction,\n        onRemoveReaction: _this2.props.onRemoveReaction,\n        onToggleChildReaction: _this2.props.onToggleChildReaction,\n        onAddChildReaction: _this2.props.onAddChildReaction,\n        onRemoveChildReaction: _this2.props.onRemoveChildReaction,\n        onRemoveActivity: _this2.props.onRemoveActivity,\n        feedGroup: _this2.props.feedGroup,\n        userId: _this2.props.userId\n      };\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_renderActivity\", function (item) {\n      var args = _objectSpread({\n        activity: item\n      }, _this2._childProps());\n\n      return smartRender(_this2.props.Activity, _objectSpread({}, args));\n    });\n\n    return _this2;\n  }\n\n  _createClass(FlatFeedInner, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this._refresh();\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var notifierProps = {\n        adds: this.props.realtimeAdds,\n        deletes: this.props.realtimeDeletes,\n        onClick: this._refresh\n      };\n      var _this$props = this.props,\n          loadNextPage = _this$props.loadNextPage,\n          hasNextPage = _this$props.hasNextPage,\n          refreshing = _this$props.refreshing,\n          hasDoneRequest = _this$props.hasDoneRequest,\n          loadReverseNextPage = _this$props.loadReverseNextPage,\n          hasReverseNextPage = _this$props.hasReverseNextPage;\n\n      if (hasReverseNextPage) {\n        notifierProps.onClick = loadReverseNextPage;\n\n        notifierProps.labelFunction = function () {\n          return 'Load activities';\n        };\n      }\n\n      if (this.props.activities.size === 0 && this.props.hasDoneRequest) {\n        return createElement(Fragment, null, smartRender(this.props.Notifier, notifierProps), smartRender(this.props.Placeholder));\n      }\n\n      if (refreshing && !hasDoneRequest) {\n        return createElement(\"div\", {\n          style: {\n            padding: 40,\n            backgroundColor: 'rgb(247, 247, 247'\n          }\n        }, createElement(LoadingIndicator, null));\n      }\n\n      return createElement(Fragment, null, smartRender(this.props.Notifier, notifierProps), smartRender(this.props.Paginator, {\n        loadNextPage: loadNextPage,\n        hasNextPage: hasNextPage,\n        refreshing: refreshing,\n        children: this.props.activityOrder.map(function (id) {\n          return _this3._renderWrappedActivity({\n            item: _this3.props.activities.get(id)\n          });\n        })\n      }));\n    }\n  }]);\n\n  return FlatFeedInner;\n}(Component);\n\nvar ImmutableItemWrapper =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(ImmutableItemWrapper, _React$PureComponent);\n\n  function ImmutableItemWrapper() {\n    _classCallCheck(this, ImmutableItemWrapper);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ImmutableItemWrapper).apply(this, arguments));\n  }\n\n  _createClass(ImmutableItemWrapper, [{\n    key: \"render\",\n    value: function render() {\n      return this.props.renderItem(this.props.item.toJS());\n    }\n  }]);\n\n  return ImmutableItemWrapper;\n}(PureComponent);\n/**\n * Component is described here.\n *\n * @example ./examples/AvatarGroup.md\n */\n\n\nvar AvatarGroup =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AvatarGroup, _React$Component);\n\n  function AvatarGroup() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AvatarGroup);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AvatarGroup)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickUser\", function (e, user) {\n      var onClickUser = _this.props.onClickUser;\n\n      if (onClickUser) {\n        e.stopPropagation();\n        return onClickUser(userOrDefault(user));\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(AvatarGroup, [{\n    key: \"_getOnClickUser\",\n    value: function _getOnClickUser(user) {\n      var _this2 = this;\n\n      return this.props.onClickUser ? function (e) {\n        return _this2.onClickUser(e, user);\n      } : undefined;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React__default.createElement(\"div\", {\n        className: \"raf-avatar-group\"\n      }, this.props.users && this.props.users.slice(0, this.props.limit).map(function (user, i) {\n        return React__default.createElement(\"div\", {\n          className: \"raf-avatar-group__avatar\",\n          key: \"avatar-\".concat(i)\n        }, React__default.createElement(Avatar, {\n          onClick: _this3._getOnClickUser(user),\n          image: user && user.data.profileImage,\n          size: _this3.props.avatarSize,\n          circle: true\n        }));\n      }));\n    }\n  }]);\n\n  return AvatarGroup;\n}(React__default.Component);\n\n_defineProperty(AvatarGroup, \"defaultProps\", {\n  avatarSize: 30,\n  limit: 5\n});\n/**\n * Component is described here.\n *\n * @example ./examples/AttachedActivity.md\n */\n\n\nvar AttachedActivity =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(AttachedActivity, _React$Component);\n\n  function AttachedActivity() {\n    _classCallCheck(this, AttachedActivity);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(AttachedActivity).apply(this, arguments));\n  }\n\n  _createClass(AttachedActivity, [{\n    key: \"render\",\n    value: function render() {\n      var activity = this.props.activity;\n      var images = activity.attachments !== undefined && activity.attachments.images !== undefined ? activity.attachments.images : [];\n      var actor = userOrDefault(activity.actor);\n\n      if (activity.verb === 'repost' || activity.verb === 'post' || activity.verb === 'comment') {\n        return React__default.createElement(\"div\", {\n          className: \"raf-attached-activity\"\n        }, images.length === 0 && React__default.createElement(React__default.Fragment, null, React__default.createElement(\"p\", {\n          className: \"raf-attached-activity__author\"\n        }, React__default.createElement(\"strong\", null, actor.data.name)), React__default.createElement(\"p\", {\n          className: \"raf-attached-activity__content\"\n        }, activity.object)), images.length > 0 && React__default.createElement(\"div\", {\n          className: \"raf-attached-activity__images\"\n        }, images.slice(0, 5).map(function (image, i) {\n          return React__default.createElement(Thumbnail, {\n            image: image,\n            size: 50,\n            key: \"image-\".concat(i)\n          });\n        })));\n      }\n\n      return null;\n    }\n  }]);\n\n  return AttachedActivity;\n}(React__default.Component);\n/**\n * Simple wrapper for a small dropdown.\n *\n * @example ./examples/Dropdown.md\n */\n\n\nvar Dropdown =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Dropdown, _React$Component);\n\n  function Dropdown(props) {\n    var _this;\n\n    _classCallCheck(this, Dropdown);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Dropdown).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"dropdownBox\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"hideMenu\", function (e) {\n      // $FlowFixMe\n      if (!_this.dropdownBox.current.contains(e.target)) {\n        _this.setState({\n          open: false\n        }, function () {\n          document.removeEventListener('click', _this.hideMenu);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showMenu\", function (e) {\n      e.stopPropagation();\n\n      _this.setState({\n        open: true\n      }, function () {\n        document.addEventListener('click', _this.hideMenu);\n      });\n    });\n\n    _this.showMenu = _this.showMenu.bind(_assertThisInitialized(_this));\n    _this.hideMenu = _this.hideMenu.bind(_assertThisInitialized(_this));\n    _this.dropdownBox = createRef();\n    _this.state = {\n      open: false\n    };\n    return _this;\n  }\n\n  _createClass(Dropdown, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      // $FlowFixMe\n      document.removeEventListener('click', this.hideMenu);\n    } // $FlowFixMe\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-dropdown\"\n      }, createElement(IconButton, {\n        onClick: this.showMenu\n      }, createElement(\"svg\", {\n        className: \"raf-dropdown__button\",\n        width: \"12\",\n        height: \"8\",\n        viewBox: \"0 0 12 8\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, createElement(\"path\", {\n        d: \"M1.41 0L6 4.77 10.59 0 12 1.469l-6 6.25-6-6.25z\",\n        fill: \"#A0B2B8\",\n        fillRule: \"evenodd\"\n      }))), this.state.open && createElement(\"div\", {\n        className: \"raf-dropdown__box\",\n        ref: this.dropdownBox\n      }, this.props.children));\n    }\n  }]);\n\n  return Dropdown;\n}(Component);\n/**\n * Component is described here.\n *\n * @example ./examples/Notification.md\n */\n\n\nvar Notification =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Notification, _React$Component);\n\n  function Notification() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Notification);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Notification)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"getUsers\", function (activities) {\n      return activities.map(function (item) {\n        return userOrDefault(item.actor);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickUser\", function (e, actor) {\n      var onClickUser = _this.props.onClickUser;\n\n      if (onClickUser) {\n        e.stopPropagation();\n        return onClickUser(userOrDefault(actor));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickNotification\", function (e) {\n      var onClickNotification = _this.props.onClickNotification;\n\n      if (onClickNotification) {\n        e.stopPropagation();\n        return onClickNotification(_this.props.activityGroup);\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Notification, [{\n    key: \"_getOnClickUser\",\n    value: function _getOnClickUser(actor) {\n      var _this2 = this;\n\n      return this.props.onClickUser ? function (e) {\n        return _this2.onClickUser(e, actor);\n      } : undefined;\n    }\n  }, {\n    key: \"_getOnClickNotification\",\n    value: function _getOnClickNotification() {\n      return this.props.onClickNotification ? this.onClickNotification : undefined;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var headerText, headerSubtext;\n      var _this$props = this.props,\n          activityGroup = _this$props.activityGroup,\n          onMarkAsRead = _this$props.onMarkAsRead;\n      var activities = activityGroup.activities;\n      var latestActivity = activities[0];\n      var lastActor = userOrDefault(latestActivity.actor);\n\n      if (activities.length === 1) {\n        headerText = lastActor.data.name;\n      } else if (activities.length > 1 && activities.length < 1 + 1 + 1) {\n        headerText = \"\".concat(lastActor.data.name || 'Unknown', \" and 1 other \");\n      } else {\n        headerText = \"\".concat(lastActor.data.name || 'Unknown', \" and \").concat(activities.length - 1, \" others \");\n      }\n\n      if (typeof latestActivity.object === 'string') {\n        return null;\n      }\n\n      if (latestActivity.verb === 'like') {\n        headerSubtext = 'liked';\n        headerSubtext += \" your \".concat(latestActivity.object.verb); // icon = HeartIcon;\n      } else if (latestActivity.verb === 'repost') {\n        headerSubtext = \"reposted\";\n        headerSubtext += \" your \".concat(latestActivity.object.verb); // icon = RepostIcon;\n      } else if (latestActivity.verb === 'follow') {\n        headerSubtext = \"followed\";\n        headerSubtext += \" you\"; // icon = RepostIcon;\n      } else if (latestActivity.verb === 'comment') {\n        headerSubtext = \"commented\";\n        headerSubtext += \" on your \".concat(latestActivity.object.verb); // icon = RepostIcon;\n      } else {\n        console.warn('No notification styling found for your verb, please create your own custom Notification group.');\n        return null;\n      }\n\n      return React__default.createElement(\"div\", {\n        onClick: this._getOnClickNotification(),\n        className: 'raf-notification' + (activityGroup.is_read ? ' raf-notification--read' : '')\n      }, React__default.createElement(Avatar, {\n        onClick: this._getOnClickUser(lastActor),\n        image: lastActor.data.profileImage,\n        circle: true,\n        size: 30\n      }), React__default.createElement(\"div\", {\n        className: \"raf-notification__content\"\n      }, React__default.createElement(\"div\", {\n        className: \"raf-notification__header\"\n      }, React__default.createElement(\"strong\", null, headerText), \" \", headerSubtext, !activityGroup.is_read && onMarkAsRead && React__default.createElement(Dropdown, null, React__default.createElement(\"div\", null, React__default.createElement(Link, {\n        onClick: function onClick(e) {\n          e.stopPropagation();\n          onMarkAsRead(activityGroup);\n        }\n      }, \"Mark\\xA0as\\xA0read\")))), React__default.createElement(\"div\", null, React__default.createElement(\"small\", null, humanizeTimestamp(latestActivity.time))), latestActivity.verb !== 'follow' ? React__default.createElement(AttachedActivity, {\n        activity: latestActivity.object\n      }) : null), React__default.createElement(\"div\", {\n        className: \"raf-notification__extra\"\n      }, activities.length > 1 && latestActivity.verb === 'follow' ? React__default.createElement(AvatarGroup, {\n        onClickUser: this.props.onClickUser,\n        avatarSize: 30,\n        users: this.getUsers(activities.slice(1, activities.length))\n      }) : null));\n    }\n  }]);\n\n  return Notification;\n}(React__default.Component);\n/**\n * Renders a notificationfeed, this component is a StreamApp consumer and must\n * always be a child of the `<StreamApp>` element.\n * @example ./examples/NotificationFeed.md\n */\n\n\nvar NotificationFeed =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NotificationFeed, _React$Component);\n\n  function NotificationFeed() {\n    _classCallCheck(this, NotificationFeed);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(NotificationFeed).apply(this, arguments));\n  }\n\n  _createClass(NotificationFeed, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      return createElement(Feed, {\n        feedGroup: this.props.feedGroup,\n        userId: this.props.userId,\n        options: makeDefaultOptions(this.props.options),\n        notify: this.props.notify,\n        doFeedRequest: this.props.doFeedRequest,\n        doActivityDeleteRequest: this.props.doActivityDeleteRequest,\n        doReactionAddRequest: this.props.doReactionAddRequest,\n        doReactionDeleteRequest: this.props.doReactionDeleteRequest,\n        doChildReactionAddRequest: this.props.doChildReactionAddRequest,\n        doChildReactionDeleteRequest: this.props.doChildReactionDeleteRequest\n      }, createElement(FeedContext.Consumer, null, function (feedCtx) {\n        return createElement(NotificationFeedInner, _extends({}, _this.props, feedCtx));\n      }));\n    }\n  }]);\n\n  return NotificationFeed;\n}(Component);\n\n_defineProperty(NotificationFeed, \"defaultProps\", {\n  feedGroup: 'notification',\n  Group: Notification,\n  notify: false,\n  Notifier: NewActivitiesNotification,\n  Paginator: LoadMorePaginator,\n  Placeholder: FeedPlaceholder\n});\n\nvar makeDefaultOptions = function makeDefaultOptions(options) {\n  var copy = _objectSpread({}, options);\n\n  if (copy.mark_seen === undefined) {\n    copy.mark_seen = true;\n  }\n\n  return copy;\n};\n\nvar NotificationFeedInner =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(NotificationFeedInner, _React$Component2);\n\n  function NotificationFeedInner() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, NotificationFeedInner);\n\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(NotificationFeedInner)).call.apply(_getPrototypeOf2, [this].concat(_args)));\n\n    _defineProperty(_assertThisInitialized(_this2), \"listRef\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_refresh\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var ref;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this2.props.refresh(makeDefaultOptions(_this2.props.options));\n\n            case 2:\n              ref = _this2.listRef;\n\n              if (ref && ref.current) {\n                ref.current.scrollToOffset({\n                  offset: 0\n                });\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this2), \"_renderWrappedGroup\", function (_ref2) {\n      var item = _ref2.item;\n      return createElement(ImmutableItemWrapper$1, {\n        renderItem: _this2._renderGroup,\n        item: item,\n        feedGroup: _this2.props.feedGroup,\n        userId: _this2.props.userId,\n        key: item.get('id')\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_renderGroup\", function (item) {\n      var args = {\n        activityGroup: item,\n        feedGroup: _this2.props.feedGroup,\n        userId: _this2.props.userId,\n        onToggleReaction: _this2.props.onToggleReaction,\n        onAddReaction: _this2.props.onAddReaction,\n        onRemoveReaction: _this2.props.onRemoveReaction,\n        onToggleChildReaction: _this2.props.onToggleChildReaction,\n        onAddChildReaction: _this2.props.onAddChildReaction,\n        onRemoveChildReaction: _this2.props.onRemoveChildReaction,\n        onRemoveActivity: _this2.props.onRemoveActivity,\n        onMarkAsRead: _this2.props.onMarkAsRead,\n        onMarkAsSeen: _this2.props.onMarkAsSeen\n      };\n      return smartRender(_this2.props.Group, args);\n    });\n\n    return _this2;\n  }\n\n  _createClass(NotificationFeedInner, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this._refresh();\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.props.activities.clear();\n      this.props.activityOrder.splice(0, this.props.activityOrder.length);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var notifierProps = {\n        adds: this.props.realtimeAdds,\n        deletes: this.props.realtimeDeletes,\n        onClick: this._refresh\n      };\n      var _this$props = this.props,\n          loadNextPage = _this$props.loadNextPage,\n          hasNextPage = _this$props.hasNextPage,\n          refreshing = _this$props.refreshing,\n          hasDoneRequest = _this$props.hasDoneRequest;\n\n      if (this.props.activities.size === 0 && hasDoneRequest) {\n        return createElement(Fragment, null, smartRender(this.props.Notifier, notifierProps), smartRender(this.props.Placeholder));\n      }\n\n      if (refreshing && !hasDoneRequest) {\n        return createElement(\"div\", {\n          style: {\n            padding: 40,\n            backgroundColor: 'rgb(247, 247, 247'\n          }\n        }, createElement(LoadingIndicator, null));\n      }\n\n      return createElement(Fragment, null, smartRender(this.props.Notifier, notifierProps), smartRender(this.props.Paginator, {\n        loadNextPage: loadNextPage,\n        hasNextPage: hasNextPage,\n        refreshing: refreshing,\n        children: this.props.activityOrder.map(function (id) {\n          return _this3._renderWrappedGroup({\n            item: _this3.props.activities.get(id)\n          });\n        })\n      }));\n    }\n  }]);\n\n  return NotificationFeedInner;\n}(Component);\n\nvar ImmutableItemWrapper$1 =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(ImmutableItemWrapper, _React$PureComponent);\n\n  function ImmutableItemWrapper() {\n    _classCallCheck(this, ImmutableItemWrapper);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ImmutableItemWrapper).apply(this, arguments));\n  }\n\n  _createClass(ImmutableItemWrapper, [{\n    key: \"render\",\n    value: function render() {\n      return this.props.renderItem(this.props.item.toJS());\n    }\n  }]);\n\n  return ImmutableItemWrapper;\n}(PureComponent);\n/**\n * Shows the detail of a single activity\n * @example ./examples/SinglePost.md\n */\n\n\nvar SinglePost =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(SinglePost, _React$Component);\n\n  function SinglePost() {\n    _classCallCheck(this, SinglePost);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(SinglePost).apply(this, arguments));\n  }\n\n  _createClass(SinglePost, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      return React__default.createElement(React__default.Fragment, null, React__default.createElement(FlatFeed, {\n        feedGroup: this.props.feedGroup,\n        userId: this.props.userId,\n        options: _objectSpread({\n          withRecentReactions: true\n        }, this.props.options),\n        analyticsLocation: this.props.analyticsLocation,\n        Activity: this.props.Activity,\n        doFeedRequest: function doFeedRequest(client, feedGroup, userId, options) {\n          return client.feed(feedGroup, userId).getActivityDetail(_this.props.activityId, options);\n        },\n        doActivityDeleteRequest: this.props.doActivityDeleteRequest,\n        doReactionAddRequest: this.props.doReactionAddRequest,\n        doReactionDeleteRequest: this.props.doReactionDeleteRequest,\n        doChildReactionAddRequest: this.props.doChildReactionAddRequest,\n        doChildReactionDeleteRequest: this.props.doChildReactionDeleteRequest,\n        doReactionsFilterRequest: this.props.doReactionsFilterRequest\n      }));\n    }\n  }]);\n\n  return SinglePost;\n}(React__default.Component);\n/**\n * Simple Components that renders a panel. To be combined with PanelHeader, PanelContent, PanelFooter. Used by the library to render the B2BActivity and StatusUpdateForm\n *\n * @example ./examples/Panel.md\n */\n\n\nvar Panel =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Panel, _React$Component);\n\n  function Panel() {\n    _classCallCheck(this, Panel);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Panel).apply(this, arguments));\n  }\n\n  _createClass(Panel, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-panel raf-panel--\".concat(this.props.panelStyle)\n      }, this.props.children);\n    }\n  }]);\n\n  return Panel;\n}(Component);\n\n_defineProperty(Panel, \"defaultProps\", {\n  panelStyle: 'rounded'\n});\n\nvar PanelHeading =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(PanelHeading, _React$Component);\n\n  function PanelHeading() {\n    _classCallCheck(this, PanelHeading);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(PanelHeading).apply(this, arguments));\n  }\n\n  _createClass(PanelHeading, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-panel-header\"\n      }, this.props.children);\n    }\n  }]);\n\n  return PanelHeading;\n}(Component);\n\nvar PanelFooter =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(PanelFooter, _React$Component);\n\n  function PanelFooter() {\n    _classCallCheck(this, PanelFooter);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(PanelFooter).apply(this, arguments));\n  }\n\n  _createClass(PanelFooter, [{\n    key: \"render\",\n    value: function render() {\n      return React__default.createElement(\"div\", {\n        className: \"raf-panel-footer\"\n      }, this.props.children);\n    }\n  }]);\n\n  return PanelFooter;\n}(React__default.Component);\n\nvar PanelContent =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(PanelContent, _React$Component);\n\n  function PanelContent() {\n    _classCallCheck(this, PanelContent);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(PanelContent).apply(this, arguments));\n  }\n\n  _createClass(PanelContent, [{\n    key: \"render\",\n    value: function render() {\n      return React__default.createElement(\"div\", {\n        className: \"raf-panel-content\"\n      }, this.props.children);\n    }\n  }]);\n\n  return PanelContent;\n}(React__default.Component);\n\nvar AutocompleteItem = function AutocompleteItem(_ref) {\n  var _ref$entity = _ref.entity,\n      id = _ref$entity.id,\n      _native = _ref$entity[\"native\"];\n  return createElement(\"div\", null, _native, \" \", id);\n};\n/**\n * Component is described here.\n *\n * @example ./examples/Textarea.md\n */\n\n\nvar Textarea =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Textarea, _React$Component);\n\n  function Textarea() {\n    _classCallCheck(this, Textarea);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Textarea).apply(this, arguments));\n  }\n\n  _createClass(Textarea, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      var _this$props = this.props,\n          innerRef = _this$props.innerRef,\n          trigger = _this$props.trigger;\n      return createElement(ReactTextareaAutocomplete, {\n        loadingComponent: LoadingIndicator,\n        trigger: _objectSpread({\n          ':': {\n            dataProvider: function dataProvider(token) {\n              var emojis = emojiIndex.search(token) || [];\n              return emojis.slice(0, 10);\n            },\n            component: AutocompleteItem,\n            output: function output(item) {\n              return {\n                key: item.id,\n                text: item[\"native\"],\n                caretPosition: 'next'\n              };\n            }\n          }\n        }, trigger),\n        innerRef: innerRef && function (el) {\n          if (typeof innerRef === 'function') {\n            innerRef(el);\n          } else if (_this.props.innerRef != null) {\n            innerRef.current = el;\n          }\n        },\n        rows: this.props.rows,\n        maxLength: this.props.maxLength,\n        className: \"raf-textarea__textarea\",\n        containerClassName: \"raf-textarea\",\n        dropdownClassName: \"raf-emojisearch\",\n        listClassName: \"raf-emojisearch__list\",\n        itemClassName: \"raf-emojisearch__item\",\n        placeholder: this.props.placeholder,\n        onChange: this.props.onChange,\n        onSelect: this.props.onChange,\n        onPaste: this.props.onPaste,\n        value: this.props.value\n      });\n    }\n  }]);\n\n  return Textarea;\n}(Component);\n\n_defineProperty(Textarea, \"defaultProps\", {\n  rows: 3,\n  placeholder: 'Share your opinion',\n  trigger: {}\n});\n/**\n * Component is described here.\n *\n * @example ./examples/EmojiPicker.md\n */\n\n\nvar EmojiPicker =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(EmojiPicker, _React$Component);\n\n  function EmojiPicker() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, EmojiPicker);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EmojiPicker)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"emojiPicker\", React__default.createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      open: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"hideMenu\", function (e) {\n      var current = _this.emojiPicker.current;\n\n      if (current && !current.contains(e.target)) {\n        _this.setState({\n          open: false\n        }, function () {\n          document.removeEventListener('click', _this.hideMenu);\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showMenu\", function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        open: true\n      }, function () {\n        document.addEventListener('click', _this.hideMenu);\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(EmojiPicker, [{\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener('click', this.hideMenu);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React__default.createElement(\"div\", {\n        className: \"raf-emoji-picker\"\n      }, ' ', this.state.open && React__default.createElement(\"div\", {\n        className: \"raf-emoji-picker__container\",\n        ref: this.emojiPicker\n      }, React__default.createElement(Picker, {\n        emoji: \"point_up\",\n        title: \"Pick your emoji\\u2026\",\n        onSelect: this.props.onSelect\n      })), React__default.createElement(\"div\", {\n        role: \"button\",\n        onClick: this.showMenu,\n        className: \"raf-emoji-picker__button\"\n      }, React__default.createElement(\"svg\", {\n        width: \"20\",\n        height: \"20\",\n        viewBox: \"0 0 20 20\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, React__default.createElement(\"path\", {\n        d: \"M10 15.498c2.33 0 4.304-1.456 5.106-3.5H4.892c.802 2.044 2.777 3.5 5.107 3.5zm-3.5-6.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm7 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zm-3.5 9a8 8 0 0 1-8-8 8 8 0 0 1 8-8 8 8 0 0 1 8 8 8 8 0 0 1-8 8zm-.006-18C4.467-.002 0 4.475 0 9.998s4.468 10 9.995 10c5.526 0 10.005-4.477 10.005-10s-4.479-10-10.005-10z\",\n        fill: \"#A0B2B8\",\n        fillRule: \"nonzero\"\n      }))));\n    }\n  }]);\n\n  return EmojiPicker;\n}(React__default.Component);\n/**\n * Component is described here.\n *\n * @example ./examples/Title.md\n */\n\n\nvar Title =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Title, _React$Component);\n\n  function Title() {\n    _classCallCheck(this, Title);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Title).apply(this, arguments));\n  }\n\n  _createClass(Title, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-title\",\n        style: {\n          fontSize: this.props.size\n        }\n      }, this.props.children);\n    }\n  }]);\n\n  return Title;\n}(Component);\n\n_defineProperty(Title, \"defaultProps\", {\n  size: 18\n});\n/**\n * Component is described here.\n *\n * @example ./examples/StatusUpdateForm.md\n */\n\n\nvar StatusUpdateForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(StatusUpdateForm, _React$Component);\n\n  function StatusUpdateForm() {\n    _classCallCheck(this, StatusUpdateForm);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(StatusUpdateForm).apply(this, arguments));\n  }\n\n  _createClass(StatusUpdateForm, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      return createElement(StreamApp.Consumer, null, function (appCtx) {\n        return createElement(StatusUpdateFormInner, _extends({}, _this.props, appCtx));\n      });\n    }\n  }]);\n\n  return StatusUpdateForm;\n}(Component);\n\n_defineProperty(StatusUpdateForm, \"defaultProps\", {\n  feedGroup: 'user',\n  activityVerb: 'post',\n  modifyActivityData: function modifyActivityData(d) {\n    return d;\n  },\n  Header: createElement(Title, null, \"New Post\")\n});\n\nvar StatusUpdateFormInner =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(StatusUpdateFormInner, _React$Component2);\n\n  function StatusUpdateFormInner(props) {\n    var _this2;\n\n    _classCallCheck(this, StatusUpdateFormInner);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(StatusUpdateFormInner).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this2), \"_handleOgDebounced\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this2), \"textInputRef\", createRef());\n\n    _defineProperty(_assertThisInitialized(_this2), \"attachTextInputRef\", function (el) {\n      _this2.textInputRef.current = el;\n\n      if (typeof _this2.props.innerRef === 'function') {\n        _this2.props.innerRef(el);\n      } else if (_this2.props.innerRef != null) {\n        _this2.props.innerRef.current = el;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"state\", {\n      text: '',\n      imageUploads: {},\n      imageOrder: [],\n      fileUploads: {},\n      fileOrder: [],\n      ogUrlOrder: [],\n      ogStateByUrl: {},\n      ogActiveUrl: null,\n      submitting: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_dismissOg\", function (og) {\n      if (og && og.url != null) {\n        _this2.setState(function (prevState) {\n          var ogStateByUrl = prevState.ogStateByUrl;\n\n          for (var url in ogStateByUrl) {\n            ogStateByUrl[url].dismissed = true;\n          }\n\n          return {\n            ogActiveUrl: null,\n            ogStateByUrl: ogStateByUrl\n          };\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_text\", function () {\n      return _this2.state.text.trim();\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_object\", function () {\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = _this2._orderedImages()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var image = _step.value;\n\n          if (image.url) {\n            return image.url;\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator[\"return\"] != null) {\n            _iterator[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return _this2._text();\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_orderedImages\", function () {\n      return _this2.state.imageOrder.map(function (id) {\n        return _this2.state.imageUploads[id];\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_uploadedImages\", function () {\n      return _this2._orderedImages().filter(function (upload) {\n        return upload.url;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_orderedFiles\", function () {\n      return _this2.state.fileOrder.map(function (id) {\n        return _this2.state.fileUploads[id];\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_uploadedFiles\", function () {\n      return _this2._orderedFiles().filter(function (upload) {\n        return upload.url;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_orderedOgStates\", function () {\n      return _this2.state.ogUrlOrder.map(function (url) {\n        return _this2.state.ogStateByUrl[url];\n      }).filter(Boolean);\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_isOgScraping\", function () {\n      return _this2._orderedOgStates().some(function (state) {\n        return state.scrapingActive;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_availableOg\", function () {\n      return _this2._orderedOgStates().map(function (state) {\n        return state.data;\n      }).filter(Boolean);\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_activeOg\", function () {\n      var ogActiveUrl = _this2.state.ogActiveUrl;\n\n      if (ogActiveUrl) {\n        return _this2.state.ogStateByUrl[ogActiveUrl].data;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_canSubmit\", function () {\n      return Boolean(_this2._object()) && _this2._orderedImages().every(function (upload) {\n        return upload.state !== 'uploading';\n      }) && _this2._orderedFiles().every(function (upload) {\n        return upload.state !== 'uploading';\n      }) && !_this2._isOgScraping() && !_this2.state.submitting;\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"onSubmitForm\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var response;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n\n                _this2.setState({\n                  submitting: true\n                });\n\n                _context.prev = 2;\n                _context.next = 5;\n                return _this2.addActivity();\n\n              case 5:\n                response = _context.sent;\n                _context.next = 13;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](2);\n\n                _this2.setState({\n                  submitting: false\n                });\n\n                _this2.props.errorHandler(_context.t0, 'add-activity', {\n                  feedGroup: _this2.props.feedGroup,\n                  userId: _this2.props.userId\n                });\n\n                return _context.abrupt(\"return\");\n\n              case 13:\n                _this2.setState({\n                  text: '',\n                  imageUploads: {},\n                  imageOrder: [],\n                  fileUploads: {},\n                  fileOrder: [],\n                  ogUrlOrder: [],\n                  ogStateByUrl: {},\n                  ogActiveUrl: null,\n                  submitting: false\n                });\n\n                if (_this2.props.onSuccess) {\n                  _this2.props.onSuccess(response);\n                }\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 8]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_getTextAreaElement\", function () {\n      return _this2.textInputRef.current;\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_onSelectEmoji\", function (emoji) {\n      return _this2._insertText(emoji[\"native\"]);\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_insertText\",\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(insertedText) {\n        var newCursorPosition, textareaElement;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return _this2.setState(function (prevState) {\n                  var prevText = prevState.text;\n\n                  var textareaElement = _this2._getTextAreaElement();\n\n                  if (!textareaElement) {\n                    return {\n                      text: prevText + insertedText\n                    };\n                  } // Insert emoji at previous cursor position\n\n\n                  var selectionStart = textareaElement.selectionStart,\n                      selectionEnd = textareaElement.selectionEnd;\n                  newCursorPosition = selectionStart + insertedText.length;\n                  return {\n                    text: prevText.slice(0, selectionStart) + insertedText + prevText.slice(selectionEnd)\n                  };\n                });\n\n              case 2:\n                textareaElement = _this2._getTextAreaElement();\n\n                if (!(!textareaElement || newCursorPosition == null)) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 5:\n                // Update cursorPosition\n                textareaElement.selectionStart = newCursorPosition;\n                textareaElement.selectionEnd = newCursorPosition;\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_uploadNewFiles\", function (files) {\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = files[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var file = _step2.value;\n\n          if (file.type.startsWith('image/')) {\n            _this2._uploadNewImage(file);\n          } else if (file instanceof File) {\n            _this2._uploadNewFile(file);\n          }\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2[\"return\"] != null) {\n            _iterator2[\"return\"]();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_uploadNewImage\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(file) {\n        var id, reader;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                id = generateRandomId();\n                _context3.next = 3;\n                return _this2.setState(function (prevState) {\n                  prevState.imageUploads[id] = {\n                    id: id,\n                    file: file,\n                    state: 'uploading'\n                  };\n                  return {\n                    imageOrder: prevState.imageOrder.concat(id),\n                    imageUploads: prevState.imageUploads\n                  };\n                });\n\n              case 3:\n                if (FileReader) {\n                  // TODO: Possibly use URL.createObjectURL instead. However, then we need\n                  // to release the previews when not used anymore though.\n                  reader = new FileReader();\n\n                  reader.onload = function (event) {\n                    _this2.setState(function (prevState) {\n                      prevState.imageUploads[id].previewUri = event.target.result;\n                      return {\n                        imageUploads: prevState.imageUploads\n                      };\n                    });\n                  };\n\n                  reader.readAsDataURL(file);\n                }\n\n                return _context3.abrupt(\"return\", _this2._uploadImage(id));\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_uploadNewFile\",\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(file) {\n        var id;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                id = generateRandomId();\n                _context4.next = 3;\n                return _this2.setState(function (prevState) {\n                  prevState.fileUploads[id] = {\n                    id: id,\n                    file: file,\n                    state: 'uploading'\n                  };\n                  return {\n                    fileOrder: prevState.fileOrder.concat(id),\n                    fileUploads: prevState.fileUploads\n                  };\n                });\n\n              case 3:\n                return _context4.abrupt(\"return\", _this2._uploadFile(id));\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_uploadImage\",\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(id) {\n        var img, file, response, alreadyRemoved;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                img = _this2.state.imageUploads[id];\n\n                if (img) {\n                  _context5.next = 3;\n                  break;\n                }\n\n                return _context5.abrupt(\"return\");\n\n              case 3:\n                file = img.file;\n                _context5.next = 6;\n                return _this2.setState(function (prevState) {\n                  prevState.imageUploads[id].state = 'uploading';\n                  return {\n                    imageUploads: prevState.imageUploads\n                  };\n                });\n\n              case 6:\n                response = {};\n                response = {};\n                _context5.prev = 8;\n                _context5.next = 11;\n                return _this2.props.client.images.upload(file);\n\n              case 11:\n                response = _context5.sent;\n                _context5.next = 22;\n                break;\n\n              case 14:\n                _context5.prev = 14;\n                _context5.t0 = _context5[\"catch\"](8);\n                console.warn(_context5.t0);\n                alreadyRemoved = false;\n                _context5.next = 20;\n                return _this2.setState(function (prevState) {\n                  var image = prevState.imageUploads[id];\n\n                  if (!image) {\n                    alreadyRemoved = true;\n                    return {};\n                  }\n\n                  image.state = 'failed';\n                  return {\n                    imageUploads: prevState.imageUploads\n                  };\n                });\n\n              case 20:\n                if (!alreadyRemoved) {\n                  _this2.props.errorHandler(_context5.t0, 'upload-image', {\n                    feedGroup: _this2.props.feedGroup,\n                    userId: _this2.props.userId\n                  });\n                }\n\n                return _context5.abrupt(\"return\");\n\n              case 22:\n                _context5.next = 24;\n                return _this2.setState(function (prevState) {\n                  img.state = 'finished';\n                  img.url = response.file;\n                  return {\n                    imageUploads: prevState.imageUploads\n                  };\n                });\n\n              case 24:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, null, [[8, 14]]);\n      }));\n\n      return function (_x5) {\n        return _ref5.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_uploadFile\",\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(id) {\n        var upload, file, response;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                upload = _this2.state.fileUploads[id];\n\n                if (upload) {\n                  _context6.next = 3;\n                  break;\n                }\n\n                return _context6.abrupt(\"return\");\n\n              case 3:\n                file = upload.file;\n                _context6.next = 6;\n                return _this2.setState(function (prevState) {\n                  prevState.fileUploads[id].state = 'uploading';\n                  return {\n                    fileUploads: prevState.fileUploads\n                  };\n                });\n\n              case 6:\n                response = {};\n                response = {};\n                _context6.prev = 8;\n                _context6.next = 11;\n                return _this2.props.client.files.upload(file);\n\n              case 11:\n                response = _context6.sent;\n                _context6.next = 21;\n                break;\n\n              case 14:\n                _context6.prev = 14;\n                _context6.t0 = _context6[\"catch\"](8);\n                console.warn(_context6.t0);\n                _context6.next = 19;\n                return _this2.setState(function (prevState) {\n                  if (prevState.fileUploads[id]) {\n                    prevState.fileUploads[id].state = 'failed';\n                    return {\n                      fileUploads: prevState.fileUploads\n                    };\n                  }\n\n                  return {};\n                });\n\n              case 19:\n                _this2.props.errorHandler(_context6.t0, 'upload-image', {\n                  feedGroup: _this2.props.feedGroup,\n                  userId: _this2.props.userId\n                });\n\n                return _context6.abrupt(\"return\");\n\n              case 21:\n                _context6.next = 23;\n                return _this2.setState(function (prevState) {\n                  if (prevState.fileUploads[id]) {\n                    prevState.fileUploads[id].state = 'finished';\n                    prevState.fileUploads[id].url = response.file;\n                    return {\n                      fileUploads: prevState.fileUploads\n                    };\n                  }\n\n                  return {};\n                });\n\n              case 23:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, null, [[8, 14]]);\n      }));\n\n      return function (_x6) {\n        return _ref6.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this2), \"_removeImage\", function (id) {\n      // TODO: cancel upload if still uploading\n      _this2.setState(function (prevState) {\n        var img = prevState.imageUploads[id];\n\n        if (!img) {\n          return {};\n        }\n\n        delete prevState.imageUploads[id];\n        return {\n          imageUploads: prevState.imageUploads,\n          imageOrder: prevState.imageOrder.filter(function (_id) {\n            return id !== _id;\n          })\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_removeFile\", function (id) {\n      // TODO: cancel upload if still uploading\n      _this2.setState(function (prevState) {\n        var upload = prevState.fileUploads[id];\n\n        if (!upload) {\n          return {};\n        }\n\n        delete prevState.fileUploads[id];\n        return {\n          fileUploads: prevState.fileUploads,\n          fileOrder: prevState.fileOrder.filter(function (_id) {\n            return id !== _id;\n          })\n        };\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"_onChange\", function (event) {\n      var text = inputValueFromEvent(event);\n\n      if (text == null) {\n        return;\n      }\n\n      _this2.setState({\n        text: text\n      });\n\n      _this2._handleOgDebounced(text);\n    });\n\n    _this2._handleOgDebounced = _debounce(_this2.handleOG, 250, {\n      leading: true,\n      trailing: true\n    });\n    return _this2;\n  }\n\n  _createClass(StatusUpdateFormInner, [{\n    key: \"handleOG\",\n    value: function handleOG(text) {\n      var _this3 = this;\n\n      var newUrls;\n      var removedUrls;\n      var urlInfos = anchorme(text, {\n        list: true,\n        exclude: function exclude(info) {\n          return info.protocol !== 'https://' && info.protocol !== 'http://';\n        }\n      });\n\n      var urls = _uniq(urlInfos.map(function (info) {\n        return info.protocol + info.encoded;\n      }));\n\n      this.setState(function (prevState) {\n        var oldUrls = prevState.ogUrlOrder;\n        newUrls = _difference(urls, oldUrls);\n        removedUrls = _difference(oldUrls, urls);\n        var newState = {\n          ogUrlOrder: urls\n        };\n\n        if (!_includes(urls, prevState.ogActiveUrl)) {\n          // !urls.includes(prevState.ogActiveUrl) replaced with lodash\n          newState.ogActiveUrl = null;\n          var _iteratorNormalCompletion3 = true;\n          var _didIteratorError3 = false;\n          var _iteratorError3 = undefined;\n\n          try {\n            for (var _iterator3 = urls[Symbol.iterator](), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n              var url = _step3.value;\n              var ogState = prevState.ogStateByUrl[url];\n\n              if (ogState && ogState.data && !ogState.dismissed) {\n                newState.ogActiveUrl = url;\n                break;\n              }\n            }\n          } catch (err) {\n            _didIteratorError3 = true;\n            _iteratorError3 = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion3 && _iterator3[\"return\"] != null) {\n                _iterator3[\"return\"]();\n              }\n            } finally {\n              if (_didIteratorError3) {\n                throw _iteratorError3;\n              }\n            }\n          }\n        }\n\n        var _iteratorNormalCompletion4 = true;\n        var _didIteratorError4 = false;\n        var _iteratorError4 = undefined;\n\n        try {\n          for (var _iterator4 = removedUrls[Symbol.iterator](), _step4; !(_iteratorNormalCompletion4 = (_step4 = _iterator4.next()).done); _iteratorNormalCompletion4 = true) {\n            var _url = _step4.value;\n            delete prevState.ogStateByUrl[_url];\n          }\n        } catch (err) {\n          _didIteratorError4 = true;\n          _iteratorError4 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion4 && _iterator4[\"return\"] != null) {\n              _iterator4[\"return\"]();\n            }\n          } finally {\n            if (_didIteratorError4) {\n              throw _iteratorError4;\n            }\n          }\n        }\n\n        var _iteratorNormalCompletion5 = true;\n        var _didIteratorError5 = false;\n        var _iteratorError5 = undefined;\n\n        try {\n          for (var _iterator5 = newUrls[Symbol.iterator](), _step5; !(_iteratorNormalCompletion5 = (_step5 = _iterator5.next()).done); _iteratorNormalCompletion5 = true) {\n            var _url2 = _step5.value;\n            prevState.ogStateByUrl[_url2] = {\n              scrapingActive: true,\n              dismissed: false\n            };\n          }\n        } catch (err) {\n          _didIteratorError5 = true;\n          _iteratorError5 = err;\n        } finally {\n          try {\n            if (!_iteratorNormalCompletion5 && _iterator5[\"return\"] != null) {\n              _iterator5[\"return\"]();\n            }\n          } finally {\n            if (_didIteratorError5) {\n              throw _iteratorError5;\n            }\n          }\n        }\n\n        newState.ogStateByUrl = prevState.ogStateByUrl;\n        return newState;\n      }, function () {\n        newUrls.forEach(\n        /*#__PURE__*/\n        function () {\n          var _ref7 = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee7(url) {\n            var resp;\n            return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n              while (1) {\n                switch (_context7.prev = _context7.next) {\n                  case 0:\n                    _context7.prev = 0;\n                    _context7.next = 3;\n                    return _this3.props.client.og(url);\n\n                  case 3:\n                    resp = _context7.sent;\n                    _context7.next = 11;\n                    break;\n\n                  case 6:\n                    _context7.prev = 6;\n                    _context7.t0 = _context7[\"catch\"](0);\n                    console.warn(_context7.t0);\n\n                    _this3.setState(function (prevState) {\n                      prevState.ogStateByUrl[url] = {\n                        scrapingActive: false,\n                        dismissed: false\n                      };\n                      return {\n                        ogStateByUrl: prevState.ogStateByUrl\n                      };\n                    });\n\n                    return _context7.abrupt(\"return\");\n\n                  case 11:\n                    resp.url = url;\n\n                    _this3.setState(function (prevState) {\n                      prevState.ogStateByUrl[url] = {\n                        scrapingActive: false,\n                        data: resp,\n                        dismissed: false\n                      };\n                      var newState = {\n                        ogStateByUrl: prevState.ogStateByUrl\n                      };\n\n                      if (!prevState.ogActiveUrl) {\n                        newState.ogActiveUrl = url;\n                      }\n\n                      return newState;\n                    });\n\n                  case 13:\n                  case \"end\":\n                    return _context7.stop();\n                }\n              }\n            }, _callee7, null, [[0, 6]]);\n          }));\n\n          return function (_x7) {\n            return _ref7.apply(this, arguments);\n          };\n        }());\n      });\n    }\n  }, {\n    key: \"addActivity\",\n    value: function () {\n      var _addActivity = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8() {\n        var activity, uploadedImages, uploadedFiles, attachments, modifiedActivity;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                activity = {\n                  actor: this.props.client.currentUser,\n                  verb: this.props.activityVerb,\n                  object: this._object()\n                };\n                uploadedImages = this._uploadedImages();\n                uploadedFiles = this._uploadedFiles();\n                attachments = {};\n                attachments.og = this._activeOg();\n\n                if (uploadedImages) {\n                  attachments.images = uploadedImages.map(function (image) {\n                    return image.url;\n                  }).filter(Boolean);\n                  activity.text = this._text();\n                }\n\n                if (uploadedFiles) {\n                  attachments.files = uploadedFiles.map(function (upload) {\n                    return {\n                      // url will never actually be empty string because _uploadedFiles\n                      // filters those out.\n                      url: upload.url || '',\n                      name: upload.file.name,\n                      mimeType: upload.file.type\n                    };\n                  });\n                }\n\n                if (Object.keys(attachments).length > 0) {\n                  activity.attachments = attachments;\n                }\n\n                modifiedActivity = this.props.modifyActivityData(activity);\n\n                if (!this.props.doRequest) {\n                  _context8.next = 15;\n                  break;\n                }\n\n                _context8.next = 12;\n                return this.props.doRequest(modifiedActivity);\n\n              case 12:\n                return _context8.abrupt(\"return\", _context8.sent);\n\n              case 15:\n                _context8.next = 17;\n                return this.props.client.feed(this.props.feedGroup, this.props.userId).addActivity(modifiedActivity);\n\n              case 17:\n                return _context8.abrupt(\"return\", _context8.sent);\n\n              case 18:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function addActivity() {\n        return _addActivity.apply(this, arguments);\n      }\n\n      return addActivity;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var activeOg = this._activeOg();\n\n      var availableOg = this._availableOg();\n\n      var userData = this.props.user.data || {};\n      return createElement(Panel, null, createElement(\"form\", {\n        onSubmit: this.onSubmitForm\n      }, createElement(ImageDropzone, {\n        handleFiles: this._uploadNewFiles\n      }, createElement(PanelHeading, null, this.props.Header), createElement(PanelContent, null, createElement(\"div\", {\n        style: {\n          display: 'flex'\n        }\n      }, createElement(Fragment, null, userData.profileImage && createElement(\"div\", {\n        style: {\n          marginRight: '16px'\n        }\n      }, createElement(Avatar, {\n        image: // $FlowFixMe\n        userData.profileImage || 'https://placehold.it/100x100',\n        size: 50,\n        circle: true\n      }))), createElement(Textarea, {\n        innerRef: this.textInputRef,\n        placeholder: \"Type your post... \",\n        value: this.state.text,\n        onChange: this._onChange,\n        trigger: this.props.trigger,\n        onPaste:\n        /*#__PURE__*/\n        function () {\n          var _ref8 = _asyncToGenerator(\n          /*#__PURE__*/\n          _regeneratorRuntime.mark(function _callee9(event) {\n            var items, plainTextPromise, _iteratorNormalCompletion6, _didIteratorError6, _iteratorError6, _loop, _iterator6, _step6, _ret, fileLikes, s;\n\n            return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n              while (1) {\n                switch (_context9.prev = _context9.next) {\n                  case 0:\n                    items = event.clipboardData.items;\n\n                    if (dataTransferItemsHaveFiles(items)) {\n                      _context9.next = 3;\n                      break;\n                    }\n\n                    return _context9.abrupt(\"return\");\n\n                  case 3:\n                    event.preventDefault(); // Get a promise for the plain text in case no files are\n                    // found. This needs to be done here because chrome cleans\n                    // up the DataTransferItems after resolving of a promise.\n\n                    _iteratorNormalCompletion6 = true;\n                    _didIteratorError6 = false;\n                    _iteratorError6 = undefined;\n                    _context9.prev = 7;\n\n                    _loop = function _loop() {\n                      var item = _step6.value;\n\n                      if (item.kind === 'string' && item.type === 'text/plain') {\n                        plainTextPromise = new Promise(function (resolve) {\n                          item.getAsString(function (s) {\n                            resolve(s);\n                          });\n                        });\n                        return \"break\";\n                      }\n                    };\n\n                    _iterator6 = items[Symbol.iterator]();\n\n                  case 10:\n                    if (_iteratorNormalCompletion6 = (_step6 = _iterator6.next()).done) {\n                      _context9.next = 17;\n                      break;\n                    }\n\n                    _ret = _loop();\n\n                    if (!(_ret === \"break\")) {\n                      _context9.next = 14;\n                      break;\n                    }\n\n                    return _context9.abrupt(\"break\", 17);\n\n                  case 14:\n                    _iteratorNormalCompletion6 = true;\n                    _context9.next = 10;\n                    break;\n\n                  case 17:\n                    _context9.next = 23;\n                    break;\n\n                  case 19:\n                    _context9.prev = 19;\n                    _context9.t0 = _context9[\"catch\"](7);\n                    _didIteratorError6 = true;\n                    _iteratorError6 = _context9.t0;\n\n                  case 23:\n                    _context9.prev = 23;\n                    _context9.prev = 24;\n\n                    if (!_iteratorNormalCompletion6 && _iterator6[\"return\"] != null) {\n                      _iterator6[\"return\"]();\n                    }\n\n                  case 26:\n                    _context9.prev = 26;\n\n                    if (!_didIteratorError6) {\n                      _context9.next = 29;\n                      break;\n                    }\n\n                    throw _iteratorError6;\n\n                  case 29:\n                    return _context9.finish(26);\n\n                  case 30:\n                    return _context9.finish(23);\n\n                  case 31:\n                    _context9.next = 33;\n                    return dataTransferItemsToFiles(items);\n\n                  case 33:\n                    fileLikes = _context9.sent;\n\n                    if (!fileLikes.length) {\n                      _context9.next = 37;\n                      break;\n                    }\n\n                    _this4._uploadNewFiles(fileLikes);\n\n                    return _context9.abrupt(\"return\");\n\n                  case 37:\n                    if (!plainTextPromise) {\n                      _context9.next = 42;\n                      break;\n                    }\n\n                    _context9.next = 40;\n                    return plainTextPromise;\n\n                  case 40:\n                    s = _context9.sent;\n\n                    _this4._insertText(s);\n\n                  case 42:\n                  case \"end\":\n                    return _context9.stop();\n                }\n              }\n            }, _callee9, null, [[7, 19, 23, 31], [24,, 26, 30]]);\n          }));\n\n          return function (_x8) {\n            return _ref8.apply(this, arguments);\n          };\n        }()\n      })), this._isOgScraping() && createElement(\"div\", {\n        className: \"raf-status-update-form__og-loading\"\n      }, createElement(LoadingIndicator, null), \" Getting website data...\"), activeOg && createElement(\"div\", {\n        style: {\n          margin: '8px 0'\n        }\n      }, !activeOg.videos && !activeOg.audios ? createElement(Card, _extends({}, activeOg, {\n        nolink: true,\n        handleClose: function handleClose(e) {\n          e.preventDefault();\n\n          _this4._dismissOg(activeOg);\n        }\n      })) : createElement(Fragment, null, activeOg.videos ? createElement(Video, {\n        og: activeOg,\n        handleClose: function handleClose(e) {\n          e.preventDefault();\n\n          _this4._dismissOg(activeOg);\n        }\n      }) : null, activeOg.audios ? createElement(Audio, {\n        og: activeOg,\n        handleClose: function handleClose(e) {\n          e.preventDefault();\n\n          _this4._dismissOg(activeOg);\n        }\n      }) : null)), availableOg && availableOg.length > 1 && createElement(Fragment, null, createElement(\"ol\", {\n        className: \"raf-status-update-form__url-list\"\n      }, availableOg.map(function (_ref9) {\n        var url = _ref9.url,\n            title = _ref9.title;\n        return createElement(\"li\", {\n          className: \"raf-status-update-form__url-list-item\".concat(url === _this4.state.ogActiveUrl ? ' raf-status-update-form__url-list-item--active' : ''),\n          onClick: function onClick() {\n            return _this4.setState(function (prevState) {\n              var ogState = prevState.ogStateByUrl[url];\n\n              if (ogState) {\n                ogState.dismissed = false;\n              }\n\n              return {\n                ogActiveUrl: url,\n                ogStateByUrl: prevState.ogStateByUrl\n              };\n            });\n          },\n          key: url\n        }, createElement(FontAwesomeIcon, {\n          icon: faBookmark\n        }), ' ', title !== undefined ? title : url);\n      }))), this.state.imageOrder.length > 0 && createElement(ImagePreviewer, {\n        imageUploads: this.state.imageOrder.map(function (id) {\n          return _this4.state.imageUploads[id];\n        }),\n        handleRemove: this._removeImage,\n        handleRetry: this._uploadImage,\n        handleFiles: this._uploadNewFiles\n      }), this.state.fileOrder.length > 0 && createElement(FilePreviewer, {\n        uploads: this.state.fileOrder.map(function (id) {\n          return _this4.state.fileUploads[id];\n        }),\n        handleRemove: this._removeFile,\n        handleRetry: this._uploadFile,\n        handleFiles: this._uploadNewFiles\n      })), createElement(PanelFooter, null, createElement(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center'\n        }\n      }, createElement(\"div\", {\n        style: {\n          flex: 1\n        }\n      }, createElement(\"div\", {\n        style: {\n          marginRight: '32px',\n          display: 'inline-block'\n        }\n      }, createElement(ImageUploadButton, {\n        handleFiles: this._uploadNewFiles,\n        multiple: true\n      })), createElement(\"div\", {\n        style: {\n          marginRight: '32px',\n          display: 'inline-block'\n        }\n      }, createElement(FileUploadButton, {\n        handleFiles: this._uploadNewFiles,\n        multiple: true\n      })), createElement(EmojiPicker, {\n        onSelect: this._onSelectEmoji\n      }), this.props.FooterItem), createElement(Button, {\n        type: \"submit\",\n        buttonStyle: \"primary\",\n        loading: this.state.submitting,\n        disabled: !this._canSubmit()\n      }, \"Post\"))))));\n    }\n  }]);\n\n  return StatusUpdateFormInner;\n}(Component);\n/**\n *\n * @example ./examples/IconBadge.md\n */\n\n\nvar IconBadge =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(IconBadge, _React$Component);\n\n  function IconBadge() {\n    _classCallCheck(this, IconBadge);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(IconBadge).apply(this, arguments));\n  }\n\n  _createClass(IconBadge, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-icon-badge\",\n        role: \"button\",\n        onClick: this.props.onClick\n      }, this.props.children ? this.props.children : createElement(\"svg\", {\n        width: \"17\",\n        height: \"20\",\n        viewBox: \"0 0 17 20\",\n        xmlns: \"http://www.w3.org/2000/svg\"\n      }, createElement(\"path\", {\n        d: \"M8.5 20c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6.5-6V8.5c0-3.07-2.13-5.64-5-6.32V1.5C10 .67 9.33 0 8.5 0S7 .67 7 1.5v.68c-2.87.68-5 3.25-5 6.32V14l-2 2v1h17v-1l-2-2zm-2 1H4V8.5C4 6.01 6.01 4 8.5 4S13 6.01 13 8.5V15z\" // fill=\"#414D54\"\n        ,\n        fillRule: \"evenodd\"\n      })), !this.props.hidden && this.props.unseen > 0 ? createElement(\"div\", {\n        className: \"raf-icon-badge__badge\"\n      }, this.props.showNumber ? createElement(\"p\", null, this.props.unseen) : null) : null);\n    }\n  }]);\n\n  return IconBadge;\n}(Component);\n/**\n * `DropdownPanel` is a more advanced component used to create a notification dropdown for instance, it comes with three parts: `Header`, `Content` and `Footer`. The content has a limited height and the `overflow` is set to `scroll`.\n *\n * @example ./examples/DropdownPanel.md\n */\n\n\nvar DropdownPanel =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DropdownPanel, _React$Component);\n\n  function DropdownPanel() {\n    _classCallCheck(this, DropdownPanel);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(DropdownPanel).apply(this, arguments));\n  }\n\n  _createClass(DropdownPanel, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-dropdown-panel \".concat(this.props.arrow ? ' raf-dropdown-panel--arrow' : '', \" \").concat(this.props.right ? ' raf-dropdown-panel--right raf-dropdown-panel--arrow-right' : 'raf-dropdown-panel--left raf-dropdown-panel--arrow-left')\n      }, this.props.Header != null && createElement(\"div\", {\n        className: \"raf-dropdown-panel__header\"\n      }, smartRender(this.props.Header, {}, null)), createElement(\"div\", {\n        className: \"raf-dropdown-panel__content\"\n      }, this.props.children), this.props.Footer != null && createElement(\"div\", {\n        className: \"raf-dropdown-panel__footer\"\n      }, smartRender(this.props.Footer, {}, null)));\n    }\n  }]);\n\n  return DropdownPanel;\n}(Component);\n\n_defineProperty(DropdownPanel, \"defaultProps\", {\n  arrow: false,\n  left: true,\n  right: false\n});\n/**\n * IMPORTANT: Changing most of the props below doesn't result in the desired\n * effect. These settings related to feed management should be changed in the\n * `sharedFeeds` prop of the [`StreamApp`](#streamapp) component.\n * @example ./examples/NotificationDropdown.md\n */\n\n\nvar NotificationDropdown =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(NotificationDropdown, _React$Component);\n\n  function NotificationDropdown() {\n    _classCallCheck(this, NotificationDropdown);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(NotificationDropdown).apply(this, arguments));\n  }\n\n  _createClass(NotificationDropdown, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      return createElement(Feed, {\n        feedGroup: this.props.feedGroup,\n        userId: this.props.userId,\n        options: makeDefaultOptions$1({\n          mark_seen: false\n        }),\n        doFeedRequest: this.props.doFeedRequest\n      }, createElement(FeedContext.Consumer, null, function (feedCtx) {\n        return createElement(NotificationDropdownInner, _extends({}, _this.props, feedCtx));\n      }));\n    }\n  }]);\n\n  return NotificationDropdown;\n}(Component);\n\n_defineProperty(NotificationDropdown, \"defaultProps\", {\n  feedGroup: 'notification',\n  Group: Notification,\n  notify: true,\n  Notifier: NewActivitiesNotification,\n  Paginator: LoadMorePaginator,\n  Placeholder: FeedPlaceholder,\n  width: 475\n});\n\nvar NotificationDropdownInner =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(NotificationDropdownInner, _React$Component2);\n\n  function NotificationDropdownInner(props) {\n    var _this2;\n\n    _classCallCheck(this, NotificationDropdownInner);\n\n    _this2 = _possibleConstructorReturn(this, _getPrototypeOf(NotificationDropdownInner).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this2), \"dropdownRef\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this2), \"_refresh\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _this2.props.refresh(makeDefaultOptions$1(_this2.props.options));\n\n            case 2:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    })));\n\n    _defineProperty(_assertThisInitialized(_this2), \"openDropdown\", function () {\n      _this2.setState({\n        open: true\n      }, function () {\n        //$FlowFixMe\n        document.addEventListener('click', _this2.closeDropdown, false);\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"closeDropdown\", function (e) {\n      if (_this2.dropdownRef.current !== null && !_this2.dropdownRef.current.contains(e.target)) {\n        _this2.setState({\n          open: false\n        }, function () {\n          //$FlowFixMe\n          document.removeEventListener('click', _this2.closeDropdown, false);\n        });\n      }\n    });\n\n    _this2.state = {\n      open: false\n    };\n    _this2.dropdownRef = createRef();\n    return _this2;\n  }\n\n  _createClass(NotificationDropdownInner, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.refreshUnreadUnseen();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      //$FlowFixMe\n      document.removeEventListener('click', this.closeDropdown, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        style: {\n          position: 'relative',\n          display: 'inline-block'\n        }\n      }, createElement(IconBadge, {\n        unseen: this.props.unseen,\n        onClick: this.openDropdown,\n        showNumber: true,\n        hidden: !this.props.notify\n      }, this.props.Icon && smartRender(this.props.Icon, {}, null)), createElement(\"div\", {\n        ref: this.dropdownRef,\n        style: {\n          position: 'absolute',\n          left: this.props.right ? '' : '-22px',\n          right: this.props.right ? -29 : 0,\n          top: 35,\n          width: '100vw',\n          maxWidth: this.props.width,\n          zIndex: 9999,\n          visibility: this.state.open ? 'visible' : 'hidden',\n          transform: this.state.open ? 'translateY(0px)' : 'translateY(10px)',\n          opacity: this.state.open ? '1' : '0',\n          transition: 'all .2s ease-out'\n        }\n      }, this.state.open && createElement(DropdownPanel, {\n        arrow: true,\n        right: this.props.right,\n        Header: this.props.Header,\n        Footer: this.props.Footer\n      }, createElement(NotificationFeed, {\n        feedGroup: this.props.feedGroup,\n        userId: this.props.userId,\n        options: this.props.options,\n        Group: this.props.Group,\n        notify: this.props.notify,\n        Notifier: this.props.Notifier,\n        Paginator: this.props.Paginator,\n        Placeholder: this.props.Placeholder,\n        doFeedRequest: this.props.doFeedRequest,\n        doActivityDeleteRequest: this.props.doActivityDeleteRequest,\n        doReactionAddRequest: this.props.doReactionAddRequest,\n        doReactionDeleteRequest: this.props.doReactionDeleteRequest,\n        doChildReactionAddRequest: this.props.doChildReactionAddRequest,\n        doChildReactionDeleteRequest: this.props.doChildReactionDeleteRequest,\n        analyticsLocation: this.props.analyticsLocation\n      }))));\n    }\n  }]);\n\n  return NotificationDropdownInner;\n}(Component);\n\nvar makeDefaultOptions$1 = function makeDefaultOptions(options) {\n  var copy = _objectSpread({}, options);\n\n  if (copy.mark_seen === undefined) {\n    copy.mark_seen = true;\n  }\n\n  return copy;\n};\n\nvar InfiniteScroll =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(InfiniteScroll, _Component);\n\n  function InfiniteScroll(props) {\n    var _this;\n\n    _classCallCheck(this, InfiniteScroll);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(InfiniteScroll).call(this, props));\n    _this.scrollListener = _this.scrollListener.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(InfiniteScroll, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.pageLoaded = this.props.pageStart;\n      this.attachScrollListener();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.attachScrollListener();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.detachScrollListener();\n      this.detachMousewheelListener();\n    } // Set a defaut loader for all your `InfiniteScroll` components\n\n  }, {\n    key: \"setDefaultLoader\",\n    value: function setDefaultLoader(loader) {\n      this.defaultLoader = loader;\n    }\n  }, {\n    key: \"detachMousewheelListener\",\n    value: function detachMousewheelListener() {\n      var scrollEl = window;\n\n      if (this.props.useWindow === false) {\n        scrollEl = this.scrollComponent.parentNode;\n      }\n\n      scrollEl.removeEventListener('mousewheel', this.mousewheelListener, this.props.useCapture);\n    }\n  }, {\n    key: \"detachScrollListener\",\n    value: function detachScrollListener() {\n      var scrollEl = window;\n\n      if (this.props.useWindow === false) {\n        scrollEl = this.getParentElement(this.scrollComponent);\n      }\n\n      scrollEl.removeEventListener('scroll', this.scrollListener, this.props.useCapture);\n      scrollEl.removeEventListener('resize', this.scrollListener, this.props.useCapture);\n    }\n  }, {\n    key: \"getParentElement\",\n    value: function getParentElement(el) {\n      return el && el.parentNode;\n    }\n  }, {\n    key: \"filterProps\",\n    value: function filterProps(props) {\n      return props;\n    }\n  }, {\n    key: \"attachScrollListener\",\n    value: function attachScrollListener() {\n      if (!this.props.hasMore || this.props.isLoading || !this.getParentElement(this.scrollComponent)) {\n        return;\n      }\n\n      var scrollEl = window;\n\n      if (this.props.useWindow === false) {\n        scrollEl = this.getParentElement(this.scrollComponent);\n      }\n\n      scrollEl.addEventListener('mousewheel', this.mousewheelListener, this.props.useCapture);\n      scrollEl.addEventListener('scroll', this.scrollListener, this.props.useCapture);\n      scrollEl.addEventListener('resize', this.scrollListener, this.props.useCapture);\n\n      if (this.props.initialLoad) {\n        this.scrollListener();\n      }\n    }\n  }, {\n    key: \"mousewheelListener\",\n    value: function mousewheelListener(e) {\n      // Prevents Chrome hangups\n      // See: https://stackoverflow.com/questions/47524205/random-high-content-download-time-in-chrome/47684257#47684257\n      if (e.deltaY === 1) {\n        e.preventDefault();\n      }\n    }\n  }, {\n    key: \"scrollListener\",\n    value: function scrollListener() {\n      var el = this.scrollComponent;\n      var scrollEl = window;\n      var parentNode = this.getParentElement(el);\n      var offset;\n\n      if (this.props.useWindow) {\n        var doc = document.documentElement || document.body.parentNode || document.body;\n        var scrollTop = scrollEl.pageYOffset !== undefined ? scrollEl.pageYOffset : doc.scrollTop;\n\n        if (this.props.isReverse) {\n          offset = scrollTop;\n        } else {\n          offset = this.calculateOffset(el, scrollTop);\n        }\n      } else if (this.props.isReverse) {\n        offset = parentNode.scrollTop;\n      } else {\n        offset = el.scrollHeight - parentNode.scrollTop - parentNode.clientHeight;\n      } // Here we make sure the element is visible as well as checking the offset\n\n\n      if (offset < Number(this.props.threshold) && el && el.offsetParent !== null) {\n        this.detachScrollListener(); // Call loadMore after detachScrollListener to allow for non-async loadMore functions\n\n        if (typeof this.props.loadMore === 'function') {\n          this.props.loadMore(this.pageLoaded += 1);\n        }\n      }\n    }\n  }, {\n    key: \"calculateOffset\",\n    value: function calculateOffset(el, scrollTop) {\n      if (!el) {\n        return 0;\n      }\n\n      return this.calculateTopPosition(el) + (el.offsetHeight - scrollTop - window.innerHeight);\n    }\n  }, {\n    key: \"calculateTopPosition\",\n    value: function calculateTopPosition(el) {\n      if (!el) {\n        return 0;\n      }\n\n      return el.offsetTop + this.calculateTopPosition(el.offsetParent);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var renderProps = this.filterProps(this.props);\n\n      var children = renderProps.children,\n          element = renderProps.element,\n          hasMore = renderProps.hasMore,\n          initialLoad = renderProps.initialLoad,\n          isReverse = renderProps.isReverse,\n          loader = renderProps.loader,\n          loadMore = renderProps.loadMore,\n          pageStart = renderProps.pageStart,\n          ref = renderProps.ref,\n          threshold = renderProps.threshold,\n          useCapture = renderProps.useCapture,\n          useWindow = renderProps.useWindow,\n          isLoading = renderProps.isLoading,\n          props = _objectWithoutProperties(renderProps, [\"children\", \"element\", \"hasMore\", \"initialLoad\", \"isReverse\", \"loader\", \"loadMore\", \"pageStart\", \"ref\", \"threshold\", \"useCapture\", \"useWindow\", \"isLoading\"]);\n\n      props.ref = function (node) {\n        _this2.scrollComponent = node;\n\n        if (ref) {\n          ref(node);\n        }\n      };\n\n      var childrenArray = [children];\n\n      if (isLoading) {\n        if (loader) {\n          isReverse ? childrenArray.unshift(loader) : childrenArray.push(loader);\n        } else if (this.defaultLoader) {\n          isReverse ? childrenArray.unshift(this.defaultLoader) : childrenArray.push(this.defaultLoader);\n        }\n      }\n\n      return React__default.createElement(element, props, childrenArray);\n    }\n  }]);\n\n  return InfiniteScroll;\n}(Component);\n\n_defineProperty(InfiniteScroll, \"propTypes\", {\n  children: PropTypes.node.isRequired,\n  element: PropTypes.node,\n  hasMore: PropTypes.bool,\n  initialLoad: PropTypes.bool,\n  isReverse: PropTypes.bool,\n  loader: PropTypes.node,\n  loadMore: PropTypes.func.isRequired,\n  pageStart: PropTypes.number,\n  ref: PropTypes.func,\n  threshold: PropTypes.number,\n  useCapture: PropTypes.bool,\n  useWindow: PropTypes.bool\n});\n\n_defineProperty(InfiniteScroll, \"defaultProps\", {\n  element: 'div',\n  hasMore: false,\n  initialLoad: true,\n  pageStart: 0,\n  ref: null,\n  threshold: 250,\n  useWindow: true,\n  isReverse: false,\n  useCapture: false,\n  loader: null\n});\n\nvar InfiniteScrollPaginator =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(InfiniteScrollPaginator, _React$Component);\n\n  function InfiniteScrollPaginator() {\n    _classCallCheck(this, InfiniteScrollPaginator);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(InfiniteScrollPaginator).apply(this, arguments));\n  }\n\n  _createClass(InfiniteScrollPaginator, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(InfiniteScroll, {\n        loadMore: this.props.loadNextPage,\n        hasMore: this.props.hasNextPage,\n        isLoading: this.props.refreshing,\n        isReverse: this.props.reverse,\n        threshold: this.props.threshold,\n        loader: createElement(Fragment, {\n          key: \"loading-indicator\"\n        }, smartRender(this.props.Loader))\n      }, this.props.children);\n    }\n  }]);\n\n  return InfiniteScrollPaginator;\n}(Component);\n\n_defineProperty(InfiniteScrollPaginator, \"defaultProps\", {\n  Loader: createElement(LoadingIndicator, null),\n  threshold: 250\n});\n/**\n * Component is described here.\n *\n * @example ./examples/ReactionIcon.md\n */\n\n\nvar ReactionIcon =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ReactionIcon, _React$Component);\n\n  function ReactionIcon() {\n    _classCallCheck(this, ReactionIcon);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ReactionIcon).apply(this, arguments));\n  }\n\n  _createClass(ReactionIcon, [{\n    key: \"render\",\n    value: function render() {\n      var count = null;\n\n      if (this.props.counts && this.props.kind) {\n        count = this.props.counts[this.props.kind] || 0;\n      }\n\n      var dimensions = {};\n\n      if (this.props.height !== undefined) {\n        dimensions.height = this.props.height;\n      }\n\n      if (this.props.width !== undefined) {\n        dimensions.width = this.props.width;\n      }\n\n      var label = count === 1 ? this.props.labelSingle : this.props.labelPlural;\n      return createElement(\"div\", {\n        className: \"raf-reaction-icon\",\n        onClick: this.props.onPress\n      }, this.props.icon ? createElement(\"img\", {\n        className: \"raf-reaction-icon__image\",\n        src: this.props.icon,\n        alt: \"\"\n      }) : null, count != null ? createElement(\"p\", {\n        className: \"raf-reaction-icon__label\"\n      }, count, label && ' ' + label) : null);\n    }\n  }]);\n\n  return ReactionIcon;\n}(Component);\n/**\n * A generic component that can be used to toggle a reaction and display it's\n * current state. Mostly used for reactions such as like and repost.\n * The [source for\n * LikeButton](https://github.com/GetStream/react-activity-feed/blob/master/src/components/LikeButton.js)\n * is a good example of the usage of this component.\n *\n * @example ./examples/ReactionToggleIcon.md\n */\n\n\nvar ReactionToggleIcon =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ReactionToggleIcon, _React$Component);\n\n  function ReactionToggleIcon() {\n    _classCallCheck(this, ReactionToggleIcon);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ReactionToggleIcon).apply(this, arguments));\n  }\n\n  _createClass(ReactionToggleIcon, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          inactiveIcon = _this$props.inactiveIcon,\n          activeIcon = _this$props.activeIcon,\n          own_reactions = _this$props.own_reactions,\n          kind = _this$props.kind,\n          restProps = _objectWithoutProperties(_this$props, [\"inactiveIcon\", \"activeIcon\", \"own_reactions\", \"kind\"]);\n\n      var icon = inactiveIcon;\n\n      if (own_reactions && own_reactions[kind] && own_reactions[kind].length) {\n        icon = activeIcon;\n      }\n\n      return React__default.createElement(\"div\", {\n        className: \"raf-reaction-toggle-icon\"\n      }, React__default.createElement(ReactionIcon, _extends({\n        icon: icon,\n        kind: kind\n      }, restProps)));\n    }\n  }]);\n\n  return ReactionToggleIcon;\n}(React__default.Component);\n\nvar likebuttonActive = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAYAAAA/mJfHAAAAAXNSR0IArs4c6QAAAUxJREFUOBGtk89Kw0AQxudLi4Zmo1ARPIgtnvoAPfoCevZPn0LoG9QX8OBBvHtpohcP4s2zIsUHEMR4EPEgWGqFVDPORhaibGPFLCQzu/PNb3YzG6IJhxfct1UQdfLkyAuamAqjdWYKiRllB82XzVrPxLK2nJ3YfD+MVpKEDyWWFv4gR9l0es0ZF9Dr/vFDQ3Z0Iq6b6gCeUpXr1Le8xsLmw6eF5D0+Y+aqyQPzzfPaXN/Mf1orTEBqyG+nIq5/SwBZv5XRWBugulHIxBtGlGtBMQj7g61aG173jo34tVVP4V4QjaRzvzbH5Gk7PePPWo/5V5D0Od5erQ7ssGzJCXww3XaApBAYEy50zUJgJWlAUbDLfmvpqhiYU9rTID3+d0zQY2N58egLNQ4GDI0gz8plPeg1MTIa685kcYc0UH5s60NIAJy7bmXXgLT9BOn0XD2NtcXgAAAAAElFTkSuQmCC\";\nvar likebuttonInactive = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAYAAAA/mJfHAAAAAXNSR0IArs4c6QAAAUpJREFUOBGtk7FKA0EQhmeWLQSDiWKhnaVYH8TCUoiKptLKFPcKeQN9gRQpgmVUsDgrcwQ9BK9VRHwAwdpaJGACO85EllxkXS4kA8fMzv7z3ewsC5DT2p2kfh4nJz45+jbtHkMOOY6ICEFhEO5XXuxe1qvswhVfxPdbBHA5BLFAGSy4dJLzwq7iZN2AuQGiOREjIim98Cqxy/6FRd10pU90y6ClUSG91fY2P0fr8cgJi9K00DPfXZaujckJnLOyGucF8MBl2EdW5PMM6BNgK6xW6tju3PF8fy2s7gzhDBswTNt8Hq91qeg85qQg6e54t/zlhOXpJKshxHe+aTMTGN/4o8BnAtOgWwKbaMhS8Nf4eE+1g+1nyU/dGQI17Q+mgyF8bKwuX/thCD0r8HkEPAuCYGA1zs4UqFNgoDxs18fFhkEPpcX5hgWJ/wEycGS98JuJ8gAAAABJRU5ErkJggg==\";\n/**\n * Like button ready to be embedded as Activity footer\n * @example ./examples/LikeButton.md\n */\n\nvar LikeButton =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(LikeButton, _React$Component);\n\n  function LikeButton() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, LikeButton);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(LikeButton)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"_onPress\", function () {\n      var _this$props = _this.props,\n          activity = _this$props.activity,\n          reaction = _this$props.reaction,\n          onToggleReaction = _this$props.onToggleReaction,\n          onToggleChildReaction = _this$props.onToggleChildReaction;\n\n      if (reaction && onToggleChildReaction) {\n        return onToggleChildReaction('like', reaction, {}, {});\n      }\n\n      return onToggleReaction('like', activity, {}, {});\n    });\n\n    return _this;\n  }\n\n  _createClass(LikeButton, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          activity = _this$props2.activity,\n          reaction = _this$props2.reaction;\n      var counts, own_reactions;\n\n      if (reaction && this.props.onToggleChildReaction) {\n        counts = reaction.children_counts;\n        own_reactions = reaction.own_children;\n      } else {\n        if (reaction) {\n          console.warn('reaction is passed to the LikeButton but ' + 'onToggleChildReaction is not, falling back to liking the activity');\n        }\n\n        counts = activity.reaction_counts;\n        own_reactions = activity.own_reactions;\n      }\n\n      return createElement(ReactionToggleIcon, {\n        counts: counts,\n        own_reactions: own_reactions,\n        kind: \"like\",\n        onPress: this._onPress,\n        activeIcon: likebuttonActive,\n        inactiveIcon: likebuttonInactive,\n        labelSingle: \"like\",\n        labelPlural: \"likes\"\n      });\n    }\n  }]);\n\n  return LikeButton;\n}(Component);\n\nvar repostButtonActive = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAUCAYAAACAl21KAAAAAXNSR0IArs4c6QAAAKlJREFUOBHdk8ENgzAMRTHqDXaArdptoNvAVrBDe071I/3oFwkhxzdysS0nz9+J0zSVq1/3WY+2Gnj8lNKksGoQiirMqKJbtkTfa83sHVKkBR8awP++xqLymNOYHUDN5znMIUWEoEA1SCEhENoB4IYLr8aXQ3t/l60j7+29gADByHsB3J9BUQhgFoXwJ5TWKLHW5n+lqljBC8yKMKUYee/h0/1Qdpq8SPwAJWhChOoqSnsAAAAASUVORK5CYII=\";\nvar repostButtonInactive = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAUCAYAAACAl21KAAAAAXNSR0IArs4c6QAAAKlJREFUOBHdk8ENgzAMRTHqbnCBFdpNoJvACnBpp0v1I/3oFwkhxzdysS0nz9+J0zSVa92/sx5tNfD4KaVJYdUgFFWYUcWyfRJ9rzWzd0iRFnxoAP819kXlMacxO4Ca59DNIUWEoEA1SCEhENoB4IYLr8aXQ3t/l60j7+29gADByHsB3J9BUQhgFoXwJ5TWKLHW5n+lqljBC8yKMKUYee/h0/1Qdpq8SPwAvNZE146X6PUAAAAASUVORK5CYII=\";\n/**\n * A repost button ready to be embedded as Activity footer\n * @example ./examples/RepostButton.md\n */\n\nvar RepostButton =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(RepostButton, _React$Component);\n\n  function RepostButton() {\n    _classCallCheck(this, RepostButton);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(RepostButton).apply(this, arguments));\n  }\n\n  _createClass(RepostButton, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      if (this.props.userId != null) {\n        return createElement(RepostButtonInner, this.props);\n      }\n\n      return createElement(StreamApp.Consumer, null, function (appCtx) {\n        return createElement(RepostButtonInner, _extends({}, _this.props, {\n          userId: appCtx.user.id\n        }));\n      });\n    }\n  }]);\n\n  return RepostButton;\n}(Component);\n\n_defineProperty(RepostButton, \"defaultProps\", {\n  feedGroup: 'user'\n});\n\nvar RepostButtonInner =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(RepostButtonInner, _React$Component2);\n\n  function RepostButtonInner() {\n    _classCallCheck(this, RepostButtonInner);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(RepostButtonInner).apply(this, arguments));\n  }\n\n  _createClass(RepostButtonInner, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          feedGroup = _this$props.feedGroup,\n          userId = _this$props.userId,\n          activity = _this$props.activity,\n          onToggleReaction = _this$props.onToggleReaction;\n      return createElement(ReactionToggleIcon, {\n        counts: activity.reaction_counts,\n        own_reactions: activity.own_reactions,\n        kind: \"repost\",\n        onPress: function onPress() {\n          return onToggleReaction('repost', activity, {}, {\n            targetFeeds: [\"\".concat(feedGroup, \":\").concat(userId)]\n          });\n        },\n        activeIcon: repostButtonActive,\n        inactiveIcon: repostButtonInactive,\n        labelSingle: \"repost\",\n        labelPlural: \"reposts\"\n      });\n    }\n  }]);\n\n  return RepostButtonInner;\n}(Component);\n/**\n * Component is described here.\n *\n * @example ./examples/FollowButton.md\n */\n\n\nvar FollowButton =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(FollowButton, _React$Component);\n\n  function FollowButton(props) {\n    var _this;\n\n    _classCallCheck(this, FollowButton);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(FollowButton).call(this, props));\n    _this.state = {\n      followed: _this.props.followed || false\n    };\n    return _this;\n  }\n\n  _createClass(FollowButton, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          onClick = _this$props.onClick,\n          followed = _this$props.followed;\n      return React__default.createElement(\"div\", {\n        className: \"raf-follow-button \".concat(followed ? 'raf-follow-button--active' : ''),\n        role: \"button\",\n        onClick: onClick\n      }, followed ? 'Following' : 'Follow');\n    }\n  }]);\n\n  return FollowButton;\n}(React__default.Component);\n\nvar ReactionList =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(ReactionList, _React$PureComponent);\n\n  function ReactionList() {\n    _classCallCheck(this, ReactionList);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ReactionList).apply(this, arguments));\n  }\n\n  _createClass(ReactionList, [{\n    key: \"render\",\n    value: function render() {\n      var _this = this;\n\n      return createElement(FeedContext.Consumer, null, function (appCtx) {\n        return createElement(ReactionListInner, _extends({}, _this.props, appCtx));\n      });\n    }\n  }]);\n\n  return ReactionList;\n}(PureComponent);\n\n_defineProperty(ReactionList, \"defaultProps\", {\n  Paginator: LoadMorePaginator,\n  oldestToNewest: false,\n  reverseOrder: false\n});\n\nvar ReactionListInner =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ReactionListInner, _React$Component);\n\n  function ReactionListInner() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, ReactionListInner);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ReactionListInner)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this2), \"renderReaction\", function (reaction) {\n      var Reaction = _this2.props.Reaction;\n      return smartRender(Reaction, {\n        reaction: reaction\n      });\n    });\n\n    return _this2;\n  }\n\n  _createClass(ReactionListInner, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this$props = this.props,\n          activityId = _this$props.activityId,\n          activities = _this$props.activities,\n          reactionKind = _this$props.reactionKind,\n          getActivityPath = _this$props.getActivityPath,\n          oldestToNewest = _this$props.oldestToNewest;\n\n      if (!oldestToNewest) {\n        return;\n      }\n\n      var activityPath = this.props.activityPath || getActivityPath(activityId);\n      var orderPrefix = 'oldest';\n      var reactions_extra = activities.getIn([].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions_extra']));\n\n      if (reactions_extra) {\n        return;\n      }\n\n      return this.props.loadNextReactions(activityId, reactionKind, activityPath, oldestToNewest);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props2 = this.props,\n          activityId = _this$props2.activityId,\n          activities = _this$props2.activities,\n          reactionKind = _this$props2.reactionKind,\n          getActivityPath = _this$props2.getActivityPath,\n          oldestToNewest = _this$props2.oldestToNewest,\n          reverseOrder = _this$props2.reverseOrder;\n      var activityPath = this.props.activityPath || getActivityPath(activityId);\n      var orderPrefix = 'latest';\n\n      if (oldestToNewest) {\n        orderPrefix = 'oldest';\n      }\n\n      var reactionsOfKind = activities.getIn([].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions', reactionKind]), immutable.List());\n\n      if (reverseOrder) {\n        reactionsOfKind = reactionsOfKind.reverse();\n      }\n\n      var reactions_extra = activities.getIn([].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions_extra']));\n      var nextUrl = 'https://api.stream-io-api.com/';\n\n      if (reactions_extra) {\n        nextUrl = reactions_extra.getIn([reactionKind, 'next'], '');\n      }\n\n      var refreshing = activities.getIn([].concat(_toConsumableArray(activityPath), [orderPrefix + '_reactions_extra', reactionKind, 'refreshing']), false);\n      return smartRender(this.props.Paginator, {\n        loadNextPage: function loadNextPage() {\n          return _this3.props.loadNextReactions(activityId, reactionKind, activityPath, oldestToNewest);\n        },\n        hasNextPage: Boolean(nextUrl),\n        refreshing: refreshing,\n        reverse: reverseOrder,\n        children: createElement(Fragment, null, reactionsOfKind.map(function (reaction) {\n          return createElement(ImmutableItemWrapper$2, {\n            key: reaction.get('id'),\n            item: reaction,\n            renderItem: _this3.renderReaction\n          });\n        }))\n      });\n    }\n  }]);\n\n  return ReactionListInner;\n}(Component);\n\nvar ImmutableItemWrapper$2 =\n/*#__PURE__*/\nfunction (_React$PureComponent2) {\n  _inherits(ImmutableItemWrapper, _React$PureComponent2);\n\n  function ImmutableItemWrapper() {\n    _classCallCheck(this, ImmutableItemWrapper);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(ImmutableItemWrapper).apply(this, arguments));\n  }\n\n  _createClass(ImmutableItemWrapper, [{\n    key: \"render\",\n    value: function render() {\n      return this.props.renderItem(this.props.item.toJS());\n    }\n  }]);\n\n  return ImmutableItemWrapper;\n}(PureComponent);\n/**\n * Simple Flex wrapper for centering UI elements. To be expanded in the future.\n *\n * @example ./examples/Flex.md\n */\n\n\nvar Flex =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Flex, _React$Component);\n\n  function Flex() {\n    _classCallCheck(this, Flex);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Flex).apply(this, arguments));\n  }\n\n  _createClass(Flex, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-flex\",\n        style: _objectSpread({\n          justifyContent: this.props.j,\n          alignItems: this.props.a,\n          justifySelf: this.props.js,\n          flexDirection: this.props.d,\n          flexWrap: this.props.w\n        }, this.props.style)\n      }, this.props.children);\n    }\n  }]);\n\n  return Flex;\n}(Component);\n\n_defineProperty(Flex, \"defaultProps\", {\n  d: 'row',\n  w: 'nowrap'\n});\n/**\n * Component is described here.\n *\n * @example ./examples/CommentItem.md\n */\n\n\nvar CommentItem =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CommentItem, _React$Component);\n\n  function CommentItem() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CommentItem);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CommentItem)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"_user\", function () {\n      var user = _this.props.comment.user;\n      return user;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onClickUser\", function () {\n      var onClickUser = _this.props.onClickUser;\n\n      if (onClickUser) {\n        return onClickUser(_this._user());\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(CommentItem, [{\n    key: \"_getOnClickUser\",\n    value: function _getOnClickUser() {\n      return this.props.onClickUser ? this.onClickUser : undefined;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var comment = this.props.comment;\n      return React__default.createElement(\"div\", {\n        className: \"raf-comment-item\"\n      }, React__default.createElement(Flex, {\n        a: \"flex-start\",\n        style: {\n          padding: '8px 0'\n        }\n      }, comment.user.data.profileImage && React__default.createElement(Avatar, {\n        onClick: this._getOnClickUser(),\n        image: comment.user.data.profileImage,\n        circle: true,\n        size: 25\n      })), React__default.createElement(Flex, {\n        d: \"column\",\n        style: {\n          flex: 1,\n          margin: '0 8px'\n        }\n      }, React__default.createElement(\"div\", {\n        className: \"raf-comment-item__content\"\n      }, React__default.createElement(\"time\", {\n        dateTime: comment.created_at,\n        title: comment.created_at\n      }, React__default.createElement(\"small\", null, humanizeTimestamp(comment.created_at))), React__default.createElement(\"p\", null, React__default.createElement(\"span\", {\n        onClick: this._getOnClickUser(),\n        className: \"raf-comment-item__author\"\n      }, comment.user.data.name), ' ', textRenderer(comment.data.text, 'raf-comment-item', this.props.onClickMention, this.props.onClickHashtag)))));\n    }\n  }]);\n\n  return CommentItem;\n}(React__default.Component);\n/**\n * CommentList uses ReactionList under the hood to render a list of comments.\n *\n * @example ./examples/CommentList.md\n */\n\n\nvar CommentList =\n/*#__PURE__*/\nfunction (_React$PureComponent) {\n  _inherits(CommentList, _React$PureComponent);\n\n  function CommentList() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CommentList);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CommentList)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"_Reaction\", function (_ref) {\n      var reaction = _ref.reaction;\n      return smartRender(_this.props.CommentItem, {\n        comment: reaction\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(CommentList, [{\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          Paginator = _this$props.Paginator,\n          activityId = _this$props.activityId,\n          activityPath = _this$props.activityPath,\n          oldestToNewest = _this$props.oldestToNewest,\n          reverseOrder = _this$props.reverseOrder;\n      return React__default.createElement(React__default.Fragment, null, React__default.createElement(ReactionList, {\n        Paginator: Paginator,\n        activityId: activityId,\n        reactionKind: 'comment',\n        Reaction: this._Reaction,\n        activityPath: activityPath,\n        oldestToNewest: oldestToNewest,\n        reverseOrder: reverseOrder\n      }));\n    }\n  }]);\n\n  return CommentList;\n}(React__default.PureComponent);\n\n_defineProperty(CommentList, \"defaultProps\", {\n  Paginator: LoadMorePaginator,\n  CommentItem: CommentItem,\n  oldestToNewest: false,\n  reverseOrder: false\n});\n/**\n * Component is described here.\n *\n * @example ./examples/CommentField.md\n */\n\n\nvar CommentField =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CommentField, _React$Component);\n\n  function CommentField() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, CommentField);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(CommentField)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"textareaRef\", React__default.createRef());\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      text: ''\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onSubmitForm\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n\n                if (!(_this.state.text !== '')) {\n                  _context.next = 12;\n                  break;\n                }\n\n                _context.prev = 2;\n                _context.next = 5;\n                return _this.props.onAddReaction('comment', _this.props.activity, {\n                  text: _this.state.text\n                });\n\n              case 5:\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](2);\n                return _context.abrupt(\"return\");\n\n              case 10:\n                _this.setState({\n                  text: ''\n                });\n\n                if (_this.props.onSuccess) {\n                  _this.props.onSuccess();\n                }\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[2, 7]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"_onChange\", function (event) {\n      var text = inputValueFromEvent(event);\n\n      if (text == null) {\n        return;\n      }\n\n      _this.setState({\n        text: text\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(CommentField, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.textareaRef.current) {\n        this.textareaRef.current.addEventListener('keydown', function (e) {\n          if (e.which === 13) {\n            if (_this2.textareaRef.current && _this2.textareaRef.current.nextSibling === null) {\n              _this2.onSubmitForm(e);\n            }\n          }\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React__default.createElement(\"form\", {\n        onSubmit: this.onSubmitForm,\n        className: \"raf-comment-field\"\n      }, this.props.image ? React__default.createElement(Avatar, {\n        image: this.props.image,\n        circle: true,\n        size: 39\n      }) : null, React__default.createElement(\"div\", {\n        className: \"raf-comment-field__group\"\n      }, React__default.createElement(Textarea, {\n        rows: 1,\n        value: this.state.text,\n        placeholder: this.props.placeholder,\n        onChange: this._onChange,\n        trigger: this.props.trigger,\n        onPaste: function onPaste() {\n          return null;\n        },\n        maxLength: 280,\n        innerRef: this.textareaRef\n      }), React__default.createElement(Button, {\n        buttonStyle: \"primary\",\n        disabled: this.state.text === '',\n        type: \"submit\"\n      }, \"post\")));\n    }\n  }]);\n\n  return CommentField;\n}(React__default.Component);\n\n_defineProperty(CommentField, \"defaultProps\", {\n  placeholder: 'Start Typing...'\n});\n/**\n * Component is described here.\n *\n * @example ./examples/DataLabel.md\n */\n\n\nvar DataLabel =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(DataLabel, _React$Component);\n\n  function DataLabel() {\n    _classCallCheck(this, DataLabel);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(DataLabel).apply(this, arguments));\n  }\n\n  _createClass(DataLabel, [{\n    key: \"render\",\n    value: function render() {\n      return createElement(\"div\", {\n        className: \"raf-data-label\"\n      }, createElement(\"span\", {\n        className: \"raf-data-label__label\"\n      }, this.props.label), createElement(\"span\", {\n        className: \"raf-data-label__data\"\n      }, this.props.data));\n    }\n  }]);\n\n  return DataLabel;\n}(Component);\n\n_defineProperty(DataLabel, \"defaultProps\", {\n  label: 'label',\n  data: 'data'\n});\n\nexport { FlatFeed, NotificationFeed, SinglePost, StatusUpdateForm, Activity, Notification, NotificationDropdown, NewActivitiesNotification, InfiniteScrollPaginator, LoadMorePaginator, AttachedActivity, UserBar, Card, Gallery, Avatar, AvatarGroup, Dropdown, Link, Video, Audio, LikeButton, RepostButton, ReactionIcon, ReactionToggleIcon, IconBadge, FollowButton, CommentList, ReactionList, CommentItem, CommentField, Button, DataLabel, Textarea, EmojiPicker, Title, Panel, PanelHeading, PanelFooter, PanelContent, Feed, FeedContext, StreamContext, StreamApp };","map":null,"metadata":{},"sourceType":"module"}